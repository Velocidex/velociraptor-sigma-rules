<!doctype html><html lang=en-us dir=ltr><head><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="
  Linux Base eBPF Model
  #

This model is designed to follow eBPF events on Linux.
Events are provided by various eBPF functions in the watch_ebpf()
plugin. These events can provide security critical information which
can be detected using Sigma Rules.

  Log Sources
  #

Following is a list of recognized log sources.


   Log Source
   Desc



   network_connection/linux/* 

  


   file_event/linux/* 

  


   process_creation/linux/* 

  


   ebpf/linux/* 

  Reports events from the ebpf subsystem.




  Field Mappings
  #

The following field mappings can be used to access fields within the
event. Note that it is also possible to access the fields directly
(e.g. EventData.AccessMask)"><meta name=theme-color media="(prefers-color-scheme: light)" content="#ffffff"><meta name=theme-color media="(prefers-color-scheme: dark)" content="#343a40"><meta name=color-scheme content="light dark"><meta property="og:url" content="http://sigma.velocidex.com/docs/models/linux_ebpf_base/"><meta property="og:site_name" content="Velociraptor Curated Sigma"><meta property="og:title" content="Velociraptor Curated Sigma"><meta property="og:description" content="Linux Base eBPF Model # This model is designed to follow eBPF events on Linux.
Events are provided by various eBPF functions in the watch_ebpf() plugin. These events can provide security critical information which can be detected using Sigma Rules.
Log Sources # Following is a list of recognized log sources.
Log Source Desc network_connection/linux/* file_event/linux/* process_creation/linux/* ebpf/linux/* Reports events from the ebpf subsystem. Field Mappings # The following field mappings can be used to access fields within the event. Note that it is also possible to access the fields directly (e.g. EventData.AccessMask)"><meta property="og:locale" content="en_us"><meta property="og:type" content="website"><title>&lt;span class="icon">
&lt;i class="fa-solid fa-book">&lt;/i>
Linux Ebpf Base
&lt;/span> | Velociraptor Curated Sigma</title><link rel=icon href=/favicon.png><link rel=manifest href=/manifest.json><link rel=canonical href=http://sigma.velocidex.com/docs/models/linux_ebpf_base/><link rel=stylesheet href=/book.min.3257a7ce7c061eb5dfc72257c356229b1470dc77ce9b982ac220c02542f9f04f.css integrity="sha256-MlenznwGHrXfxyJXw1YimxRw3HfOm5gqwiDAJUL58E8=" crossorigin=anonymous><link rel=alternate type=application/rss+xml href=http://sigma.velocidex.com/docs/models/linux_ebpf_base/index.xml title="Velociraptor Curated Sigma"><script src=/js/jquery-3.3.1.min.js?1703133391></script><link href=https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css?1703133392 rel=stylesheet><link href=/css/theme.css rel=stylesheet><link href=//cdn.datatables.net/2.3.0/css/dataTables.dataTables.min.css rel=stylesheet><script src=//cdn.datatables.net/2.3.0/js/dataTables.min.js></script><link href=//cdnjs.cloudflare.com/ajax/libs/font-awesome/6.7.2/css/all.min.css rel=stylesheet><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.11.1/styles/default.min.css><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.11.1/highlight.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.11.1/languages/yaml.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/featherlight/1.7.13/featherlight.min.js integrity="sha512-0UbR6HN0dY8fWN9T7fF658896tsPgnbRREHCNq46J9/JSn8GonXDZmqtTc3qS879GM0zV49b9LPhdc/maKP8Kg==" crossorigin=anonymous referrerpolicy=no-referrer></script><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/featherlight/1.7.13/featherlight.min.css integrity="sha512-56GJrpSgHk6Mc9Fltt+bQKcICJoEpxtvozXPA5n5OT0rfWiqGlJmJCI/vl16kctf/0XbBloh03vl7OF2xFnR8g==" crossorigin=anonymous referrerpolicy=no-referrer><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/font-awesome/7.0.0/css/all.min.css rel=stylesheet><script>$(document).ready(function(){$(".json-renderer").each(function(){try{data=JSON.parse($(this).text()),$(this).jsonViewer(data,{collapsed:!0,rootCollapsable:!1})}catch{}}),$(".datatable").each(function(){new DataTable(this,{paging:!0})}),$(".scroll-datatable").each(function(){let e=$(this),t=new DataTable(this,{paging:!1,scrollY:200})})})</script></head><body dir=ltr><input type=checkbox class="hidden toggle" id=menu-control>
<input type=checkbox class="hidden toggle" id=toc-control><main class="container flex"><aside class=book-menu><div class=book-menu-content><nav><h2 class=book-brand><a class="flex align-center" href=/><span>Velociraptor Curated Sigma</span></a></h2><ul><li><a href=/docs/sigma_in_velociraptor/><span class=icon><i class="fa-solid fa-blog"></i>
Sigma In Velociraptor</span></a><ul><li><a href=/docs/sigma_in_velociraptor/customize/>Customizing Artifacts</a><ul></ul></li></ul></li><li><a href=/docs/artifacts/><span class=icon><i class="fa-solid fa-desktop"></i>
Velociraptor Artifacts</span></a><ul><li><a href=/docs/artifacts/linux.ebpf.monitoring/><span class=icon><i class="fa-solid fa-book"></i>
Linux.EBPF.Monitoring</span></a><ul></ul></li><li><a href=/docs/artifacts/linux.sigma.triage/><span class=icon><i class="fa-solid fa-book"></i>
Linux.Sigma.Triage</span></a><ul></ul></li><li><a href=/docs/artifacts/windows.etw.monitoring/><span class=icon><i class="fa-solid fa-book"></i>
Windows.ETW.Monitoring</span></a><ul></ul></li><li><a href=/docs/artifacts/windows.hayabusa.monitoring/><span class=icon><i class="fa-solid fa-book"></i>
Windows.Hayabusa.Monitoring</span></a><ul></ul></li><li><a href=/docs/artifacts/windows.hayabusa.rules/><span class=icon><i class="fa-solid fa-book"></i>
Windows.Hayabusa.Rules</span></a><ul></ul></li><li><a href=/docs/artifacts/windows.sigma.triage/><span class=icon><i class="fa-solid fa-book"></i>
Windows.Sigma.Triage</span></a><ul></ul></li></ul></li><li><a href=/docs/models/><span class=icon><i class="fa-solid fa-desktop"></i>
Sigma Models</span></a><ul><li><a href=/docs/models/linux_base/><span class=icon><i class="fa-solid fa-book"></i>
Linux Base</span></a><ul></ul></li><li><a href=/docs/models/linux_ebpf_base/ class=active><span class=icon><i class="fa-solid fa-book"></i>
Linux Ebpf Base</span></a><ul></ul></li><li><a href=/docs/models/windows_base/><span class=icon><i class="fa-solid fa-book"></i>
Windows Base</span></a><ul></ul></li><li><a href=/docs/models/windows_base_events/><span class=icon><i class="fa-solid fa-book"></i>
Windows Base Events</span></a><ul></ul></li><li><a href=/docs/models/windows_base_vql/><span class=icon><i class="fa-solid fa-book"></i>
Windows Base Vql</span></a><ul></ul></li><li><a href=/docs/models/windows_etw_base/><span class=icon><i class="fa-solid fa-book"></i>
Windows Etw Base</span></a><ul></ul></li></ul></li><li><a href=/docs/github/><span class=icon><i class="fa-brands fa-github"></i>
Github</span></a><ul></ul></li></ul></nav><script>(function(){var e=document.querySelector("aside .book-menu-content");addEventListener("beforeunload",function(){localStorage.setItem("menu.scrollTop",e.scrollTop)}),e.scrollTop=localStorage.getItem("menu.scrollTop")})()</script></div></aside><div class=book-page><header class=book-header><div class="flex align-center justify-between"><label for=menu-control><img src=/svg/menu.svg class=book-icon alt=Menu></label><h3><span class=icon><i class="fa-solid fa-book"></i>
Linux Ebpf Base</span></h3><label for=toc-control></label></div></header><article class="markdown book-article"><h1 id=linux-base-ebpf-model>Linux Base eBPF Model
<a class=anchor href=#linux-base-ebpf-model>#</a></h1><p>This model is designed to follow eBPF events on Linux.</p><p>Events are provided by various eBPF functions in the <code>watch_ebpf()</code>
plugin. These events can provide security critical information which
can be detected using Sigma Rules.</p><h2 id=log-sources>Log Sources
<a class=anchor href=#log-sources>#</a></h2><p>Following is a list of recognized log sources.</p><table class=scroll-datatable><thead><tr><th>Log Source</th><th>Desc</th></tr></thead><tbody><tr><td><a href=#networkconnectionlinux>network_connection/linux/*</a></td><td></td></tr><tr><td><a href=#fileeventlinux>file_event/linux/*</a></td><td></td></tr><tr><td><a href=#processcreationlinux>process_creation/linux/*</a></td><td></td></tr><tr><td><a href=#ebpflinux>ebpf/linux/*</a></td><td>Reports events from the ebpf subsystem.</td></tr></tbody></table><h2 id=field-mappings>Field Mappings
<a class=anchor href=#field-mappings>#</a></h2><p>The following field mappings can be used to access fields within the
event. Note that it is also possible to access the fields directly
(e.g. <code>EventData.AccessMask</code>)</p><div class=expand><div class=expand-label style=cursor:pointer onclick='$h=$(this),$h.next("div").slideToggle(100,function(){$h.children("i").attr("class",function(){return $h.next("div").is(":visible")?"fas fa-chevron-down":"fas fa-chevron-right"})})'><i style=font-size:x-small class="fas fa-chevron-right"></i>
<span>View all Field Mappings</span></div><div class=expand-content style=display:none><table class=datatable><thead><tr><th>Name</th><th>Mapping</th></tr></thead><tbody><tr><td>CommandLine</td><td>x=>x.EventData.argv</td></tr><tr><td>CurrentDirectory</td><td>x=>stat(filename=format(format='/proc/%v/cwd', args=x.System.ProcessID)).Data.Link</td></tr><tr><td>DestinationHostname</td><td>x=>x.EventData.remote_addr.dns_names</td></tr><tr><td>DestinationIp</td><td>x=>x.EventData.remote_addr.sin_addr</td></tr><tr><td>DestinationPort</td><td>x=>x.EventData.remote_addr.sin_port</td></tr><tr><td>EventData</td><td>x=>x.EventData</td></tr><tr><td>EventName</td><td>x=>x.System.EventName</td></tr><tr><td>Image</td><td>x=>x.EventData.ProcInfo.Exe</td></tr><tr><td>Initiated</td><td>x=>x.System.EventName = 'security_socket_connect'</td></tr><tr><td>LogonId</td><td>x=>System.UserID</td></tr><tr><td>ParentCommandLine</td><td>x=>process_tracker_get(id=x.System.ParentProcessID).Data.CommandLine</td></tr><tr><td>ParentImage</td><td>x=>process_tracker_get(id=x.System.ParentProcessID).Data.Exe</td></tr><tr><td>TargetFilename</td><td>x=>x.EventData.pathname</td></tr><tr><td>Timestamp</td><td>x=>timestamp(epoch=now())</td></tr><tr><td>User</td><td>x=>process_tracker_get(id=x.System.ProcessID).Data.Username</td></tr></tbody></table></div></div><hr><h2 id=network_connectionlinux><code>network_connection/linux/*</code>
<a class=anchor href=#network_connectionlinux>#</a></h2><div class=expand><div class=expand-label style=cursor:pointer onclick='$h=$(this),$h.next("div").slideToggle(100,function(){$h.children("i").attr("class",function(){return $h.next("div").is(":visible")?"fas fa-chevron-down":"fas fa-chevron-right"})})'><i style=font-size:x-small class="fas fa-chevron-right"></i>
<span>Details</span></div><div class=expand-content style=display:none><h4 id=vql-query>VQL Query
<a class=anchor href=#vql-query>#</a></h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#66d9ef>SELECT</span> <span style=color:#f92672>*</span> <span style=color:#66d9ef>FROM</span> EBFFEvent
</span></span><span style=display:flex><span><span style=color:#66d9ef>WHERE</span> <span style=color:#66d9ef>System</span>.EventName <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;security_socket_connect&#34;</span>
</span></span></code></pre></div><h4 id=sample-use-in-a-sigma-rule>Sample use in a sigma rule:
<a class=anchor href=#sample-use-in-a-sigma-rule>#</a></h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#f92672>logsource</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>category</span>: <span style=color:#ae81ff>network_connection</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>product</span>: <span style=color:#ae81ff>linux</span>
</span></span></code></pre></div></div></div><h2 id=file_eventlinux><code>file_event/linux/*</code>
<a class=anchor href=#file_eventlinux>#</a></h2><div class=expand><div class=expand-label style=cursor:pointer onclick='$h=$(this),$h.next("div").slideToggle(100,function(){$h.children("i").attr("class",function(){return $h.next("div").is(":visible")?"fas fa-chevron-down":"fas fa-chevron-right"})})'><i style=font-size:x-small class="fas fa-chevron-right"></i>
<span>Details</span></div><div class=expand-content style=display:none><h4 id=vql-query>VQL Query
<a class=anchor href=#vql-query>#</a></h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#66d9ef>SELECT</span> <span style=color:#f92672>*</span> <span style=color:#66d9ef>FROM</span> EBFFEvent
</span></span><span style=display:flex><span><span style=color:#66d9ef>WHERE</span> <span style=color:#66d9ef>System</span>.EventName <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;security_file_open&#34;</span>
</span></span></code></pre></div><h4 id=sample-use-in-a-sigma-rule>Sample use in a sigma rule:
<a class=anchor href=#sample-use-in-a-sigma-rule>#</a></h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#f92672>logsource</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>category</span>: <span style=color:#ae81ff>file_event</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>product</span>: <span style=color:#ae81ff>linux</span>
</span></span></code></pre></div></div></div><h2 id=process_creationlinux><code>process_creation/linux/*</code>
<a class=anchor href=#process_creationlinux>#</a></h2><div class=expand><div class=expand-label style=cursor:pointer onclick='$h=$(this),$h.next("div").slideToggle(100,function(){$h.children("i").attr("class",function(){return $h.next("div").is(":visible")?"fas fa-chevron-down":"fas fa-chevron-right"})})'><i style=font-size:x-small class="fas fa-chevron-right"></i>
<span>Details</span></div><div class=expand-content style=display:none><h4 id=vql-query>VQL Query
<a class=anchor href=#vql-query>#</a></h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#66d9ef>SELECT</span> <span style=color:#f92672>*</span> <span style=color:#66d9ef>FROM</span> EBFFEvent
</span></span><span style=display:flex><span><span style=color:#66d9ef>WHERE</span> <span style=color:#66d9ef>System</span>.EventName <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;sched_process_exec&#34;</span>
</span></span></code></pre></div><h4 id=sample-use-in-a-sigma-rule>Sample use in a sigma rule:
<a class=anchor href=#sample-use-in-a-sigma-rule>#</a></h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#f92672>logsource</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>category</span>: <span style=color:#ae81ff>process_creation</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>product</span>: <span style=color:#ae81ff>linux</span>
</span></span></code></pre></div></div></div><h2 id=ebpflinux><code>ebpf/linux/*</code>
<a class=anchor href=#ebpflinux>#</a></h2><p>Reports events from the ebpf subsystem.</p><p>NOTE: Events are enriched using the process tracker. You
probably want to also collect the <code>Linux.Events.TrackProcesses</code>
monitoring artifact.</p><div class=expand><div class=expand-label style=cursor:pointer onclick='$h=$(this),$h.next("div").slideToggle(100,function(){$h.children("i").attr("class",function(){return $h.next("div").is(":visible")?"fas fa-chevron-down":"fas fa-chevron-right"})})'><i style=font-size:x-small class="fas fa-chevron-right"></i>
<span>Details</span></div><div class=expand-content style=display:none><h4 id=vql-query>VQL Query
<a class=anchor href=#vql-query>#</a></h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#66d9ef>SELECT</span> <span style=color:#f92672>*</span> <span style=color:#66d9ef>FROM</span> EBFFEvent
</span></span></code></pre></div><h4 id=sample-events>Sample Events
<a class=anchor href=#sample-events>#</a></h4><h5 id=security_file_open-a-file-is-opened>security_file_open: A file is opened
<a class=anchor href=#security_file_open-a-file-is-opened>#</a></h5><pre class=json-renderer>
{"Timestamp":"2025-02-12T17:11:39+10:00","EventType":"security_file_open","System":{"Timestamp":"2025-02-12T17:11:39.322765542+10:00","EventID":732,"EventName":"security_file_open","ThreadStartTime":"2025-02-12T17:11:00.93207523+10:00","ProcessorID":3,"ProcessID":1495852,"ThreadID":1495852,"ParentProcessID":2920,"HostProcessID":1495852,"HostThreadID":1495852,"HostParentProcessID":2920,"UserID":1000,"MountNS":4026531841,"ProcessName":"python","HostName":"devbox","CgroupID":6344,"MainHostname":"devbox"},"EventData":{"pathname":"/etc/passwd","flags":32768,"dev":265289728,"inode":525345,"ctime":1717126653049616364,"syscall_pathname":"/etc/passwd","ProcInfo":{"Name":"python","CommandLine":"python","CreateTime":"2025-02-12T17:11:00+10:00","Exe":"/usr/bin/python3.10","Cwd":"/home/mic/projects/velociraptor/gui/velociraptor","Username":"mic"}}}

</pre><h5 id=bpf_attach-a-program-is-loading-a-new-ebpf-program-into-the-kernel>bpf_attach: A program is loading a new eBPF program into the kernel.
<a class=anchor href=#bpf_attach-a-program-is-loading-a-new-ebpf-program-into-the-kernel>#</a></h5><pre class=json-renderer>
{"Timestamp":"2025-02-12T17:20:36+10:00","EventType":"bpf_attach","System":{"Timestamp":"2025-02-12T17:20:36.494004508+10:00","EventID":770,"EventName":"bpf_attach","ThreadStartTime":"2025-02-12T17:20:18.731905267+10:00","ProcessorID":0,"ProcessID":1502227,"ThreadID":1502237,"ParentProcessID":1497772,"HostProcessID":1502227,"HostThreadID":1502237,"HostParentProcessID":1497772,"UserID":0,"MountNS":4026531841,"ProcessName":"test","HostName":"devbox","CgroupID":6344,"MainHostname":"devbox"},"EventData":{"prog_type":17,"prog_name":"tracepoint__raw","prog_id":638,"prog_helpers":[0,0,0,0],"symbol_name":"sys_enter","symbol_addr":0,"attach_type":0,"ProcInfo":{"Name":"test","CommandLine":"./test dump fstat","CreateTime":"2025-02-12T17:20:17+10:00","Exe":"/home/mic/projects/tracee_velociraptor/test","Cwd":"/home/mic/projects/tracee_velociraptor","Username":"root"}}}

</pre><h5 id=kill-kill-another-process>kill: Kill another process
<a class=anchor href=#kill-kill-another-process>#</a></h5><pre class=json-renderer>
{"Timestamp":"2025-02-12T17:34:20+10:00","EventType":"kill","System":{"Timestamp":"2025-02-12T17:34:20.195398538+10:00","EventID":62,"EventName":"kill","ThreadStartTime":"2025-02-12T17:25:32.909343797+10:00","ProcessorID":2,"ProcessID":1505752,"ThreadID":1505752,"ParentProcessID":1497772,"HostProcessID":1505752,"HostThreadID":1505752,"HostParentProcessID":1497772,"UserID":0,"MountNS":4026531841,"ProcessName":"python","HostName":"devbox","CgroupID":6344,"MainHostname":"devbox"},"EventData":{"pid":1511451,"sig":15,"ProcInfo":{"Name":"python","CommandLine":"python","CreateTime":"2025-02-12T17:25:32+10:00","Exe":"/usr/bin/python3.10","Cwd":"/home/mic/projects/tracee_velociraptor","Username":"root"}}}

</pre><h5 id=module_load-a-module-is-loaded-into-the-kernel>module_load: A module is loaded into the kernel
<a class=anchor href=#module_load-a-module-is-loaded-into-the-kernel>#</a></h5><pre class=json-renderer>
{"Timestamp":"2025-02-13T01:19:47+10:00","EventType":"module_load","System":{"Timestamp":"2025-02-13T01:19:47.949336796+10:00","EventID":783,"EventName":"module_load","ThreadStartTime":"2025-02-13T01:19:47.936944684+10:00","ProcessorID":11,"ProcessID":1637035,"ThreadID":1637035,"ParentProcessID":1497772,"HostProcessID":1637035,"HostThreadID":1637035,"HostParentProcessID":1497772,"UserID":0,"MountNS":4026531841,"ProcessName":"modprobe","HostName":"devbox","CgroupID":6344,"MainHostname":"devbox"},"EventData":{"name":"raid0","version":"","src_version":"F80BCFC5A37DB69C992A616","pathname":"/usr/lib/modules/5.15.0-131-generic/kernel/drivers/md/raid0.ko","dev":265289728,"inode":2927026,"ctime":1738101387402437264,"ProcInfo":{"Name":"modprobe","Username":0,"Exe":"/usr/sbin/modprobe","CommandLine":"modprobe raid0","CreateTime":"2025-02-13T01:19:47.939353257+10:00"}}}

</pre><h5 id=mount-a-filesystem-is-mounted>mount: A filesystem is mounted
<a class=anchor href=#mount-a-filesystem-is-mounted>#</a></h5><pre class=json-renderer>
{"Timestamp":"2025-02-12T21:15:32+10:00","EventType":"mount","System":{"Timestamp":"2025-02-12T18:21:23.131524017+10:00","EventID":165,"EventName":"mount","ThreadStartTime":"2025-02-12T18:21:23.121883153+10:00","ProcessorID":11,"ProcessID":1544183,"ThreadID":1544183,"ParentProcessID":1544169,"HostProcessID":1544183,"HostThreadID":1544183,"HostParentProcessID":1544169,"UserID":0,"MountNS":4026531841,"ProcessName":"mount.cifs","HostName":"devbox","CgroupID":6344,"MainHostname":"devbox"},"EventData":{"source":"//192.168.1.153/Shared","target":".","filesystemtype":"cifs","mountflags":0,"data":94258787270320,"ProcInfo":{"Name":"mount.cifs","CommandLine":"/sbin/mount.cifs //192.168.1.153/Shared /home/mic/windows -o rw,credentials=/home/mic/.credentials,uid=1000,gid=1000","CreateTime":"2025-02-12T21:15:25+10:00","Exe":"/usr/sbin/mount.cifs","Cwd":"/home/mic/windows","Username":"root"}}}

</pre><h5 id=sched_process_exec-a-process-starts>sched_process_exec: A process starts
<a class=anchor href=#sched_process_exec-a-process-starts>#</a></h5><pre class=json-renderer>
{"Timestamp":"2025-02-12T21:20:34+10:00","EventType":"sched_process_exec","System":{"Timestamp":"2025-02-12T18:26:31.694485948+10:00","EventID":715,"EventName":"sched_process_exec","ThreadStartTime":"2025-02-12T18:26:31.687074227+10:00","ProcessorID":0,"ProcessID":1547749,"ThreadID":1547749,"ParentProcessID":1506235,"HostProcessID":1547749,"HostThreadID":1547749,"HostParentProcessID":1506235,"UserID":1000,"MountNS":4026531841,"ProcessName":"ssh","HostName":"devbox","CgroupID":6344,"MainHostname":"devbox"},"EventData":{"cmdpath":"/usr/bin/ssh","pathname":"/usr/bin/ssh","dev":265289728,"inode":2627189,"ctime":1719890760862661949,"inode_mode":33261,"interpreter_pathname":"","interpreter_dev":0,"interpreter_inode":0,"interpreter_ctime":0,"argv":["ssh","localhost"],"interp":"/usr/bin/ssh","stdin_type":8192,"stdin_path":"/dev/pts/13","invoked_from_kernel":0,"prev_comm":"bash","env":[],"ProcInfo":{"CreateTime":null}}}

</pre><h5 id=security_socket_connect-a-process-is-making-an-outbound-connection>security_socket_connect: A process is making an outbound connection
<a class=anchor href=#security_socket_connect-a-process-is-making-an-outbound-connection>#</a></h5><pre class=json-renderer>
{"Timestamp":"2025-02-13T00:41:08+10:00","EventType":"security_socket_connect","System":{"Timestamp":"2025-02-12T19:51:17.61437999+10:00","EventID":736,"EventName":"security_socket_connect","ThreadStartTime":"2025-02-12T19:51:17.600313258+10:00","ProcessorID":15,"ProcessID":1606982,"ThreadID":1606982,"ParentProcessID":2569,"HostProcessID":1606982,"HostThreadID":1606982,"HostParentProcessID":2569,"UserID":1000,"MountNS":4026531841,"ProcessName":"ssh","HostName":"devbox","CgroupID":6344,"MainHostname":"devbox"},"EventData":{"sockfd":3,"type":1,"remote_addr":{"sa_family":"AF_INET","sin_addr":"192.168.1.1","sin_port":"22"},"ProcInfo":{"Name":"ssh","CommandLine":"ssh hostname","CreateTime":"2025-02-13T00:41:06+10:00","Exe":"/usr/bin/ssh","Cwd":"/home/mic/","Username":"mic"}}}

</pre><h5 id=security_socket_bind-a-process-is-binding-to-a-socket>security_socket_bind: A process is binding to a socket
<a class=anchor href=#security_socket_bind-a-process-is-binding-to-a-socket>#</a></h5><pre class=json-renderer>
{"Timestamp":"2025-02-13T00:34:48+10:00","EventType":"security_socket_bind","System":{"Timestamp":"2025-02-12T19:44:58.527067089+10:00","EventID":738,"EventName":"security_socket_bind","ThreadStartTime":"2025-02-12T19:44:58.521605416+10:00","ProcessorID":8,"ProcessID":1602622,"ThreadID":1602622,"ParentProcessID":2569,"HostProcessID":1602622,"HostThreadID":1602622,"HostParentProcessID":2569,"UserID":1000,"MountNS":4026531841,"ProcessName":"nc","HostName":"devbox","CgroupID":6344,"MainHostname":"devbox"},"EventData":{"sockfd":3,"local_addr":{"sa_family":"AF_INET","sin_addr":"0.0.0.0","sin_port":"6666"},"ProcInfo":{"Name":"nc","CommandLine":"nc -l -p 6666","CreateTime":"2025-02-13T00:34:47+10:00","Exe":"/usr/bin/nc.openbsd","Cwd":"/home/mic/projects/velociraptor-sigma-rules","Username":"mic"}}}

</pre><h5 id=security_inode_unlink-a-file-is-deleted>security_inode_unlink: A file is deleted
<a class=anchor href=#security_inode_unlink-a-file-is-deleted>#</a></h5><pre class=json-renderer>
{"Timestamp":"2025-02-13T01:05:47+10:00","EventType":"security_inode_unlink","System":{"Timestamp":"2025-02-13T01:05:47.24461195+10:00","EventID":733,"EventName":"security_inode_unlink","ThreadStartTime":"2025-02-13T01:05:47.239887186+10:00","ProcessorID":14,"ProcessID":1627429,"ThreadID":1627429,"ParentProcessID":1497772,"HostProcessID":1627429,"HostThreadID":1627429,"HostParentProcessID":1497772,"UserID":0,"MountNS":4026531841,"ProcessName":"rm","HostName":"devbox","CgroupID":6344,"MainHostname":"devbox"},"EventData":{"pathname":"/tmp/owned.sh","inode":2142763,"dev":265289728,"ctime":1739372746203242108,"ProcInfo":{"Name":"rm","Username":0,"Exe":"/usr/bin/rm","CommandLine":"rm /tmp/owned.sh","CreateTime":"2025-02-13T01:05:47.241443048+10:00"}}}

</pre><h5 id=chown-a-file-is-changing-ownership>chown: A file is changing ownership
<a class=anchor href=#chown-a-file-is-changing-ownership>#</a></h5><pre class=json-renderer>
{"Timestamp":"2025-02-13T01:10:41+10:00","EventType":"fchownat","System":{"Timestamp":"2025-02-13T01:10:41.543170814+10:00","EventID":260,"EventName":"fchownat","ThreadStartTime":"2025-02-13T01:10:41.536500565+10:00","ProcessorID":13,"ProcessID":1630757,"ThreadID":1630757,"ParentProcessID":1497772,"HostProcessID":1630757,"HostThreadID":1630757,"HostParentProcessID":1497772,"UserID":0,"MountNS":4026531841,"ProcessName":"chown","HostName":"devbox","CgroupID":6344,"MainHostname":"devbox"},"EventData":{"dirfd":-100,"pathname":"/tmp/owned.sh","owner":1000,"group":1000,"flags":0,"ProcInfo":{"Name":"chown","Username":0,"Exe":"/usr/bin/chown","CommandLine":"chown mic:mic /tmp/owned.sh","CreateTime":"2025-02-13T01:10:41.538574768+10:00"}}}

</pre><h4 id=sample-use-in-a-sigma-rule>Sample use in a sigma rule:
<a class=anchor href=#sample-use-in-a-sigma-rule>#</a></h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#f92672>logsource</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>category</span>: <span style=color:#ae81ff>ebpf</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>product</span>: <span style=color:#ae81ff>linux</span>
</span></span></code></pre></div></div></div></article><footer class=book-footer><div class="flex flex-wrap justify-between"></div><script>(function(){function e(e){const t=window.getSelection(),n=document.createRange();n.selectNodeContents(e),t.removeAllRanges(),t.addRange(n)}document.querySelectorAll("pre code").forEach(t=>{t.addEventListener("click",function(){if(window.getSelection().toString())return;e(t.parentElement),navigator.clipboard&&navigator.clipboard.writeText(t.parentElement.textContent)})})})()</script></footer><div class=book-comments></div><label for=menu-control class="hidden book-menu-overlay"></label></div></main></body></html>