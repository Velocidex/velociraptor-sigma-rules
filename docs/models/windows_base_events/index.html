<!doctype html><html lang=en-us dir=ltr><head><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="
  Windows.Sigma.BaseEvents Model
  #

Sigma Model for live monitoring of Windows systems based on local
event logs.
This is a real time monitoring profile which allows live monitoring
of Windows systems using Sigma rules. This profile only covers event
logs by following the EVTX files.
For more dynamic event monitoring see the Windows.Sigma.ETWBase
artifact which uses ETW as the monitoring mechanism.
This model is mostly compatible with the standard ruleset available
from SigmaHQ, Hayabusa etc."><meta name=theme-color media="(prefers-color-scheme: light)" content="#ffffff"><meta name=theme-color media="(prefers-color-scheme: dark)" content="#343a40"><meta name=color-scheme content="light dark"><meta property="og:url" content="http://sigma.velocidex.com/docs/models/windows_base_events/"><meta property="og:site_name" content="Velociraptor Curated Sigma"><meta property="og:title" content="Velociraptor Curated Sigma"><meta property="og:description" content="Windows.Sigma.BaseEvents Model # Sigma Model for live monitoring of Windows systems based on local event logs.
This is a real time monitoring profile which allows live monitoring of Windows systems using Sigma rules. This profile only covers event logs by following the EVTX files.
For more dynamic event monitoring see the Windows.Sigma.ETWBase artifact which uses ETW as the monitoring mechanism.
This model is mostly compatible with the standard ruleset available from SigmaHQ, Hayabusa etc."><meta property="og:locale" content="en_us"><meta property="og:type" content="website"><title>&lt;span class="icon">
&lt;i class="fa-solid fa-book">&lt;/i>
Windows Base Events
&lt;/span> | Velociraptor Curated Sigma</title><link rel=icon href=/favicon.png><link rel=manifest href=/manifest.json><link rel=canonical href=http://sigma.velocidex.com/docs/models/windows_base_events/><link rel=stylesheet href=/book.min.3257a7ce7c061eb5dfc72257c356229b1470dc77ce9b982ac220c02542f9f04f.css integrity="sha256-MlenznwGHrXfxyJXw1YimxRw3HfOm5gqwiDAJUL58E8=" crossorigin=anonymous><link rel=alternate type=application/rss+xml href=http://sigma.velocidex.com/docs/models/windows_base_events/index.xml title="Velociraptor Curated Sigma"><script src=/js/jquery-3.3.1.min.js?1703133391></script><link href=https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css?1703133392 rel=stylesheet><link href=/css/theme.css rel=stylesheet><link href=//cdn.datatables.net/2.3.0/css/dataTables.dataTables.min.css rel=stylesheet><script src=//cdn.datatables.net/2.3.0/js/dataTables.min.js></script><link href=//cdnjs.cloudflare.com/ajax/libs/font-awesome/6.7.2/css/all.min.css rel=stylesheet><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.11.1/styles/default.min.css><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.11.1/highlight.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.11.1/languages/yaml.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/featherlight/1.7.13/featherlight.min.js integrity="sha512-0UbR6HN0dY8fWN9T7fF658896tsPgnbRREHCNq46J9/JSn8GonXDZmqtTc3qS879GM0zV49b9LPhdc/maKP8Kg==" crossorigin=anonymous referrerpolicy=no-referrer></script><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/featherlight/1.7.13/featherlight.min.css integrity="sha512-56GJrpSgHk6Mc9Fltt+bQKcICJoEpxtvozXPA5n5OT0rfWiqGlJmJCI/vl16kctf/0XbBloh03vl7OF2xFnR8g==" crossorigin=anonymous referrerpolicy=no-referrer><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/font-awesome/7.0.0/css/all.min.css rel=stylesheet><script>$(document).ready(function(){$(".json-renderer").each(function(){try{data=JSON.parse($(this).text()),$(this).jsonViewer(data,{collapsed:!0,rootCollapsable:!1})}catch{}}),$(".datatable").each(function(){new DataTable(this,{paging:!0})}),$(".scroll-datatable").each(function(){let e=$(this),t=new DataTable(this,{paging:!1,scrollY:200})})})</script></head><body dir=ltr><input type=checkbox class="hidden toggle" id=menu-control>
<input type=checkbox class="hidden toggle" id=toc-control><main class="container flex"><aside class=book-menu><div class=book-menu-content><nav><h2 class=book-brand><a class="flex align-center" href=/><span>Velociraptor Curated Sigma</span></a></h2><ul><li><a href=/docs/sigma_in_velociraptor/><span class=icon><i class="fa-solid fa-blog"></i>
Sigma In Velociraptor</span></a><ul><li><a href=/docs/sigma_in_velociraptor/customize/>Customizing Artifacts</a><ul></ul></li></ul></li><li><a href=/docs/artifacts/><span class=icon><i class="fa-solid fa-desktop"></i>
Velociraptor Artifacts</span></a><ul><li><a href=/docs/artifacts/linux.ebpf.monitoring/><span class=icon><i class="fa-solid fa-book"></i>
Linux.EBPF.Monitoring</span></a><ul></ul></li><li><a href=/docs/artifacts/linux.sigma.triage/><span class=icon><i class="fa-solid fa-book"></i>
Linux.Sigma.Triage</span></a><ul></ul></li><li><a href=/docs/artifacts/windows.etw.monitoring/><span class=icon><i class="fa-solid fa-book"></i>
Windows.ETW.Monitoring</span></a><ul></ul></li><li><a href=/docs/artifacts/windows.hayabusa.monitoring/><span class=icon><i class="fa-solid fa-book"></i>
Windows.Hayabusa.Monitoring</span></a><ul></ul></li><li><a href=/docs/artifacts/windows.hayabusa.rules/><span class=icon><i class="fa-solid fa-book"></i>
Windows.Hayabusa.Rules</span></a><ul></ul></li><li><a href=/docs/artifacts/windows.sigma.triage/><span class=icon><i class="fa-solid fa-book"></i>
Windows.Sigma.Triage</span></a><ul></ul></li></ul></li><li><a href=/docs/models/><span class=icon><i class="fa-solid fa-desktop"></i>
Sigma Models</span></a><ul><li><a href=/docs/models/linux_base/><span class=icon><i class="fa-solid fa-book"></i>
Linux Base</span></a><ul></ul></li><li><a href=/docs/models/linux_ebpf_base/><span class=icon><i class="fa-solid fa-book"></i>
Linux Ebpf Base</span></a><ul></ul></li><li><a href=/docs/models/windows_base/><span class=icon><i class="fa-solid fa-book"></i>
Windows Base</span></a><ul></ul></li><li><a href=/docs/models/windows_base_events/ class=active><span class=icon><i class="fa-solid fa-book"></i>
Windows Base Events</span></a><ul></ul></li><li><a href=/docs/models/windows_base_vql/><span class=icon><i class="fa-solid fa-book"></i>
Windows Base Vql</span></a><ul></ul></li><li><a href=/docs/models/windows_etw_base/><span class=icon><i class="fa-solid fa-book"></i>
Windows Etw Base</span></a><ul></ul></li></ul></li><li><a href=/docs/github/><span class=icon><i class="fa-brands fa-github"></i>
Github</span></a><ul></ul></li></ul></nav><script>(function(){var e=document.querySelector("aside .book-menu-content");addEventListener("beforeunload",function(){localStorage.setItem("menu.scrollTop",e.scrollTop)}),e.scrollTop=localStorage.getItem("menu.scrollTop")})()</script></div></aside><div class=book-page><header class=book-header><div class="flex align-center justify-between"><label for=menu-control><img src=/svg/menu.svg class=book-icon alt=Menu></label><h3><span class=icon><i class="fa-solid fa-book"></i>
Windows Base Events</span></h3><label for=toc-control></label></div></header><article class="markdown book-article"><h1 id=windowssigmabaseevents-model>Windows.Sigma.BaseEvents Model
<a class=anchor href=#windowssigmabaseevents-model>#</a></h1><p>Sigma Model for live monitoring of Windows systems based on local
event logs.</p><p>This is a real time monitoring profile which allows live monitoring
of Windows systems using Sigma rules. This profile only covers event
logs by following the EVTX files.</p><p>For more dynamic event monitoring see the Windows.Sigma.ETWBase
artifact which uses ETW as the monitoring mechanism.</p><p>This model is mostly compatible with the standard ruleset available
from SigmaHQ, Hayabusa etc.</p><h2 id=log-sources>Log Sources
<a class=anchor href=#log-sources>#</a></h2><p>Following is a list of recognized log sources.</p><table class=scroll-datatable><thead><tr><th>Log Source</th><th>Desc</th></tr></thead><tbody><tr><td><a href=#windowsapplication>*/windows/application</a></td><td></td></tr><tr><td><a href=#windowsapplocker>*/windows/applocker</a></td><td></td></tr><tr><td><a href=#windowsappmodel-runtime>*/windows/appmodel-runtime</a></td><td></td></tr><tr><td><a href=#windowsappxdeployment-server>*/windows/appxdeployment-server</a></td><td></td></tr><tr><td><a href=#windowsappxpackaging-om>*/windows/appxpackaging-om</a></td><td></td></tr><tr><td><a href=#windowsbits-client>*/windows/bits-client</a></td><td></td></tr><tr><td><a href=#windowscapi2>*/windows/capi2</a></td><td></td></tr><tr><td><a href=#windowscertificateservicesclient-lifecycle-system>*/windows/certificateservicesclient-lifecycle-system</a></td><td></td></tr><tr><td><a href=#windowscodeintegrity-operational>*/windows/codeintegrity-operational</a></td><td></td></tr><tr><td><a href=#windowsdiagnosis-scripted>*/windows/diagnosis-scripted</a></td><td></td></tr><tr><td><a href=#windowsdns-client>*/windows/dns-client</a></td><td></td></tr><tr><td><a href=#windowsdns-server>*/windows/dns-server</a></td><td></td></tr><tr><td><a href=#windowsdns-server-analytic>*/windows/dns-server-analytic</a></td><td></td></tr><tr><td><a href=#windowsdriver-framework>*/windows/driver-framework</a></td><td></td></tr><tr><td><a href=#windowsfirewall-as>*/windows/firewall-as</a></td><td></td></tr><tr><td><a href=#windowsldapdebug>*/windows/ldap_debug</a></td><td></td></tr><tr><td><a href=#windowslsa-server>*/windows/lsa-server</a></td><td></td></tr><tr><td><a href=#windowsmicrosoft-servicebus-client>*/windows/microsoft-servicebus-client</a></td><td></td></tr><tr><td><a href=#windowsmsexchange-management>*/windows/msexchange-management</a></td><td></td></tr><tr><td><a href=#windowsntlm>*/windows/ntlm</a></td><td></td></tr><tr><td><a href=#windowsopenssh>*/windows/openssh</a></td><td></td></tr><tr><td><a href=#windowspowershell>*/windows/powershell</a></td><td></td></tr><tr><td><a href=#windowspowershell-classic>*/windows/powershell-classic</a></td><td></td></tr><tr><td><a href=#windowssecurity>*/windows/security</a></td><td></td></tr><tr><td><a href=#windowssecurity-mitigations>*/windows/security-mitigations</a></td><td></td></tr><tr><td><a href=#windowsshell-core>*/windows/shell-core</a></td><td></td></tr><tr><td><a href=#windowssmbclient-security>*/windows/smbclient-security</a></td><td></td></tr><tr><td><a href=#windowssysmon>*/windows/sysmon</a></td><td></td></tr><tr><td><a href=#windowssystem>*/windows/system</a></td><td></td></tr><tr><td><a href=#windowstaskscheduler>*/windows/taskscheduler</a></td><td></td></tr><tr><td><a href=#windowsterminalservices-localsessionmanager>*/windows/terminalservices-localsessionmanager</a></td><td></td></tr><tr><td><a href=#windowsvhdmp>*/windows/vhdmp</a></td><td></td></tr><tr><td><a href=#windowswindefend>*/windows/windefend</a></td><td></td></tr><tr><td><a href=#windowswmi>*/windows/wmi</a></td><td></td></tr><tr><td><a href=#processcreationwindows>process_creation/windows/*</a></td><td></td></tr><tr><td><a href=#psclassicproviderstartwindows>ps_classic_provider_start/windows/*</a></td><td></td></tr><tr><td><a href=#psclassicstartwindows>ps_classic_start/windows/*</a></td><td></td></tr><tr><td><a href=#psmodulewindows>ps_module/windows/*</a></td><td></td></tr><tr><td><a href=#psscriptwindows>ps_script/windows/*</a></td><td></td></tr><tr><td><a href=#registryaddwindows>registry_add/windows/*</a></td><td></td></tr><tr><td><a href=#registryeventwindows>registry_event/windows/*</a></td><td></td></tr><tr><td><a href=#registrysetwindows>registry_set/windows/*</a></td><td></td></tr><tr><td><a href=#antiviruswindowswindefend>antivirus/windows/windefend</a></td><td></td></tr></tbody></table><h2 id=field-mappings>Field Mappings
<a class=anchor href=#field-mappings>#</a></h2><p>The following field mappings can be used to access fields within the
event. Note that it is also possible to access the fields directly
(e.g. <code>EventData.AccessMask</code>)</p><div class=expand><div class=expand-label style=cursor:pointer onclick='$h=$(this),$h.next("div").slideToggle(100,function(){$h.children("i").attr("class",function(){return $h.next("div").is(":visible")?"fas fa-chevron-down":"fas fa-chevron-right"})})'><i style=font-size:x-small class="fas fa-chevron-right"></i>
<span>View all Field Mappings</span></div><div class=expand-content style=display:none><table class=datatable><thead><tr><th>Name</th><th>Mapping</th></tr></thead><tbody><tr><td></td><td>x=>serialize(item=x.EventData)</td></tr><tr><td>AccessList</td><td>x=>x.EventData.AccessList</td></tr><tr><td>AccessMask</td><td>x=>x.EventData.AccessMask</td></tr><tr><td>AccessReason</td><td>x=>x.EventData.AccessReason</td></tr><tr><td>Accesses</td><td>x=>x.EventData.Accesses</td></tr><tr><td>AccountDomain</td><td>x=>x.EventData.AccountDomain</td></tr><tr><td>AccountExpires</td><td>x=>x.EventData.AccountExpires</td></tr><tr><td>AccountName</td><td>x=>x.EventData.AccountName</td></tr><tr><td>Account_Name</td><td>x=>x.EventData.Account_Name</td></tr><tr><td>Action</td><td>x=>x.EventData.Action</td></tr><tr><td>ActionName</td><td>x=>x.EventData.ActionName</td></tr><tr><td>AdditionalInfo</td><td>x=>x.EventData.AdditionalInfo</td></tr><tr><td>Address</td><td>x=>x.EventData.Address</td></tr><tr><td>AllowedToDelegateTo</td><td>x=>x.EventData.AllowedToDelegateTo</td></tr><tr><td>AppID</td><td>x=>x.EventData.AppID</td></tr><tr><td>AppName</td><td>x=>x.EventData.Data[0]</td></tr><tr><td>AppVersion</td><td>x=>x.EventData.AppVersion</td></tr><tr><td>Application</td><td>x=>x.EventData.Application</td></tr><tr><td>ApplicationPath</td><td>x=>x.EventData.ApplicationPath</td></tr><tr><td>AttributeLDAPDisplayName</td><td>x=>x.EventData.AttributeLDAPDisplayName</td></tr><tr><td>AttributeValue</td><td>x=>x.EventData.AttributeValue</td></tr><tr><td>AuditPolicyChanges</td><td>x=>x.EventData.AuditPolicyChanges</td></tr><tr><td>AuditSourceName</td><td>x=>x.EventData.AuditSourceName</td></tr><tr><td>AuthenticationPackageName</td><td>x=>x.EventData.AuthenticationPackageName</td></tr><tr><td>Binary</td><td>x=>x.EventData.Binary</td></tr><tr><td>BootMode</td><td>x=>x.EventData.BootMode</td></tr><tr><td>CallTrace</td><td>x=>x.EventData.CallTrace</td></tr><tr><td>CallerProcessName</td><td>x=>x.EventData.CallerProcessName</td></tr><tr><td>Caller_Process_Name</td><td>x=>x.EventData.Caller_Process_Name</td></tr><tr><td>CallingProcessName</td><td>x=>x.EventData.CallingProcessName</td></tr><tr><td>Caption</td><td>x=>x.EventData.Caption</td></tr><tr><td>CategoryId</td><td>x=>x.EventData.CategoryId</td></tr><tr><td>CategoryName</td><td>x=>x.EventData.`Category Name`</td></tr><tr><td>CertThumbprint</td><td>x=>x.EventData.CertThumbprint</td></tr><tr><td>Channel</td><td>x=>x.System.Channel</td></tr><tr><td>ClassName</td><td>x=>x.EventData.ClassName</td></tr><tr><td>ClientAddress</td><td>x=>x.EventData.ClientAddress</td></tr><tr><td>ClientInfo</td><td>x=>x.EventData.ClientInfo</td></tr><tr><td>ClientName</td><td>x=>x.EventData.ClientName</td></tr><tr><td>ClientProcessId</td><td>x=>x.EventData.ClientProcessId</td></tr><tr><td>Client_Address</td><td>x=>x.EventData.Client_Address</td></tr><tr><td>CommandLine</td><td>x=>x.EventData.CommandLine || x.CommandLine</td></tr><tr><td>Company</td><td>x=>x.EventData.Company</td></tr><tr><td>CompatibleIds</td><td>x=>x.EventData.CompatibleIds</td></tr><tr><td>Computer</td><td>x=>x.System.Computer</td></tr><tr><td>ComputerName</td><td>x=>x.System.Computer</td></tr><tr><td>Configuration</td><td>x=>x.EventData.Configuration</td></tr><tr><td>Consumer</td><td>x=>x.EventData.Consumer</td></tr><tr><td>Contents</td><td>x=>x.EventData.Contents</td></tr><tr><td>ContextInfo</td><td>x=>x.EventData.ContextInfo</td></tr><tr><td>CountOfCredentialsReturned</td><td>x=>x.EventData.CountOfCredentialsReturned</td></tr><tr><td>CreationUtcTime</td><td>x=>x.EventData.CreationUtcTime</td></tr><tr><td>CurrentDirectory</td><td>x=>x.EventData.CurrentDirectory</td></tr><tr><td>Data</td><td>x=>serialize(item=x.EventData)</td></tr><tr><td>Description</td><td>x=>x.EventData.Description</td></tr><tr><td>DestAddress</td><td>x=>x.EventData.DestAddress</td></tr><tr><td>DestPort</td><td>x=>x.EventData.DestPort</td></tr><tr><td>Destination</td><td>x=>x.EventData.Destination</td></tr><tr><td>DestinationAddress</td><td>x=>x.EventData.DestinationAddress</td></tr><tr><td>DestinationHostname</td><td>x=>x.EventData.DestinationHostname</td></tr><tr><td>DestinationIp</td><td>x=>x.EventData.DestinationIp</td></tr><tr><td>DestinationIsIpv6</td><td>x=>x.EventData.DestinationIsIpv6</td></tr><tr><td>DestinationPort</td><td>x=>x.EventData.DestinationPort</td></tr><tr><td>Details</td><td>x=>x.EventData.Details</td></tr><tr><td>DetectionSource</td><td>x=>x.EventData.DetectionSource</td></tr><tr><td>DetectionUser</td><td>x=>x.EventData.`Detection User`</td></tr><tr><td>Device</td><td>x=>x.EventData.Device</td></tr><tr><td>DeviceClassName</td><td>x=>x.EventData.DeviceClassName</td></tr><tr><td>DeviceDescription</td><td>x=>x.EventData.DeviceDescription</td></tr><tr><td>DeviceId</td><td>x=>x.EventData.DeviceId</td></tr><tr><td>DeviceInstanceID</td><td>x=>x.UserData.InstallDeviceID.DeviceInstanceID</td></tr><tr><td>DeviceName</td><td>x=>x.EventData.DeviceName</td></tr><tr><td>Direction</td><td>x=>x.EventData.Direction</td></tr><tr><td>DisplayName</td><td>x=>x.EventData.DisplayName</td></tr><tr><td>DomainName</td><td>x=>x.EventData.SubjectDomainName</td></tr><tr><td>DriveName</td><td>x=>x.EventData.DriveName</td></tr><tr><td>DriverDescription</td><td>x=>x.UserData.InstallDeviceID.DriverDescription</td></tr><tr><td>DriverProvider</td><td>x=>x.UserData.InstallDeviceID.DriverProvider</td></tr><tr><td>DvrFmwk2003InstanceId</td><td>x=>x.UserData.UMDFHostDeviceArrivalBegin.InstanceId</td></tr><tr><td>DvrFmwkInstanceId</td><td>x=>x.UserData.UMDFHostDeviceRequest.InstanceId</td></tr><tr><td>ETWFileName</td><td>x=>x.EventData.FileName</td></tr><tr><td>EngineVersion</td><td>x=>x.EventData.EngineVersion</td></tr><tr><td>ErrorCode</td><td>x=>x.EventData.ErrorCode</td></tr><tr><td>EventID</td><td>x=>x.System.EventID.Value</td></tr><tr><td>EventNamespace</td><td>x=>x.EventData.EventNamespace</td></tr><tr><td>EventSourceId</td><td>x=>x.EventData.EventSourceId</td></tr><tr><td>EventType</td><td>x=>x.System.EventType</td></tr><tr><td>ExceptionCode</td><td>x=>x.EventData.ExceptionCode</td></tr><tr><td>ExecutionProcessID</td><td>x=>x.System.Execution.ProcessID</td></tr><tr><td>FailureCode</td><td>x=>x.EventData.FailureCode</td></tr><tr><td>FailureReason</td><td>x=>x.EventData.FailureReason</td></tr><tr><td>Feature_Name</td><td>x=>x.EventData.`Feature Name`</td></tr><tr><td>FileMagicBytes</td><td>x=>x.EventData.FileMagicBytes</td></tr><tr><td>FileName</td><td>x=>x.EventData.FileName</td></tr><tr><td>FileNameBuffer</td><td>x=>x.EventData.FileNameBuffer</td></tr><tr><td>FilePath</td><td>x=>x.EventData.FilePath</td></tr><tr><td>FileVersion</td><td>x=>x.EventData.FileVersion</td></tr><tr><td>Filename</td><td>x=>x.EventData.Filename</td></tr><tr><td>Filter</td><td>x=>x.EventData.Filter</td></tr><tr><td>FilterName</td><td>x=>x.EventData.FilterName</td></tr><tr><td>FilterOrigin</td><td>x=>x.EventData.FilterOrigin</td></tr><tr><td>GrandParentImage</td><td>x=>x.EventData.GrandParentImage</td></tr><tr><td>GrantedAccess</td><td>x=>x.EventData.GrantedAccess</td></tr><tr><td>GroupName</td><td>x=>x.EventData.GroupName</td></tr><tr><td>GroupSid</td><td>x=>x.EventData.GroupSid</td></tr><tr><td>HandleId</td><td>x=>x.EventData.HandleId</td></tr><tr><td>Hash</td><td>x=>x.EventData.Hash</td></tr><tr><td>Hashes</td><td>x=>x.EventData.Hashes</td></tr><tr><td>HiveName</td><td>x=>x.EventData.HiveName</td></tr><tr><td>HomeDirectory</td><td>x=>x.EventData.HomeDirectory</td></tr><tr><td>HomePath</td><td>x=>x.EventData.HomePath</td></tr><tr><td>HostApplication</td><td>x=>x.EventData.HostApplication</td></tr><tr><td>HostName</td><td>x=>x.EventData.HostName</td></tr><tr><td>HostVersion</td><td>x=>x.EventData.HostVersion</td></tr><tr><td>ID</td><td>x=>x.EventData.ID</td></tr><tr><td>Image</td><td>x=>x.EventData.Image</td></tr><tr><td>ImageLoaded</td><td>x=>x.EventData.ImageLoaded</td></tr><tr><td>ImageName</td><td>x=>x.EventData.ImageName</td></tr><tr><td>ImagePath</td><td>x=>x.EventData.ImagePath</td></tr><tr><td>ImpersonationLevel</td><td>x=>x.EventData.ImpersonationLevel</td></tr><tr><td>Imphash</td><td>x=>x.EventData.Hashes</td></tr><tr><td>Initiated</td><td>x=>x.EventData.Initiated</td></tr><tr><td>InstallStatus</td><td>x=>x.UserData.InstallDeviceID.InstallStatus</td></tr><tr><td>InstanceID</td><td>x=>x.UserData.UMDFHostDeviceArrivalBegin.InstanceId</td></tr><tr><td>InstanceId</td><td>x=>x.EventData.InstanceId</td></tr><tr><td>IntegrityLevel</td><td>x=>x.EventData.IntegrityLevel</td></tr><tr><td>IpAddress</td><td>x=>x.EventData.IpAddress</td></tr><tr><td>IpPort</td><td>x=>x.EventData.IpPort</td></tr><tr><td>IsatapRouter</td><td>x=>x.EventData.IsatapRouter</td></tr><tr><td>JobTitle</td><td>x=>x.EventData.name</td></tr><tr><td>KeyLength</td><td>x=>x.EventData.KeyLength</td></tr><tr><td>Keywords</td><td>x=>x.System.Keywords</td></tr><tr><td>LDAPDisplayName</td><td>x=>x.EventData.LDAPDisplayName</td></tr><tr><td>LayerRTID</td><td>x=>x.EventData.LayerRTID</td></tr><tr><td>Level</td><td>x=>x.System.Level</td></tr><tr><td>LocalAddresses</td><td>x=>x.EventData.LocalAddresses</td></tr><tr><td>LocalName</td><td>x=>x.EventData.LocalName</td></tr><tr><td>LocalPorts</td><td>x=>x.EventData.LocalPorts</td></tr><tr><td>LocationInformation</td><td>x=>x.EventData.LocationInformation</td></tr><tr><td>LogFileClearedChannel</td><td>x=>x.UserData.LogFileCleared.Channel</td></tr><tr><td>LogFileClearedSubjectUserName</td><td>x=>x.UserData.LogFileCleared.SubjectUserName</td></tr><tr><td>LogonGuid</td><td>x=>x.EventData.LogonGuid</td></tr><tr><td>LogonHours</td><td>x=>x.EventData.LogonHours</td></tr><tr><td>LogonID</td><td>x=>x.EventData.LogonId</td></tr><tr><td>LogonId</td><td>x=>x.EventData.LogonId</td></tr><tr><td>LogonProcessName</td><td>x=>x.EventData.LogonProcessName</td></tr><tr><td>LogonType</td><td>x=>x.EventData.LogonType</td></tr><tr><td>Logon_Account</td><td>x=>x.EventData.Logon_Account</td></tr><tr><td>Logon_Type</td><td>x=>x.EventData.LogonType</td></tr><tr><td>MachineName</td><td>x=>x.EventData.MachineName</td></tr><tr><td>MandatoryLabel</td><td>x=>get(item=MandatoryLabelLookup, member=x.EventData.MandatoryLabel || "-")</td></tr><tr><td>MasterKeyId</td><td>x=>x.EventData.MasterKeyId</td></tr><tr><td>MemberName</td><td>x=>x.EventData.MemberName</td></tr><tr><td>MemberSid</td><td>x=>x.EventData.MemberSid</td></tr><tr><td>Message</td><td>x=>x.EventData</td></tr><tr><td>ModifyingApplication</td><td>x=>x.EventData.ModifyingApplication</td></tr><tr><td>ModifyingUser</td><td>x=>x.EventData.ModifyingUser</td></tr><tr><td>Module</td><td>x=>x.EventData.Module</td></tr><tr><td>Name</td><td>x=>x.EventData.Name</td></tr><tr><td>NewDefaultPrinter</td><td>x=>x.EventData.NewDefaultPrinter</td></tr><tr><td>NewName</td><td>x=>x.EventData.NewName</td></tr><tr><td>NewProcessId</td><td>x=>x.EventData.NewProcessId</td></tr><tr><td>NewProcessName</td><td>x=>x.EventData.NewProcessName</td></tr><tr><td>NewTargetUserName</td><td>x=>x.EventData.NewTargetUserName</td></tr><tr><td>NewTemplateContent</td><td>x=> x.EventData.NewTemplateContent</td></tr><tr><td>NewTime</td><td>x=>x.EventData.NewTime</td></tr><tr><td>NewUacValue</td><td>x=>x.EventData.NewUacValue</td></tr><tr><td>NewValue</td><td>x=>x.EventData.NewValue</td></tr><tr><td>New_Value</td><td>x=>x.EventData.`New Value`</td></tr><tr><td>ObjectClass</td><td>x=>x.EventData.ObjectClass</td></tr><tr><td>ObjectDN</td><td>x=>x.EventData.ObjectDN</td></tr><tr><td>ObjectName</td><td>x=>x.EventData.ObjectName</td></tr><tr><td>ObjectServer</td><td>x=>x.EventData.ObjectServer</td></tr><tr><td>ObjectType</td><td>x=>x.EventData.ObjectType</td></tr><tr><td>ObjectValueName</td><td>x=>x.EventData.ObjectValueName</td></tr><tr><td>OldDefaultPrinter</td><td>x=>x.EventData.OldDefaultPrinter</td></tr><tr><td>OldTargetUserName</td><td>x=>x.EventData.OldTargetUserName</td></tr><tr><td>OldUacValue</td><td>x=>x.EventData.OldUacValue</td></tr><tr><td>OldValue</td><td>x=>x.EventData.OldValue</td></tr><tr><td>Operation</td><td>x=>x.EventData.Operation</td></tr><tr><td>OperationEssStartedNamespaceName</td><td>x=>x.UserData.Operation_EssStarted.NamespaceName</td></tr><tr><td>OperationEssStartedPossibleCause</td><td>x=>x.UserData.Operation_EssStarted.PossibleCause</td></tr><tr><td>OperationEssStartedProcessid</td><td>x=>x.UserData.Operation_EssStarted.Processid</td></tr><tr><td>OperationEssStartedProvider</td><td>x=>x.UserData.Operation_EssStarted.Provider</td></tr><tr><td>OperationEssStartedQuery</td><td>x=>x.UserData.Operation_EssStarted.Query</td></tr><tr><td>OperationEssStartedUser</td><td>x=>x.UserData.Operation_EssStarted.User</td></tr><tr><td>OperationType</td><td>x=>x.EventData.OperationType</td></tr><tr><td>Origin</td><td>x=>x.EventData.Origin</td></tr><tr><td>OriginalFileName</td><td>x=>x.EventData.OriginalFileName</td></tr><tr><td>OriginalFilename</td><td>x=>x.EventData.OriginalFileName</td></tr><tr><td>PID</td><td>x=>x.EventData.PID</td></tr><tr><td>PackageFullName</td><td>x=>x.UserData.PackageFullName</td></tr><tr><td>PackagePath</td><td>x=>x.EventData.PackagePath</td></tr><tr><td>Param1</td><td>x=>x.EventData.Param1</td></tr><tr><td>Param2</td><td>x=>x.EventData.Param2</td></tr><tr><td>Param3</td><td>x=>x.EventData.Param3</td></tr><tr><td>ParentCommandLine</td><td>x=>x.EventData.ParentCommandLine</td></tr><tr><td>ParentImage</td><td>x=>x.EventData.ParentImage</td></tr><tr><td>ParentIntegrityLevel</td><td>x=>x.EventData.ParentIntegrityLevel</td></tr><tr><td>ParentOfParentImage</td><td>x=>x.EventData.ParentOfParentImage</td></tr><tr><td>ParentProcessGuid</td><td>x=>x.EventData.ParentProcessGuid</td></tr><tr><td>ParentProcessId</td><td>x=>x.EventData.ParentProcessId</td></tr><tr><td>ParentProcessName</td><td>x=>x.EventData.ParentProcessName</td></tr><tr><td>ParentUser</td><td>x=>x.EventData.ParentUser</td></tr><tr><td>PasswordLastSet</td><td>x=>x.EventData.PasswordLastSet</td></tr><tr><td>Path</td><td>x=>x.EventData.Path</td></tr><tr><td>Payload</td><td>x=>x.EventData.Payload</td></tr><tr><td>PipeName</td><td>x=>x.EventData.PipeName</td></tr><tr><td>PossibleCause</td><td>x=>x.UserData.PossibleCause</td></tr><tr><td>PreAuthType</td><td>x=>x.EventData.PreAuthType</td></tr><tr><td>PreviousCreationUtcTime</td><td>x=>x.EventData.PreviousCreationUtcTime</td></tr><tr><td>PreviousTime</td><td>x=>x.EventData.PreviousTime</td></tr><tr><td>PrimaryGroupId</td><td>x=>x.EventData.PrimaryGroupId</td></tr><tr><td>PrinterCreated</td><td>x=>x.EventData.PrinterCreated</td></tr><tr><td>PrinterDeletionPending</td><td>x=>x.EventData.PrinterDeletionPending</td></tr><tr><td>PrinterName</td><td>x=>x.EventData.PrinterName</td></tr><tr><td>PrivilegeList</td><td>x=>x.EventData.PrivilegeList</td></tr><tr><td>ProcessCommandLine</td><td>x=>x.EventData.ProcessCommandLine || x.EventData.ProcInfo.CommandLine</td></tr><tr><td>ProcessExe</td><td>x=>x.EventData.ProcInfo.Exe</td></tr><tr><td>ProcessGuid</td><td>x=>x.EventData.ProcessGuid</td></tr><tr><td>ProcessID</td><td>x=>x.EventData.ProcessID</td></tr><tr><td>ProcessId</td><td>x=>x.EventData.ProcessId</td></tr><tr><td>ProcessName</td><td>x=>x.EventData.ProcessName || x.EventData.ProcInfo.Name</td></tr><tr><td>ProcessNameBuffer</td><td>x=>x.EventData.ProcessNameBuffer</td></tr><tr><td>ProcessPath</td><td>x=>x.EventData.ProcessPath</td></tr><tr><td>Product</td><td>x=>x.EventData.Product</td></tr><tr><td>ProfilePath</td><td>x=>x.EventData.ProfilePath</td></tr><tr><td>Profiles</td><td>x=>x.EventData.Profiles</td></tr><tr><td>Properties</td><td>x=>x.EventData.Properties</td></tr><tr><td>Protocol</td><td>x=>x.EventData.Protocol</td></tr><tr><td>Provider</td><td>x=>x.UserData.Provider</td></tr><tr><td>ProviderContextName</td><td>x=>x.EventData.ProviderContextName</td></tr><tr><td>ProviderName</td><td>x=>x.System.Provider.Name</td></tr><tr><td>Provider_Name</td><td>x=>x.System.Provider.Name</td></tr><tr><td>QNAME</td><td>x=>x.EventData.QNAME</td></tr><tr><td>Query</td><td>x=>x.UserData.Query</td></tr><tr><td>QueryName</td><td>x=>x.EventData.QueryName</td></tr><tr><td>QueryResults</td><td>x=>x.EventData.QueryResults</td></tr><tr><td>QueryStatus</td><td>x=>x.EventData.QueryStatus</td></tr><tr><td>ReadOnly</td><td>x=>x.EventData.ReadOnly</td></tr><tr><td>ReadOperation</td><td>x=>x.EventData.ReadOperation</td></tr><tr><td>Reason</td><td>x=>x.EventData.Reason</td></tr><tr><td>RecoveryKeyId</td><td>x=>x.EventData.RecoveryKeyId</td></tr><tr><td>RecoveryServer</td><td>x=>x.EventData.RecoveryServer</td></tr><tr><td>RelativeTargetName</td><td>x=>x.EventData.RelativeTargetName</td></tr><tr><td>RemoteAddress</td><td>x=>x.EventData.RemoteAddress</td></tr><tr><td>RemoteAddresses</td><td>x=>x.EventData.RemoteAddresses</td></tr><tr><td>RemoteMachineID</td><td>x=>x.EventData.RemoteMachineID</td></tr><tr><td>RemoteName</td><td>x=>x.EventData.RemoteName</td></tr><tr><td>RemotePorts</td><td>x=>x.EventData.RemotePorts</td></tr><tr><td>RemoteUserID</td><td>x=>x.EventData.RemoteUserID</td></tr><tr><td>RequestedPolicy</td><td>x=>x.EventData.RequestedPolicy</td></tr><tr><td>ReturnCode</td><td>x=>x.EventData.ReturnCode</td></tr><tr><td>RuleName</td><td>x=>x.EventData.RuleName</td></tr><tr><td>SAMAccountName</td><td>x=>x.EventData.SamAccountName</td></tr><tr><td>SamAccountName</td><td>x=>x.EventData.SamAccountName</td></tr><tr><td>SchemaVersion</td><td>x=>x.EventData.SchemaVersion</td></tr><tr><td>ScriptBlockText</td><td>x=>x.EventData.ScriptBlockText</td></tr><tr><td>ScriptPath</td><td>x=>x.EventData.ScriptPath</td></tr><tr><td>SearchFilter</td><td>x=>x.System.SearchFilter</td></tr><tr><td>SecurityUserID</td><td>x=>x.System.Security.UserID</td></tr><tr><td>ServerAddress</td><td>x=>x.EventData.ServerAddress</td></tr><tr><td>ServerName</td><td>x=>x.System.ServerName</td></tr><tr><td>Service</td><td>x=>x.EventData.Service</td></tr><tr><td>ServiceAccount</td><td>x=>x.EventData.ServiceAccount</td></tr><tr><td>ServiceFileName</td><td>x=>x.EventData.ServiceFileName</td></tr><tr><td>ServiceName</td><td>x=>x.EventData.ServiceName</td></tr><tr><td>ServicePrincipalNames</td><td>x=>x.EventData.ServicePrincipalNames</td></tr><tr><td>ServiceStartType</td><td>x=>x.EventData.ServiceStartType</td></tr><tr><td>ServiceType</td><td>x=>x.EventData.ServiceType</td></tr><tr><td>SettingType</td><td>x=>x.EventData.SettingType</td></tr><tr><td>SettingValueString</td><td>x=>x.EventData.SettingValueString</td></tr><tr><td>SeverityID</td><td>x=>x.EventData.`Severity ID`</td></tr><tr><td>SeverityName</td><td>x=>x.EventData.`Severity Name`</td></tr><tr><td>ShareLocalPath</td><td>x=>x.EventData.ShareLocalPath</td></tr><tr><td>ShareName</td><td>x=>x.EventData.ShareName</td></tr><tr><td>SidHistory</td><td>x=>x.EventData.SidHistory</td></tr><tr><td>SidList</td><td>x=>x.EventData.SidList</td></tr><tr><td>Signature</td><td>x=>x.EventData.Signature</td></tr><tr><td>SignatureStatus</td><td>x=>x.EventData.SignatureStatus</td></tr><tr><td>Signed</td><td>x=>x.EventData.Signed</td></tr><tr><td>Source</td><td>x=>x.System.Provider_Name</td></tr><tr><td>SourceAddress</td><td>x=>x.EventData.SourceAddress</td></tr><tr><td>SourceCommandLine</td><td>x=>x.EventData.SourceCommandLine</td></tr><tr><td>SourceHostname</td><td>x=>x.EventData.SourceHostname</td></tr><tr><td>SourceImage</td><td>x=>x.EventData.SourceImage</td></tr><tr><td>SourceIp</td><td>x=>x.EventData.SourceIp</td></tr><tr><td>SourceIsIpv6</td><td>x=>x.EventData.SourceIsIpv6</td></tr><tr><td>SourceName</td><td>x=>x.EventData.SourceName</td></tr><tr><td>SourceNetworkAddress</td><td>x=>x.EventData.SourceNetworkAddress</td></tr><tr><td>SourceParentImage</td><td>x=>x.EventData.SourceParentImage</td></tr><tr><td>SourcePort</td><td>x=>x.EventData.SourcePort</td></tr><tr><td>SourceProcessGUID</td><td>x=>x.EventData.SourceProcessGUID</td></tr><tr><td>SourceProcessGuid</td><td>x=>x.EventData.SourceProcessGuid</td></tr><tr><td>SourceProcessId</td><td>x=>x.EventData.SourceProcessId</td></tr><tr><td>SourceSid</td><td>x=>x.EventData.SourceSid</td></tr><tr><td>SourceUser</td><td>x=>x.EventData.SourceUser</td></tr><tr><td>SourceUserName</td><td>x=>x.EventData.SourceUserName</td></tr><tr><td>Source_Name</td><td>x=>x.EventData.`Source Name`</td></tr><tr><td>Source_Network_Address</td><td>x=>x.EventData.Source_Network_Address</td></tr><tr><td>Source_WorkStation</td><td>x=>x.EventData.Source_WorkStation</td></tr><tr><td>StartAddress</td><td>x=>x.EventData.StartAddress</td></tr><tr><td>StartFunction</td><td>x=>x.EventData.StartFunction</td></tr><tr><td>StartModule</td><td>x=>x.EventData.StartModule</td></tr><tr><td>StartType</td><td>x=>x.EventData.StartType</td></tr><tr><td>State</td><td>x=>x.EventData.State</td></tr><tr><td>Status</td><td>x=>x.EventData.Status</td></tr><tr><td>SubStatus</td><td>x=>x.EventData.SubStatus</td></tr><tr><td>SubcategoryGuid</td><td>x=>x.EventData.SubcategoryGuid</td></tr><tr><td>SubcategoryId</td><td>x=>x.EventData.SubcategoryId</td></tr><tr><td>SubjectDomainName</td><td>x=>x.EventData.SubjectDomainName</td></tr><tr><td>SubjectLogonId</td><td>x=>x.EventData.SubjectLogonId</td></tr><tr><td>SubjectUserName</td><td>x=>x.EventData.SubjectUserName</td></tr><tr><td>SubjectUserSid</td><td>x=>x.EventData.SubjectUserSid</td></tr><tr><td>SysmonVersion</td><td>x=>x.EventData.SysmonVersion</td></tr><tr><td>TargetDomainName</td><td>x=>x.EventData.TargetDomainName</td></tr><tr><td>TargetFilename</td><td>x=>x.EventData.TargetFilename</td></tr><tr><td>TargetImage</td><td>x=>x.EventData.TargetImage</td></tr><tr><td>TargetInfo</td><td>x=>x.EventData.TargetInfo</td></tr><tr><td>TargetLogonId</td><td>x=>x.EventData.TargetLogonId</td></tr><tr><td>TargetName</td><td>x=>x.EventData.TargetName</td></tr><tr><td>TargetObject</td><td>x=>x.EventData.TargetObject</td></tr><tr><td>TargetOutboundUserName</td><td>x=>x.EventData.TargetOutboundUserName</td></tr><tr><td>TargetParentProcessId</td><td>x=>x.EventData.TargetParentProcessId</td></tr><tr><td>TargetProcessAddress</td><td>x=>x.EventData.TargetProcessAddress</td></tr><tr><td>TargetProcessGUID</td><td>x=>x.EventData.TargetProcessGUID</td></tr><tr><td>TargetProcessGuid</td><td>x=>x.EventData.TargetProcessGUID</td></tr><tr><td>TargetProcessId</td><td>x=>x.EventData.TargetProcessId</td></tr><tr><td>TargetServerName</td><td>x=>x.EventData.TargetServerName</td></tr><tr><td>TargetSid</td><td>x=>x.EventData.TargetSid</td></tr><tr><td>TargetUser</td><td>x=>x.EventData.TargetUser</td></tr><tr><td>TargetUserName</td><td>x=>x.EventData.TargetUserName</td></tr><tr><td>TargetUserSid</td><td>x=>x.EventData.TargetUserSid</td></tr><tr><td>TaskContent</td><td>x=>x.EventData.TaskContent</td></tr><tr><td>TaskContentNew</td><td>x=>x.EventData.TaskContentNew</td></tr><tr><td>TaskDate</td><td>x=>x.EventData.TaskContent</td></tr><tr><td>TaskName</td><td>x=>x.EventData.TaskName</td></tr><tr><td>TemplateContent</td><td>x=>x.EventData.TemplateContent</td></tr><tr><td>ThreatName</td><td>x=>x.EventData.`Threat Name`</td></tr><tr><td>TicketEncryptionType</td><td>x=>x.EventData.TicketEncryptionType</td></tr><tr><td>TicketOptions</td><td>x=>x.EventData.TicketOptions</td></tr><tr><td>Timestamp</td><td>x=>x.System.TimeCreated.SystemTime</td></tr><tr><td>TokenElevationType</td><td>x=>get(item=TokenElevationTypeLookup, member=x.EventData.TokenElevationType || "-")</td></tr><tr><td>Type</td><td>x=>x.EventData.Type</td></tr><tr><td>Url</td><td>x=>x.EventData.url</td></tr><tr><td>User</td><td>x=>x.EventData.User</td></tr><tr><td>UserAccountControl</td><td>x=>x.EventData.UserAccountControl</td></tr><tr><td>UserContext</td><td>x=>x.EventData.UserContext</td></tr><tr><td>UserDataAddress</td><td>x=>x.UserData.EventXML.Address</td></tr><tr><td>UserDataCode</td><td>x=>x.UserData.Operation_StartedOperational.Code</td></tr><tr><td>UserDataConsumer</td><td>x=>x.UserData.Operation_ESStoConsumerBinding.CONSUMER</td></tr><tr><td>UserDataESS</td><td>x=>x.UserData.Operation_ESStoConsumerBinding.ESS</td></tr><tr><td>UserDataHostProcess</td><td>x=>x.UserData.Operation_StartedOperational.HostProcess</td></tr><tr><td>UserDataNamespace</td><td>x=>x.UserData.Operation_ESStoConsumerBinding.Namespace</td></tr><tr><td>UserDataNamespaceName</td><td>x=>x.UserData.Operation_TemporaryEssStarted.NamespaceName</td></tr><tr><td>UserDataParam1</td><td>x=>x.UserData.EventXML.Param1</td></tr><tr><td>UserDataParam2</td><td>x=>x.UserData.EventXML.Param2</td></tr><tr><td>UserDataParam3</td><td>x=>x.UserData.EventXML.Param3</td></tr><tr><td>UserDataPossibleCause</td><td>x=>x.UserData.Operation_ESStoConsumerBinding.PossibleCause</td></tr><tr><td>UserDataProcessID</td><td>x=>x.UserData.Operation_StartedOperational.ProcessID</td></tr><tr><td>UserDataProcessid</td><td>x=>x.UserData.Operation_TemporaryEssStarted.Processid</td></tr><tr><td>UserDataProviderName</td><td>x=>x.UserData.Operation_StartedOperational.ProviderName</td></tr><tr><td>UserDataProviderPath</td><td>x=>x.UserData.Operation_StartedOperational.ProviderPath</td></tr><tr><td>UserDataQuery</td><td>x=>x.UserData.Operation_TemporaryEssStarted.Query</td></tr><tr><td>UserDataSessionID</td><td>x=>x.UserData.EventXML.SessionID</td></tr><tr><td>UserDataUser</td><td>x=>x.UserData.EventXML.User</td></tr><tr><td>UserName</td><td>x=>x.EventData.UserName</td></tr><tr><td>UserParameters</td><td>x=>x.EventData.UserParameters</td></tr><tr><td>UserPrincipalName</td><td>x=>x.EventData.UserPrincipalName</td></tr><tr><td>UserWorkstations</td><td>x=>x.EventData.UserWorkstations</td></tr><tr><td>Value</td><td>x=>x.EventData.Value</td></tr><tr><td>Version</td><td>x=>x.System.Version</td></tr><tr><td>VhdFile</td><td>x=>x.EventData.VhdFile</td></tr><tr><td>VhdType</td><td>x=>x.EventData.VhdType</td></tr><tr><td>WindowsDefenderProcessName</td><td>x=>x.EventData.`Process Name`</td></tr><tr><td>Workstation</td><td>x=>x.EventData.Workstation</td></tr><tr><td>WorkstationName</td><td>x=>x.EventData.WorkstationName</td></tr><tr><td>image</td><td>x=>x.EventData.Image</td></tr><tr><td>jobId</td><td>x=>x.EventData.jobId</td></tr><tr><td>jobOwner</td><td>x=>x.EventData.jobOwner</td></tr><tr><td>jobTitle</td><td>x=>x.EventData.jobTitle</td></tr><tr><td>md5</td><td>x=>parse_string_with_regex(string=x.EventData.Hash || '', regex='MD5=([^,]+)').g1</td></tr><tr><td>param1</td><td>x=>x.EventData.param1</td></tr><tr><td>param2</td><td>x=>x.EventData.param2</td></tr><tr><td>param3</td><td>x=>x.EventData.param3</td></tr><tr><td>param4</td><td>x=>x.EventData.param4</td></tr><tr><td>param5</td><td>x=>x.EventData.param5</td></tr><tr><td>payload</td><td>x=>x.EventData.payload</td></tr><tr><td>process</td><td>x=>x.EventData.Process</td></tr><tr><td>processPath</td><td>x=>x.EventData.processPath</td></tr><tr><td>query</td><td>x=>x.EventData.Query</td></tr><tr><td>service</td><td>x=>x.EventData.Service</td></tr><tr><td>sha1</td><td>x=>x.EventData.Hashes</td></tr><tr><td>sha256</td><td>x=>parse_string_with_regex(string=x.EventData.Hash || '', regex='SHA256=([^,]+)').g1</td></tr><tr><td>subjectName</td><td>x=>x.EventData.SubjectName</td></tr></tbody></table></div></div><hr><h2 id=windowsapplication><code>*/windows/application</code>
<a class=anchor href=#windowsapplication>#</a></h2><div class=expand><div class=expand-label style=cursor:pointer onclick='$h=$(this),$h.next("div").slideToggle(100,function(){$h.children("i").attr("class",function(){return $h.next("div").is(":visible")?"fas fa-chevron-down":"fas fa-chevron-right"})})'><i style=font-size:x-small class="fas fa-chevron-right"></i>
<span>Details</span></div><div class=expand-content style=display:none><h4 id=vql-query>VQL Query
<a class=anchor href=#vql-query>#</a></h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#66d9ef>SELECT</span> <span style=color:#f92672>*</span> <span style=color:#66d9ef>FROM</span> watch_evtx(accessor<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;file&#39;</span>, filename<span style=color:#f92672>=</span>ROOT <span style=color:#f92672>+</span> <span style=color:#e6db74>&#34;/Application.evtx&#34;</span>)
</span></span></code></pre></div><h4 id=sample-use-in-a-sigma-rule>Sample use in a sigma rule:
<a class=anchor href=#sample-use-in-a-sigma-rule>#</a></h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#f92672>logsource</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>product</span>: <span style=color:#ae81ff>windows</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>service</span>: <span style=color:#ae81ff>application</span>
</span></span></code></pre></div></div></div><h2 id=windowsapplocker><code>*/windows/applocker</code>
<a class=anchor href=#windowsapplocker>#</a></h2><div class=expand><div class=expand-label style=cursor:pointer onclick='$h=$(this),$h.next("div").slideToggle(100,function(){$h.children("i").attr("class",function(){return $h.next("div").is(":visible")?"fas fa-chevron-down":"fas fa-chevron-right"})})'><i style=font-size:x-small class="fas fa-chevron-right"></i>
<span>Details</span></div><div class=expand-content style=display:none><h4 id=vql-query>VQL Query
<a class=anchor href=#vql-query>#</a></h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#66d9ef>SELECT</span> <span style=color:#f92672>*</span> <span style=color:#66d9ef>FROM</span> watch_evtx(accessor<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;file&#39;</span>, filename<span style=color:#f92672>=</span>[
</span></span><span style=display:flex><span>  ROOT <span style=color:#f92672>+</span> <span style=color:#e6db74>&#34;/Microsoft-Windows-AppLocker%4MSI and Script.evtx&#34;</span>,
</span></span><span style=display:flex><span>  ROOT <span style=color:#f92672>+</span> <span style=color:#e6db74>&#34;/Microsoft-Windows-AppLocker%4EXE and DLL.evtx&#34;</span>,
</span></span><span style=display:flex><span>  ROOT <span style=color:#f92672>+</span> <span style=color:#e6db74>&#34;/Microsoft-Windows-AppLocker%4Packaged app-Deployment.evtx&#34;</span>,
</span></span><span style=display:flex><span>  ROOT <span style=color:#f92672>+</span> <span style=color:#e6db74>&#34;/Microsoft-Windows-AppLocker%4Packaged app-Execution.evtx&#34;</span>,
</span></span><span style=display:flex><span>])
</span></span></code></pre></div><h4 id=sample-use-in-a-sigma-rule>Sample use in a sigma rule:
<a class=anchor href=#sample-use-in-a-sigma-rule>#</a></h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#f92672>logsource</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>product</span>: <span style=color:#ae81ff>windows</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>service</span>: <span style=color:#ae81ff>applocker</span>
</span></span></code></pre></div></div></div><h2 id=windowsappmodel-runtime><code>*/windows/appmodel-runtime</code>
<a class=anchor href=#windowsappmodel-runtime>#</a></h2><div class=expand><div class=expand-label style=cursor:pointer onclick='$h=$(this),$h.next("div").slideToggle(100,function(){$h.children("i").attr("class",function(){return $h.next("div").is(":visible")?"fas fa-chevron-down":"fas fa-chevron-right"})})'><i style=font-size:x-small class="fas fa-chevron-right"></i>
<span>Details</span></div><div class=expand-content style=display:none><h4 id=vql-query>VQL Query
<a class=anchor href=#vql-query>#</a></h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#66d9ef>SELECT</span> <span style=color:#f92672>*</span> <span style=color:#66d9ef>FROM</span> watch_evtx(accessor<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;file&#39;</span>, filename<span style=color:#f92672>=</span>ROOT <span style=color:#f92672>+</span> <span style=color:#e6db74>&#34;/Microsoft-Windows-AppModel-Runtime%4Admin.evtx&#34;</span>)
</span></span></code></pre></div><h4 id=sample-use-in-a-sigma-rule>Sample use in a sigma rule:
<a class=anchor href=#sample-use-in-a-sigma-rule>#</a></h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#f92672>logsource</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>product</span>: <span style=color:#ae81ff>windows</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>service</span>: <span style=color:#ae81ff>appmodel-runtime</span>
</span></span></code></pre></div></div></div><h2 id=windowsappxdeployment-server><code>*/windows/appxdeployment-server</code>
<a class=anchor href=#windowsappxdeployment-server>#</a></h2><div class=expand><div class=expand-label style=cursor:pointer onclick='$h=$(this),$h.next("div").slideToggle(100,function(){$h.children("i").attr("class",function(){return $h.next("div").is(":visible")?"fas fa-chevron-down":"fas fa-chevron-right"})})'><i style=font-size:x-small class="fas fa-chevron-right"></i>
<span>Details</span></div><div class=expand-content style=display:none><h4 id=vql-query>VQL Query
<a class=anchor href=#vql-query>#</a></h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#66d9ef>SELECT</span> <span style=color:#f92672>*</span> <span style=color:#66d9ef>FROM</span> watch_evtx(accessor<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;file&#39;</span>, filename<span style=color:#f92672>=</span>ROOT <span style=color:#f92672>+</span> <span style=color:#e6db74>&#34;/Microsoft-Windows-AppxPackaging%4Operational.evtx&#34;</span>)
</span></span></code></pre></div><h4 id=sample-use-in-a-sigma-rule>Sample use in a sigma rule:
<a class=anchor href=#sample-use-in-a-sigma-rule>#</a></h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#f92672>logsource</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>product</span>: <span style=color:#ae81ff>windows</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>service</span>: <span style=color:#ae81ff>appxdeployment-server</span>
</span></span></code></pre></div></div></div><h2 id=windowsappxpackaging-om><code>*/windows/appxpackaging-om</code>
<a class=anchor href=#windowsappxpackaging-om>#</a></h2><div class=expand><div class=expand-label style=cursor:pointer onclick='$h=$(this),$h.next("div").slideToggle(100,function(){$h.children("i").attr("class",function(){return $h.next("div").is(":visible")?"fas fa-chevron-down":"fas fa-chevron-right"})})'><i style=font-size:x-small class="fas fa-chevron-right"></i>
<span>Details</span></div><div class=expand-content style=display:none><h4 id=vql-query>VQL Query
<a class=anchor href=#vql-query>#</a></h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#66d9ef>SELECT</span> <span style=color:#f92672>*</span> <span style=color:#66d9ef>FROM</span> watch_evtx(accessor<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;file&#39;</span>, filename<span style=color:#f92672>=</span>ROOT <span style=color:#f92672>+</span> <span style=color:#e6db74>&#34;/Microsoft-Windows-AppxPackaging%4Operational.evtx&#34;</span>)
</span></span></code></pre></div><h4 id=sample-use-in-a-sigma-rule>Sample use in a sigma rule:
<a class=anchor href=#sample-use-in-a-sigma-rule>#</a></h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#f92672>logsource</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>product</span>: <span style=color:#ae81ff>windows</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>service</span>: <span style=color:#ae81ff>appxpackaging-om</span>
</span></span></code></pre></div></div></div><h2 id=windowsbits-client><code>*/windows/bits-client</code>
<a class=anchor href=#windowsbits-client>#</a></h2><div class=expand><div class=expand-label style=cursor:pointer onclick='$h=$(this),$h.next("div").slideToggle(100,function(){$h.children("i").attr("class",function(){return $h.next("div").is(":visible")?"fas fa-chevron-down":"fas fa-chevron-right"})})'><i style=font-size:x-small class="fas fa-chevron-right"></i>
<span>Details</span></div><div class=expand-content style=display:none><h4 id=vql-query>VQL Query
<a class=anchor href=#vql-query>#</a></h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#66d9ef>SELECT</span> <span style=color:#f92672>*</span> <span style=color:#66d9ef>FROM</span> watch_evtx(accessor<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;file&#39;</span>, filename<span style=color:#f92672>=</span>ROOT <span style=color:#f92672>+</span> <span style=color:#e6db74>&#34;/Microsoft-Windows-Bits-Client%4Operational.evtx&#34;</span>)
</span></span></code></pre></div><h4 id=sample-use-in-a-sigma-rule>Sample use in a sigma rule:
<a class=anchor href=#sample-use-in-a-sigma-rule>#</a></h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#f92672>logsource</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>product</span>: <span style=color:#ae81ff>windows</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>service</span>: <span style=color:#ae81ff>bits-client</span>
</span></span></code></pre></div></div></div><h2 id=windowscapi2><code>*/windows/capi2</code>
<a class=anchor href=#windowscapi2>#</a></h2><div class=expand><div class=expand-label style=cursor:pointer onclick='$h=$(this),$h.next("div").slideToggle(100,function(){$h.children("i").attr("class",function(){return $h.next("div").is(":visible")?"fas fa-chevron-down":"fas fa-chevron-right"})})'><i style=font-size:x-small class="fas fa-chevron-right"></i>
<span>Details</span></div><div class=expand-content style=display:none><h4 id=vql-query>VQL Query
<a class=anchor href=#vql-query>#</a></h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#66d9ef>SELECT</span> <span style=color:#f92672>*</span> <span style=color:#66d9ef>FROM</span> watch_evtx(accessor<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;file&#39;</span>, filename<span style=color:#f92672>=</span>ROOT <span style=color:#f92672>+</span> <span style=color:#e6db74>&#34;/Microsoft-Windows-CAPI2/Operational&#34;</span>)
</span></span></code></pre></div><h4 id=sample-use-in-a-sigma-rule>Sample use in a sigma rule:
<a class=anchor href=#sample-use-in-a-sigma-rule>#</a></h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#f92672>logsource</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>product</span>: <span style=color:#ae81ff>windows</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>service</span>: <span style=color:#ae81ff>capi2</span>
</span></span></code></pre></div></div></div><h2 id=windowscertificateservicesclient-lifecycle-system><code>*/windows/certificateservicesclient-lifecycle-system</code>
<a class=anchor href=#windowscertificateservicesclient-lifecycle-system>#</a></h2><div class=expand><div class=expand-label style=cursor:pointer onclick='$h=$(this),$h.next("div").slideToggle(100,function(){$h.children("i").attr("class",function(){return $h.next("div").is(":visible")?"fas fa-chevron-down":"fas fa-chevron-right"})})'><i style=font-size:x-small class="fas fa-chevron-right"></i>
<span>Details</span></div><div class=expand-content style=display:none><h4 id=vql-query>VQL Query
<a class=anchor href=#vql-query>#</a></h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#66d9ef>SELECT</span> <span style=color:#f92672>*</span> <span style=color:#66d9ef>FROM</span> parse_evtx(filename<span style=color:#f92672>=</span>ROOT <span style=color:#f92672>+</span> <span style=color:#e6db74>&#34;/Microsoft-Windows-CertificateServicesClient-Lifecycle-System/Operational&#34;</span>)
</span></span></code></pre></div><h4 id=sample-use-in-a-sigma-rule>Sample use in a sigma rule:
<a class=anchor href=#sample-use-in-a-sigma-rule>#</a></h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#f92672>logsource</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>product</span>: <span style=color:#ae81ff>windows</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>service</span>: <span style=color:#ae81ff>certificateservicesclient-lifecycle-system</span>
</span></span></code></pre></div></div></div><h2 id=windowscodeintegrity-operational><code>*/windows/codeintegrity-operational</code>
<a class=anchor href=#windowscodeintegrity-operational>#</a></h2><div class=expand><div class=expand-label style=cursor:pointer onclick='$h=$(this),$h.next("div").slideToggle(100,function(){$h.children("i").attr("class",function(){return $h.next("div").is(":visible")?"fas fa-chevron-down":"fas fa-chevron-right"})})'><i style=font-size:x-small class="fas fa-chevron-right"></i>
<span>Details</span></div><div class=expand-content style=display:none><h4 id=vql-query>VQL Query
<a class=anchor href=#vql-query>#</a></h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#66d9ef>SELECT</span> <span style=color:#f92672>*</span> <span style=color:#66d9ef>FROM</span> watch_evtx(accessor<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;file&#34;</span>,
</span></span><span style=display:flex><span>   filename<span style=color:#f92672>=</span>ROOT <span style=color:#f92672>+</span> <span style=color:#e6db74>&#34;/Microsoft-Windows-CodeIntegrity%4Operational.evtx&#34;</span>)
</span></span></code></pre></div><h4 id=sample-use-in-a-sigma-rule>Sample use in a sigma rule:
<a class=anchor href=#sample-use-in-a-sigma-rule>#</a></h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#f92672>logsource</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>product</span>: <span style=color:#ae81ff>windows</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>service</span>: <span style=color:#ae81ff>codeintegrity-operational</span>
</span></span></code></pre></div></div></div><h2 id=windowsdiagnosis-scripted><code>*/windows/diagnosis-scripted</code>
<a class=anchor href=#windowsdiagnosis-scripted>#</a></h2><div class=expand><div class=expand-label style=cursor:pointer onclick='$h=$(this),$h.next("div").slideToggle(100,function(){$h.children("i").attr("class",function(){return $h.next("div").is(":visible")?"fas fa-chevron-down":"fas fa-chevron-right"})})'><i style=font-size:x-small class="fas fa-chevron-right"></i>
<span>Details</span></div><div class=expand-content style=display:none><h4 id=vql-query>VQL Query
<a class=anchor href=#vql-query>#</a></h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#66d9ef>SELECT</span> <span style=color:#f92672>*</span> <span style=color:#66d9ef>FROM</span> watch_evtx(accessor<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;file&#39;</span>, filename<span style=color:#f92672>=</span>ROOT <span style=color:#f92672>+</span> <span style=color:#e6db74>&#34;/Microsoft-Windows-Diagnosis-Scripted%4Operational.evtx&#34;</span>)
</span></span></code></pre></div><h4 id=sample-use-in-a-sigma-rule>Sample use in a sigma rule:
<a class=anchor href=#sample-use-in-a-sigma-rule>#</a></h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#f92672>logsource</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>product</span>: <span style=color:#ae81ff>windows</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>service</span>: <span style=color:#ae81ff>diagnosis-scripted</span>
</span></span></code></pre></div></div></div><h2 id=windowsdns-client><code>*/windows/dns-client</code>
<a class=anchor href=#windowsdns-client>#</a></h2><div class=expand><div class=expand-label style=cursor:pointer onclick='$h=$(this),$h.next("div").slideToggle(100,function(){$h.children("i").attr("class",function(){return $h.next("div").is(":visible")?"fas fa-chevron-down":"fas fa-chevron-right"})})'><i style=font-size:x-small class="fas fa-chevron-right"></i>
<span>Details</span></div><div class=expand-content style=display:none><h4 id=vql-query>VQL Query
<a class=anchor href=#vql-query>#</a></h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#66d9ef>SELECT</span> <span style=color:#f92672>*</span> <span style=color:#66d9ef>FROM</span> watch_evtx(accessor<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;file&#39;</span>, filename<span style=color:#f92672>=</span>ROOT <span style=color:#f92672>+</span> <span style=color:#e6db74>&#34;/Microsoft-Windows-DNS Client Events%4Operational.evtx&#34;</span>)
</span></span></code></pre></div><h4 id=sample-use-in-a-sigma-rule>Sample use in a sigma rule:
<a class=anchor href=#sample-use-in-a-sigma-rule>#</a></h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#f92672>logsource</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>product</span>: <span style=color:#ae81ff>windows</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>service</span>: <span style=color:#ae81ff>dns-client</span>
</span></span></code></pre></div></div></div><h2 id=windowsdns-server><code>*/windows/dns-server</code>
<a class=anchor href=#windowsdns-server>#</a></h2><div class=expand><div class=expand-label style=cursor:pointer onclick='$h=$(this),$h.next("div").slideToggle(100,function(){$h.children("i").attr("class",function(){return $h.next("div").is(":visible")?"fas fa-chevron-down":"fas fa-chevron-right"})})'><i style=font-size:x-small class="fas fa-chevron-right"></i>
<span>Details</span></div><div class=expand-content style=display:none><h4 id=vql-query>VQL Query
<a class=anchor href=#vql-query>#</a></h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#66d9ef>SELECT</span> <span style=color:#f92672>*</span> <span style=color:#66d9ef>FROM</span> watch_evtx(accessor<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;file&#39;</span>, filename<span style=color:#f92672>=</span>ROOT <span style=color:#f92672>+</span> <span style=color:#e6db74>&#34;/DNS Server.evtx&#34;</span>)
</span></span></code></pre></div><h4 id=sample-use-in-a-sigma-rule>Sample use in a sigma rule:
<a class=anchor href=#sample-use-in-a-sigma-rule>#</a></h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#f92672>logsource</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>product</span>: <span style=color:#ae81ff>windows</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>service</span>: <span style=color:#ae81ff>dns-server</span>
</span></span></code></pre></div></div></div><h2 id=windowsdns-server-analytic><code>*/windows/dns-server-analytic</code>
<a class=anchor href=#windowsdns-server-analytic>#</a></h2><div class=expand><div class=expand-label style=cursor:pointer onclick='$h=$(this),$h.next("div").slideToggle(100,function(){$h.children("i").attr("class",function(){return $h.next("div").is(":visible")?"fas fa-chevron-down":"fas fa-chevron-right"})})'><i style=font-size:x-small class="fas fa-chevron-right"></i>
<span>Details</span></div><div class=expand-content style=display:none><h4 id=vql-query>VQL Query
<a class=anchor href=#vql-query>#</a></h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#66d9ef>SELECT</span> <span style=color:#f92672>*</span> <span style=color:#66d9ef>FROM</span> watch_evtx(accessor<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;file&#39;</span>, filename<span style=color:#f92672>=</span>ROOT <span style=color:#f92672>+</span> <span style=color:#e6db74>&#34;/Microsoft-Windows-DNS-Server%4Analytical.evtx&#34;</span>)
</span></span></code></pre></div><h4 id=sample-use-in-a-sigma-rule>Sample use in a sigma rule:
<a class=anchor href=#sample-use-in-a-sigma-rule>#</a></h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#f92672>logsource</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>product</span>: <span style=color:#ae81ff>windows</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>service</span>: <span style=color:#ae81ff>dns-server-analytic</span>
</span></span></code></pre></div></div></div><h2 id=windowsdriver-framework><code>*/windows/driver-framework</code>
<a class=anchor href=#windowsdriver-framework>#</a></h2><div class=expand><div class=expand-label style=cursor:pointer onclick='$h=$(this),$h.next("div").slideToggle(100,function(){$h.children("i").attr("class",function(){return $h.next("div").is(":visible")?"fas fa-chevron-down":"fas fa-chevron-right"})})'><i style=font-size:x-small class="fas fa-chevron-right"></i>
<span>Details</span></div><div class=expand-content style=display:none><h4 id=vql-query>VQL Query
<a class=anchor href=#vql-query>#</a></h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#66d9ef>SELECT</span> <span style=color:#f92672>*</span> <span style=color:#66d9ef>FROM</span> watch_evtx(accessor<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;file&#39;</span>, filename<span style=color:#f92672>=</span>ROOT <span style=color:#f92672>+</span> <span style=color:#e6db74>&#34;/Microsoft-Windows-DriverFrameworks-UserMode%4Operational.evtx&#34;</span>)
</span></span></code></pre></div><h4 id=sample-use-in-a-sigma-rule>Sample use in a sigma rule:
<a class=anchor href=#sample-use-in-a-sigma-rule>#</a></h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#f92672>logsource</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>product</span>: <span style=color:#ae81ff>windows</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>service</span>: <span style=color:#ae81ff>driver-framework</span>
</span></span></code></pre></div></div></div><h2 id=windowsfirewall-as><code>*/windows/firewall-as</code>
<a class=anchor href=#windowsfirewall-as>#</a></h2><div class=expand><div class=expand-label style=cursor:pointer onclick='$h=$(this),$h.next("div").slideToggle(100,function(){$h.children("i").attr("class",function(){return $h.next("div").is(":visible")?"fas fa-chevron-down":"fas fa-chevron-right"})})'><i style=font-size:x-small class="fas fa-chevron-right"></i>
<span>Details</span></div><div class=expand-content style=display:none><h4 id=vql-query>VQL Query
<a class=anchor href=#vql-query>#</a></h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#66d9ef>SELECT</span> <span style=color:#f92672>*</span> <span style=color:#66d9ef>FROM</span> watch_evtx(accessor<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;file&#39;</span>, filename<span style=color:#f92672>=</span>ROOT <span style=color:#f92672>+</span> <span style=color:#e6db74>&#34;/Microsoft-Windows-Windows Firewall With Advanced Security%4Firewall.evtx&#34;</span>)
</span></span></code></pre></div><h4 id=sample-use-in-a-sigma-rule>Sample use in a sigma rule:
<a class=anchor href=#sample-use-in-a-sigma-rule>#</a></h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#f92672>logsource</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>product</span>: <span style=color:#ae81ff>windows</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>service</span>: <span style=color:#ae81ff>firewall-as</span>
</span></span></code></pre></div></div></div><h2 id=windowsldap_debug><code>*/windows/ldap_debug</code>
<a class=anchor href=#windowsldap_debug>#</a></h2><div class=expand><div class=expand-label style=cursor:pointer onclick='$h=$(this),$h.next("div").slideToggle(100,function(){$h.children("i").attr("class",function(){return $h.next("div").is(":visible")?"fas fa-chevron-down":"fas fa-chevron-right"})})'><i style=font-size:x-small class="fas fa-chevron-right"></i>
<span>Details</span></div><div class=expand-content style=display:none><h4 id=vql-query>VQL Query
<a class=anchor href=#vql-query>#</a></h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#66d9ef>SELECT</span> <span style=color:#f92672>*</span> <span style=color:#66d9ef>FROM</span> watch_evtx(accessor<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;file&#39;</span>, filename<span style=color:#f92672>=</span>ROOT <span style=color:#f92672>+</span> <span style=color:#e6db74>&#34;/Microsoft-Windows-LDAP-Client%4Debug.evtx&#34;</span>)
</span></span></code></pre></div><h4 id=sample-use-in-a-sigma-rule>Sample use in a sigma rule:
<a class=anchor href=#sample-use-in-a-sigma-rule>#</a></h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#f92672>logsource</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>product</span>: <span style=color:#ae81ff>windows</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>service</span>: <span style=color:#ae81ff>ldap_debug</span>
</span></span></code></pre></div></div></div><h2 id=windowslsa-server><code>*/windows/lsa-server</code>
<a class=anchor href=#windowslsa-server>#</a></h2><div class=expand><div class=expand-label style=cursor:pointer onclick='$h=$(this),$h.next("div").slideToggle(100,function(){$h.children("i").attr("class",function(){return $h.next("div").is(":visible")?"fas fa-chevron-down":"fas fa-chevron-right"})})'><i style=font-size:x-small class="fas fa-chevron-right"></i>
<span>Details</span></div><div class=expand-content style=display:none><h4 id=vql-query>VQL Query
<a class=anchor href=#vql-query>#</a></h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#66d9ef>SELECT</span> <span style=color:#f92672>*</span> <span style=color:#66d9ef>FROM</span> watch_evtx(accessor<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;file&#39;</span>, filename<span style=color:#f92672>=</span>ROOT <span style=color:#f92672>+</span> <span style=color:#e6db74>&#34;/Microsoft-Windows-LSA%4Operational.evtx&#34;</span>)
</span></span></code></pre></div><h4 id=sample-use-in-a-sigma-rule>Sample use in a sigma rule:
<a class=anchor href=#sample-use-in-a-sigma-rule>#</a></h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#f92672>logsource</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>product</span>: <span style=color:#ae81ff>windows</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>service</span>: <span style=color:#ae81ff>lsa-server</span>
</span></span></code></pre></div></div></div><h2 id=windowsmicrosoft-servicebus-client><code>*/windows/microsoft-servicebus-client</code>
<a class=anchor href=#windowsmicrosoft-servicebus-client>#</a></h2><div class=expand><div class=expand-label style=cursor:pointer onclick='$h=$(this),$h.next("div").slideToggle(100,function(){$h.children("i").attr("class",function(){return $h.next("div").is(":visible")?"fas fa-chevron-down":"fas fa-chevron-right"})})'><i style=font-size:x-small class="fas fa-chevron-right"></i>
<span>Details</span></div><div class=expand-content style=display:none><h4 id=vql-query>VQL Query
<a class=anchor href=#vql-query>#</a></h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#66d9ef>SELECT</span> <span style=color:#f92672>*</span> <span style=color:#66d9ef>FROM</span> watch_evtx(accessor<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;file&#39;</span>, filename<span style=color:#f92672>=</span>ROOT <span style=color:#f92672>+</span> <span style=color:#e6db74>&#34;/Microsoft-ServiceBus-Client.evtx&#34;</span>)
</span></span></code></pre></div><h4 id=sample-use-in-a-sigma-rule>Sample use in a sigma rule:
<a class=anchor href=#sample-use-in-a-sigma-rule>#</a></h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#f92672>logsource</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>product</span>: <span style=color:#ae81ff>windows</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>service</span>: <span style=color:#ae81ff>microsoft-servicebus-client</span>
</span></span></code></pre></div></div></div><h2 id=windowsmsexchange-management><code>*/windows/msexchange-management</code>
<a class=anchor href=#windowsmsexchange-management>#</a></h2><div class=expand><div class=expand-label style=cursor:pointer onclick='$h=$(this),$h.next("div").slideToggle(100,function(){$h.children("i").attr("class",function(){return $h.next("div").is(":visible")?"fas fa-chevron-down":"fas fa-chevron-right"})})'><i style=font-size:x-small class="fas fa-chevron-right"></i>
<span>Details</span></div><div class=expand-content style=display:none><h4 id=vql-query>VQL Query
<a class=anchor href=#vql-query>#</a></h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#66d9ef>SELECT</span> <span style=color:#f92672>*</span> <span style=color:#66d9ef>FROM</span> watch_evtx(accessor<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;file&#39;</span>, filename<span style=color:#f92672>=</span>ROOT <span style=color:#f92672>+</span> <span style=color:#e6db74>&#34;/MSExchange Management.evtx&#34;</span>)
</span></span></code></pre></div><h4 id=sample-use-in-a-sigma-rule>Sample use in a sigma rule:
<a class=anchor href=#sample-use-in-a-sigma-rule>#</a></h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#f92672>logsource</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>product</span>: <span style=color:#ae81ff>windows</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>service</span>: <span style=color:#ae81ff>msexchange-management</span>
</span></span></code></pre></div></div></div><h2 id=windowsntlm><code>*/windows/ntlm</code>
<a class=anchor href=#windowsntlm>#</a></h2><div class=expand><div class=expand-label style=cursor:pointer onclick='$h=$(this),$h.next("div").slideToggle(100,function(){$h.children("i").attr("class",function(){return $h.next("div").is(":visible")?"fas fa-chevron-down":"fas fa-chevron-right"})})'><i style=font-size:x-small class="fas fa-chevron-right"></i>
<span>Details</span></div><div class=expand-content style=display:none><h4 id=vql-query>VQL Query
<a class=anchor href=#vql-query>#</a></h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#66d9ef>SELECT</span> <span style=color:#f92672>*</span> <span style=color:#66d9ef>FROM</span> watch_evtx(accessor<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;file&#39;</span>, filename<span style=color:#f92672>=</span>ROOT <span style=color:#f92672>+</span> <span style=color:#e6db74>&#34;/Microsoft-Windows-NTLM%4Operational.evtx&#34;</span>)
</span></span></code></pre></div><h4 id=sample-use-in-a-sigma-rule>Sample use in a sigma rule:
<a class=anchor href=#sample-use-in-a-sigma-rule>#</a></h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#f92672>logsource</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>product</span>: <span style=color:#ae81ff>windows</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>service</span>: <span style=color:#ae81ff>ntlm</span>
</span></span></code></pre></div></div></div><h2 id=windowsopenssh><code>*/windows/openssh</code>
<a class=anchor href=#windowsopenssh>#</a></h2><div class=expand><div class=expand-label style=cursor:pointer onclick='$h=$(this),$h.next("div").slideToggle(100,function(){$h.children("i").attr("class",function(){return $h.next("div").is(":visible")?"fas fa-chevron-down":"fas fa-chevron-right"})})'><i style=font-size:x-small class="fas fa-chevron-right"></i>
<span>Details</span></div><div class=expand-content style=display:none><h4 id=vql-query>VQL Query
<a class=anchor href=#vql-query>#</a></h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#66d9ef>SELECT</span> <span style=color:#f92672>*</span> <span style=color:#66d9ef>FROM</span> watch_evtx(accessor<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;file&#39;</span>, filename<span style=color:#f92672>=</span>ROOT <span style=color:#f92672>+</span> <span style=color:#e6db74>&#34;/OpenSSH%4Operational.evtx&#34;</span>)
</span></span></code></pre></div><h4 id=sample-use-in-a-sigma-rule>Sample use in a sigma rule:
<a class=anchor href=#sample-use-in-a-sigma-rule>#</a></h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#f92672>logsource</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>product</span>: <span style=color:#ae81ff>windows</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>service</span>: <span style=color:#ae81ff>openssh</span>
</span></span></code></pre></div></div></div><h2 id=windowspowershell><code>*/windows/powershell</code>
<a class=anchor href=#windowspowershell>#</a></h2><div class=expand><div class=expand-label style=cursor:pointer onclick='$h=$(this),$h.next("div").slideToggle(100,function(){$h.children("i").attr("class",function(){return $h.next("div").is(":visible")?"fas fa-chevron-down":"fas fa-chevron-right"})})'><i style=font-size:x-small class="fas fa-chevron-right"></i>
<span>Details</span></div><div class=expand-content style=display:none><h4 id=vql-query>VQL Query
<a class=anchor href=#vql-query>#</a></h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#66d9ef>SELECT</span> <span style=color:#f92672>*</span> <span style=color:#66d9ef>FROM</span> watch_evtx(accessor<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;file&#39;</span>, filename<span style=color:#f92672>=</span>[
</span></span><span style=display:flex><span>   ROOT <span style=color:#f92672>+</span> <span style=color:#e6db74>&#34;/Microsoft-Windows-PowerShell%4Operational.evtx&#34;</span>,
</span></span><span style=display:flex><span>   ROOT <span style=color:#f92672>+</span> <span style=color:#e6db74>&#34;/PowerShellCore%4Operational.evtx&#34;</span>,
</span></span><span style=display:flex><span>])
</span></span></code></pre></div><h4 id=sample-use-in-a-sigma-rule>Sample use in a sigma rule:
<a class=anchor href=#sample-use-in-a-sigma-rule>#</a></h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#f92672>logsource</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>product</span>: <span style=color:#ae81ff>windows</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>service</span>: <span style=color:#ae81ff>powershell</span>
</span></span></code></pre></div></div></div><h2 id=windowspowershell-classic><code>*/windows/powershell-classic</code>
<a class=anchor href=#windowspowershell-classic>#</a></h2><div class=expand><div class=expand-label style=cursor:pointer onclick='$h=$(this),$h.next("div").slideToggle(100,function(){$h.children("i").attr("class",function(){return $h.next("div").is(":visible")?"fas fa-chevron-down":"fas fa-chevron-right"})})'><i style=font-size:x-small class="fas fa-chevron-right"></i>
<span>Details</span></div><div class=expand-content style=display:none><h4 id=vql-query>VQL Query
<a class=anchor href=#vql-query>#</a></h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#66d9ef>SELECT</span> <span style=color:#f92672>*</span>, EventData <span style=color:#f92672>+</span> dict(
</span></span><span style=display:flex><span>   <span style=color:#66d9ef>Data</span><span style=color:#f92672>=</span>EventData.<span style=color:#66d9ef>Data</span>[<span style=color:#ae81ff>2</span>],
</span></span><span style=display:flex><span>   HostApplication<span style=color:#f92672>=</span>parse_string_with_regex(
</span></span><span style=display:flex><span>     regex<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;HostApplication=([^\\r\\n]+)&#34;</span>,
</span></span><span style=display:flex><span>     string<span style=color:#f92672>=</span>EventData.<span style=color:#66d9ef>Data</span>[<span style=color:#ae81ff>2</span>]).g1) <span style=color:#66d9ef>AS</span> EventData
</span></span><span style=display:flex><span><span style=color:#66d9ef>FROM</span> watch_evtx(accessor<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;file&#39;</span>, filename<span style=color:#f92672>=</span>ROOT <span style=color:#f92672>+</span> <span style=color:#e6db74>&#34;/Windows PowerShell.evtx&#34;</span>)
</span></span></code></pre></div><h4 id=sample-use-in-a-sigma-rule>Sample use in a sigma rule:
<a class=anchor href=#sample-use-in-a-sigma-rule>#</a></h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#f92672>logsource</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>product</span>: <span style=color:#ae81ff>windows</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>service</span>: <span style=color:#ae81ff>powershell-classic</span>
</span></span></code></pre></div></div></div><h2 id=windowssecurity><code>*/windows/security</code>
<a class=anchor href=#windowssecurity>#</a></h2><div class=expand><div class=expand-label style=cursor:pointer onclick='$h=$(this),$h.next("div").slideToggle(100,function(){$h.children("i").attr("class",function(){return $h.next("div").is(":visible")?"fas fa-chevron-down":"fas fa-chevron-right"})})'><i style=font-size:x-small class="fas fa-chevron-right"></i>
<span>Details</span></div><div class=expand-content style=display:none><h4 id=vql-query>VQL Query
<a class=anchor href=#vql-query>#</a></h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#66d9ef>SELECT</span> <span style=color:#f92672>*</span> <span style=color:#66d9ef>FROM</span> watch_evtx(accessor<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;file&#39;</span>, filename<span style=color:#f92672>=</span>ROOT <span style=color:#f92672>+</span> <span style=color:#e6db74>&#34;/Security.evtx&#34;</span>)
</span></span></code></pre></div><h4 id=sample-use-in-a-sigma-rule>Sample use in a sigma rule:
<a class=anchor href=#sample-use-in-a-sigma-rule>#</a></h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#f92672>logsource</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>product</span>: <span style=color:#ae81ff>windows</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>service</span>: <span style=color:#ae81ff>security</span>
</span></span></code></pre></div></div></div><h2 id=windowssecurity-mitigations><code>*/windows/security-mitigations</code>
<a class=anchor href=#windowssecurity-mitigations>#</a></h2><div class=expand><div class=expand-label style=cursor:pointer onclick='$h=$(this),$h.next("div").slideToggle(100,function(){$h.children("i").attr("class",function(){return $h.next("div").is(":visible")?"fas fa-chevron-down":"fas fa-chevron-right"})})'><i style=font-size:x-small class="fas fa-chevron-right"></i>
<span>Details</span></div><div class=expand-content style=display:none><h4 id=vql-query>VQL Query
<a class=anchor href=#vql-query>#</a></h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#66d9ef>SELECT</span> <span style=color:#f92672>*</span> <span style=color:#66d9ef>FROM</span> watch_evtx(accessor<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;file&#39;</span>, filename<span style=color:#f92672>=</span>ROOT <span style=color:#f92672>+</span> <span style=color:#e6db74>&#34;/Microsoft-Windows-Security-Mitigations.evtx&#34;</span>)
</span></span></code></pre></div><h4 id=sample-use-in-a-sigma-rule>Sample use in a sigma rule:
<a class=anchor href=#sample-use-in-a-sigma-rule>#</a></h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#f92672>logsource</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>product</span>: <span style=color:#ae81ff>windows</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>service</span>: <span style=color:#ae81ff>security-mitigations</span>
</span></span></code></pre></div></div></div><h2 id=windowsshell-core><code>*/windows/shell-core</code>
<a class=anchor href=#windowsshell-core>#</a></h2><div class=expand><div class=expand-label style=cursor:pointer onclick='$h=$(this),$h.next("div").slideToggle(100,function(){$h.children("i").attr("class",function(){return $h.next("div").is(":visible")?"fas fa-chevron-down":"fas fa-chevron-right"})})'><i style=font-size:x-small class="fas fa-chevron-right"></i>
<span>Details</span></div><div class=expand-content style=display:none><h4 id=vql-query>VQL Query
<a class=anchor href=#vql-query>#</a></h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#66d9ef>SELECT</span> <span style=color:#f92672>*</span> <span style=color:#66d9ef>FROM</span> watch_evtx(accessor<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;file&#39;</span>, filename<span style=color:#f92672>=</span>ROOT <span style=color:#f92672>+</span> <span style=color:#e6db74>&#34;/Microsoft-Windows-Shell-Core%4Operational.evtx&#34;</span>)
</span></span></code></pre></div><h4 id=sample-use-in-a-sigma-rule>Sample use in a sigma rule:
<a class=anchor href=#sample-use-in-a-sigma-rule>#</a></h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#f92672>logsource</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>product</span>: <span style=color:#ae81ff>windows</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>service</span>: <span style=color:#ae81ff>shell-core</span>
</span></span></code></pre></div></div></div><h2 id=windowssmbclient-security><code>*/windows/smbclient-security</code>
<a class=anchor href=#windowssmbclient-security>#</a></h2><div class=expand><div class=expand-label style=cursor:pointer onclick='$h=$(this),$h.next("div").slideToggle(100,function(){$h.children("i").attr("class",function(){return $h.next("div").is(":visible")?"fas fa-chevron-down":"fas fa-chevron-right"})})'><i style=font-size:x-small class="fas fa-chevron-right"></i>
<span>Details</span></div><div class=expand-content style=display:none><h4 id=vql-query>VQL Query
<a class=anchor href=#vql-query>#</a></h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#66d9ef>SELECT</span> <span style=color:#f92672>*</span> <span style=color:#66d9ef>FROM</span> watch_evtx(accessor<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;file&#39;</span>, filename<span style=color:#f92672>=</span>ROOT <span style=color:#f92672>+</span> <span style=color:#e6db74>&#34;/Microsoft-Windows-SmbClient%4Security.evtx&#34;</span>)
</span></span></code></pre></div><h4 id=sample-use-in-a-sigma-rule>Sample use in a sigma rule:
<a class=anchor href=#sample-use-in-a-sigma-rule>#</a></h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#f92672>logsource</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>product</span>: <span style=color:#ae81ff>windows</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>service</span>: <span style=color:#ae81ff>smbclient-security</span>
</span></span></code></pre></div></div></div><h2 id=windowssysmon><code>*/windows/sysmon</code>
<a class=anchor href=#windowssysmon>#</a></h2><div class=expand><div class=expand-label style=cursor:pointer onclick='$h=$(this),$h.next("div").slideToggle(100,function(){$h.children("i").attr("class",function(){return $h.next("div").is(":visible")?"fas fa-chevron-down":"fas fa-chevron-right"})})'><i style=font-size:x-small class="fas fa-chevron-right"></i>
<span>Details</span></div><div class=expand-content style=display:none><h4 id=vql-query>VQL Query
<a class=anchor href=#vql-query>#</a></h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#66d9ef>SELECT</span> <span style=color:#f92672>*</span> <span style=color:#66d9ef>FROM</span> watch_evtx(accessor<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;file&#39;</span>, filename<span style=color:#f92672>=</span>ROOT <span style=color:#f92672>+</span> <span style=color:#e6db74>&#34;/Microsoft-Windows-Sysmon%4Operational.evtx&#34;</span>)
</span></span></code></pre></div><h4 id=sample-use-in-a-sigma-rule>Sample use in a sigma rule:
<a class=anchor href=#sample-use-in-a-sigma-rule>#</a></h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#f92672>logsource</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>product</span>: <span style=color:#ae81ff>windows</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>service</span>: <span style=color:#ae81ff>sysmon</span>
</span></span></code></pre></div></div></div><h2 id=windowssystem><code>*/windows/system</code>
<a class=anchor href=#windowssystem>#</a></h2><div class=expand><div class=expand-label style=cursor:pointer onclick='$h=$(this),$h.next("div").slideToggle(100,function(){$h.children("i").attr("class",function(){return $h.next("div").is(":visible")?"fas fa-chevron-down":"fas fa-chevron-right"})})'><i style=font-size:x-small class="fas fa-chevron-right"></i>
<span>Details</span></div><div class=expand-content style=display:none><h4 id=vql-query>VQL Query
<a class=anchor href=#vql-query>#</a></h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#66d9ef>SELECT</span> <span style=color:#f92672>*</span> <span style=color:#66d9ef>FROM</span> watch_evtx(accessor<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;file&#39;</span>, filename<span style=color:#f92672>=</span>ROOT <span style=color:#f92672>+</span> <span style=color:#e6db74>&#34;/System.evtx&#34;</span>)
</span></span></code></pre></div><h4 id=sample-use-in-a-sigma-rule>Sample use in a sigma rule:
<a class=anchor href=#sample-use-in-a-sigma-rule>#</a></h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#f92672>logsource</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>product</span>: <span style=color:#ae81ff>windows</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>service</span>: <span style=color:#ae81ff>system</span>
</span></span></code></pre></div></div></div><h2 id=windowstaskscheduler><code>*/windows/taskscheduler</code>
<a class=anchor href=#windowstaskscheduler>#</a></h2><div class=expand><div class=expand-label style=cursor:pointer onclick='$h=$(this),$h.next("div").slideToggle(100,function(){$h.children("i").attr("class",function(){return $h.next("div").is(":visible")?"fas fa-chevron-down":"fas fa-chevron-right"})})'><i style=font-size:x-small class="fas fa-chevron-right"></i>
<span>Details</span></div><div class=expand-content style=display:none><h4 id=vql-query>VQL Query
<a class=anchor href=#vql-query>#</a></h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#66d9ef>SELECT</span> <span style=color:#f92672>*</span> <span style=color:#66d9ef>FROM</span> watch_evtx(accessor<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;file&#39;</span>, filename<span style=color:#f92672>=</span>ROOT <span style=color:#f92672>+</span> <span style=color:#e6db74>&#34;/Microsoft-Windows-TaskScheduler%4Operational.evtx&#34;</span>)
</span></span></code></pre></div><h4 id=sample-use-in-a-sigma-rule>Sample use in a sigma rule:
<a class=anchor href=#sample-use-in-a-sigma-rule>#</a></h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#f92672>logsource</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>product</span>: <span style=color:#ae81ff>windows</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>service</span>: <span style=color:#ae81ff>taskscheduler</span>
</span></span></code></pre></div></div></div><h2 id=windowsterminalservices-localsessionmanager><code>*/windows/terminalservices-localsessionmanager</code>
<a class=anchor href=#windowsterminalservices-localsessionmanager>#</a></h2><div class=expand><div class=expand-label style=cursor:pointer onclick='$h=$(this),$h.next("div").slideToggle(100,function(){$h.children("i").attr("class",function(){return $h.next("div").is(":visible")?"fas fa-chevron-down":"fas fa-chevron-right"})})'><i style=font-size:x-small class="fas fa-chevron-right"></i>
<span>Details</span></div><div class=expand-content style=display:none><h4 id=vql-query>VQL Query
<a class=anchor href=#vql-query>#</a></h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#66d9ef>SELECT</span> <span style=color:#f92672>*</span> <span style=color:#66d9ef>FROM</span> watch_evtx(accessor<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;file&#39;</span>, filename<span style=color:#f92672>=</span>ROOT <span style=color:#f92672>+</span> <span style=color:#e6db74>&#34;/Microsoft-Windows-TerminalServices-LocalSessionManager%4Operational.evtx&#34;</span>)
</span></span></code></pre></div><h4 id=sample-use-in-a-sigma-rule>Sample use in a sigma rule:
<a class=anchor href=#sample-use-in-a-sigma-rule>#</a></h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#f92672>logsource</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>product</span>: <span style=color:#ae81ff>windows</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>service</span>: <span style=color:#ae81ff>terminalservices-localsessionmanager</span>
</span></span></code></pre></div></div></div><h2 id=windowsvhdmp><code>*/windows/vhdmp</code>
<a class=anchor href=#windowsvhdmp>#</a></h2><div class=expand><div class=expand-label style=cursor:pointer onclick='$h=$(this),$h.next("div").slideToggle(100,function(){$h.children("i").attr("class",function(){return $h.next("div").is(":visible")?"fas fa-chevron-down":"fas fa-chevron-right"})})'><i style=font-size:x-small class="fas fa-chevron-right"></i>
<span>Details</span></div><div class=expand-content style=display:none><h4 id=vql-query>VQL Query
<a class=anchor href=#vql-query>#</a></h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#66d9ef>SELECT</span> <span style=color:#f92672>*</span> <span style=color:#66d9ef>FROM</span> watch_evtx(accessor<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;file&#39;</span>, filename<span style=color:#f92672>=</span>ROOT <span style=color:#f92672>+</span> <span style=color:#e6db74>&#34;/Microsoft-Windows-VHDMP%4Operational.evtx&#34;</span>)
</span></span></code></pre></div><h4 id=sample-use-in-a-sigma-rule>Sample use in a sigma rule:
<a class=anchor href=#sample-use-in-a-sigma-rule>#</a></h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#f92672>logsource</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>product</span>: <span style=color:#ae81ff>windows</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>service</span>: <span style=color:#ae81ff>vhdmp</span>
</span></span></code></pre></div></div></div><h2 id=windowswindefend><code>*/windows/windefend</code>
<a class=anchor href=#windowswindefend>#</a></h2><div class=expand><div class=expand-label style=cursor:pointer onclick='$h=$(this),$h.next("div").slideToggle(100,function(){$h.children("i").attr("class",function(){return $h.next("div").is(":visible")?"fas fa-chevron-down":"fas fa-chevron-right"})})'><i style=font-size:x-small class="fas fa-chevron-right"></i>
<span>Details</span></div><div class=expand-content style=display:none><h4 id=vql-query>VQL Query
<a class=anchor href=#vql-query>#</a></h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#66d9ef>SELECT</span> <span style=color:#f92672>*</span> <span style=color:#66d9ef>FROM</span> watch_evtx(accessor<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;file&#39;</span>, filename<span style=color:#f92672>=</span>ROOT <span style=color:#f92672>+</span> <span style=color:#e6db74>&#34;/Microsoft-Windows-Windows Defender%4Operational.evtx&#34;</span>)
</span></span></code></pre></div><h4 id=sample-use-in-a-sigma-rule>Sample use in a sigma rule:
<a class=anchor href=#sample-use-in-a-sigma-rule>#</a></h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#f92672>logsource</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>product</span>: <span style=color:#ae81ff>windows</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>service</span>: <span style=color:#ae81ff>windefend</span>
</span></span></code></pre></div></div></div><h2 id=windowswmi><code>*/windows/wmi</code>
<a class=anchor href=#windowswmi>#</a></h2><div class=expand><div class=expand-label style=cursor:pointer onclick='$h=$(this),$h.next("div").slideToggle(100,function(){$h.children("i").attr("class",function(){return $h.next("div").is(":visible")?"fas fa-chevron-down":"fas fa-chevron-right"})})'><i style=font-size:x-small class="fas fa-chevron-right"></i>
<span>Details</span></div><div class=expand-content style=display:none><h4 id=vql-query>VQL Query
<a class=anchor href=#vql-query>#</a></h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#66d9ef>SELECT</span> <span style=color:#f92672>*</span> <span style=color:#66d9ef>FROM</span> watch_evtx(accessor<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;file&#39;</span>, filename<span style=color:#f92672>=</span>ROOT <span style=color:#f92672>+</span> <span style=color:#e6db74>&#34;/Microsoft-Windows-WMI-Activity%4Operational.evtx&#34;</span>)
</span></span></code></pre></div><h4 id=sample-use-in-a-sigma-rule>Sample use in a sigma rule:
<a class=anchor href=#sample-use-in-a-sigma-rule>#</a></h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#f92672>logsource</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>product</span>: <span style=color:#ae81ff>windows</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>service</span>: <span style=color:#ae81ff>wmi</span>
</span></span></code></pre></div></div></div><h2 id=process_creationwindows><code>process_creation/windows/*</code>
<a class=anchor href=#process_creationwindows>#</a></h2><div class=expand><div class=expand-label style=cursor:pointer onclick='$h=$(this),$h.next("div").slideToggle(100,function(){$h.children("i").attr("class",function(){return $h.next("div").is(":visible")?"fas fa-chevron-down":"fas fa-chevron-right"})})'><i style=font-size:x-small class="fas fa-chevron-right"></i>
<span>Details</span></div><div class=expand-content style=display:none><h4 id=vql-query>VQL Query
<a class=anchor href=#vql-query>#</a></h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#66d9ef>SELECT</span> <span style=color:#f92672>*</span> <span style=color:#66d9ef>FROM</span> watch_evtx(accessor<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;file&#39;</span>, filename<span style=color:#f92672>=</span>[
</span></span><span style=display:flex><span>   ROOT <span style=color:#f92672>+</span> <span style=color:#e6db74>&#34;/Microsoft-Windows-Sysmon%4Operational.evtx&#34;</span>,
</span></span><span style=display:flex><span>   ROOT <span style=color:#f92672>+</span> <span style=color:#e6db74>&#34;/System.evtx&#34;</span>
</span></span><span style=display:flex><span>])
</span></span><span style=display:flex><span><span style=color:#66d9ef>WHERE</span> <span style=color:#66d9ef>System</span>.EventID.Value <span style=color:#f92672>=</span> <span style=color:#ae81ff>1</span> <span style=color:#66d9ef>OR</span> <span style=color:#66d9ef>System</span>.EventID.Value <span style=color:#f92672>=</span> <span style=color:#ae81ff>4688</span>
</span></span></code></pre></div><h4 id=sample-use-in-a-sigma-rule>Sample use in a sigma rule:
<a class=anchor href=#sample-use-in-a-sigma-rule>#</a></h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#f92672>logsource</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>category</span>: <span style=color:#ae81ff>process_creation</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>product</span>: <span style=color:#ae81ff>windows</span>
</span></span></code></pre></div></div></div><h2 id=ps_classic_provider_startwindows><code>ps_classic_provider_start/windows/*</code>
<a class=anchor href=#ps_classic_provider_startwindows>#</a></h2><div class=expand><div class=expand-label style=cursor:pointer onclick='$h=$(this),$h.next("div").slideToggle(100,function(){$h.children("i").attr("class",function(){return $h.next("div").is(":visible")?"fas fa-chevron-down":"fas fa-chevron-right"})})'><i style=font-size:x-small class="fas fa-chevron-right"></i>
<span>Details</span></div><div class=expand-content style=display:none><h4 id=vql-query>VQL Query
<a class=anchor href=#vql-query>#</a></h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#66d9ef>SELECT</span> <span style=color:#f92672>*</span> <span style=color:#66d9ef>FROM</span> watch_evtx(accessor<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;file&#39;</span>, filename<span style=color:#f92672>=</span>ROOT <span style=color:#f92672>+</span> <span style=color:#e6db74>&#34;/Windows PowerShell.evtx&#34;</span>)
</span></span><span style=display:flex><span><span style=color:#66d9ef>WHERE</span> <span style=color:#66d9ef>System</span>.EventID.Value <span style=color:#f92672>=</span> <span style=color:#ae81ff>600</span>
</span></span></code></pre></div><h4 id=sample-use-in-a-sigma-rule>Sample use in a sigma rule:
<a class=anchor href=#sample-use-in-a-sigma-rule>#</a></h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#f92672>logsource</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>category</span>: <span style=color:#ae81ff>ps_classic_provider_start</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>product</span>: <span style=color:#ae81ff>windows</span>
</span></span></code></pre></div></div></div><h2 id=ps_classic_startwindows><code>ps_classic_start/windows/*</code>
<a class=anchor href=#ps_classic_startwindows>#</a></h2><div class=expand><div class=expand-label style=cursor:pointer onclick='$h=$(this),$h.next("div").slideToggle(100,function(){$h.children("i").attr("class",function(){return $h.next("div").is(":visible")?"fas fa-chevron-down":"fas fa-chevron-right"})})'><i style=font-size:x-small class="fas fa-chevron-right"></i>
<span>Details</span></div><div class=expand-content style=display:none><h4 id=vql-query>VQL Query
<a class=anchor href=#vql-query>#</a></h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#66d9ef>SELECT</span> <span style=color:#f92672>*</span> <span style=color:#66d9ef>FROM</span> watch_evtx(accessor<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;file&#39;</span>, filename<span style=color:#f92672>=</span>ROOT <span style=color:#f92672>+</span> <span style=color:#e6db74>&#34;/Windows PowerShell.evtx&#34;</span>)
</span></span><span style=display:flex><span><span style=color:#66d9ef>WHERE</span> <span style=color:#66d9ef>System</span>.EventID.Value <span style=color:#f92672>=</span> <span style=color:#ae81ff>400</span>
</span></span></code></pre></div><h4 id=sample-use-in-a-sigma-rule>Sample use in a sigma rule:
<a class=anchor href=#sample-use-in-a-sigma-rule>#</a></h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#f92672>logsource</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>category</span>: <span style=color:#ae81ff>ps_classic_start</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>product</span>: <span style=color:#ae81ff>windows</span>
</span></span></code></pre></div></div></div><h2 id=ps_modulewindows><code>ps_module/windows/*</code>
<a class=anchor href=#ps_modulewindows>#</a></h2><div class=expand><div class=expand-label style=cursor:pointer onclick='$h=$(this),$h.next("div").slideToggle(100,function(){$h.children("i").attr("class",function(){return $h.next("div").is(":visible")?"fas fa-chevron-down":"fas fa-chevron-right"})})'><i style=font-size:x-small class="fas fa-chevron-right"></i>
<span>Details</span></div><div class=expand-content style=display:none><h4 id=vql-query>VQL Query
<a class=anchor href=#vql-query>#</a></h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#66d9ef>SELECT</span> <span style=color:#f92672>*</span> <span style=color:#66d9ef>FROM</span> watch_evtx(accessor<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;file&#39;</span>, filename<span style=color:#f92672>=</span>[
</span></span><span style=display:flex><span>   ROOT <span style=color:#f92672>+</span> <span style=color:#e6db74>&#34;/Microsoft-Windows-PowerShell%4Operational.evtx&#34;</span>,
</span></span><span style=display:flex><span>   ROOT <span style=color:#f92672>+</span> <span style=color:#e6db74>&#34;/PowerShellCore%4Operational.evtx&#34;</span>
</span></span><span style=display:flex><span>])
</span></span><span style=display:flex><span><span style=color:#66d9ef>WHERE</span> <span style=color:#66d9ef>System</span>.EventID.Value <span style=color:#f92672>=</span> <span style=color:#ae81ff>4103</span>
</span></span></code></pre></div><h4 id=sample-use-in-a-sigma-rule>Sample use in a sigma rule:
<a class=anchor href=#sample-use-in-a-sigma-rule>#</a></h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#f92672>logsource</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>category</span>: <span style=color:#ae81ff>ps_module</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>product</span>: <span style=color:#ae81ff>windows</span>
</span></span></code></pre></div></div></div><h2 id=ps_scriptwindows><code>ps_script/windows/*</code>
<a class=anchor href=#ps_scriptwindows>#</a></h2><div class=expand><div class=expand-label style=cursor:pointer onclick='$h=$(this),$h.next("div").slideToggle(100,function(){$h.children("i").attr("class",function(){return $h.next("div").is(":visible")?"fas fa-chevron-down":"fas fa-chevron-right"})})'><i style=font-size:x-small class="fas fa-chevron-right"></i>
<span>Details</span></div><div class=expand-content style=display:none><h4 id=vql-query>VQL Query
<a class=anchor href=#vql-query>#</a></h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#66d9ef>SELECT</span> <span style=color:#f92672>*</span> <span style=color:#66d9ef>FROM</span> watch_evtx(accessor<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;file&#39;</span>, filename<span style=color:#f92672>=</span>[
</span></span><span style=display:flex><span>   ROOT <span style=color:#f92672>+</span> <span style=color:#e6db74>&#34;/Microsoft-Windows-PowerShell%4Operational.evtx&#34;</span>,
</span></span><span style=display:flex><span>   ROOT <span style=color:#f92672>+</span> <span style=color:#e6db74>&#34;/PowerShellCore%4Operational.evtx&#34;</span>
</span></span><span style=display:flex><span>])
</span></span><span style=display:flex><span><span style=color:#66d9ef>WHERE</span> <span style=color:#66d9ef>System</span>.EventID.Value <span style=color:#f92672>=</span> <span style=color:#ae81ff>4104</span>
</span></span></code></pre></div><h4 id=sample-use-in-a-sigma-rule>Sample use in a sigma rule:
<a class=anchor href=#sample-use-in-a-sigma-rule>#</a></h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#f92672>logsource</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>category</span>: <span style=color:#ae81ff>ps_script</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>product</span>: <span style=color:#ae81ff>windows</span>
</span></span></code></pre></div></div></div><h2 id=registry_addwindows><code>registry_add/windows/*</code>
<a class=anchor href=#registry_addwindows>#</a></h2><div class=expand><div class=expand-label style=cursor:pointer onclick='$h=$(this),$h.next("div").slideToggle(100,function(){$h.children("i").attr("class",function(){return $h.next("div").is(":visible")?"fas fa-chevron-down":"fas fa-chevron-right"})})'><i style=font-size:x-small class="fas fa-chevron-right"></i>
<span>Details</span></div><div class=expand-content style=display:none><h4 id=vql-query>VQL Query
<a class=anchor href=#vql-query>#</a></h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#66d9ef>SELECT</span> <span style=color:#f92672>*</span> <span style=color:#66d9ef>FROM</span> watch_evtx(accessor<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;file&#39;</span>, filename<span style=color:#f92672>=</span>[
</span></span><span style=display:flex><span>   ROOT <span style=color:#f92672>+</span> <span style=color:#e6db74>&#34;/Microsoft-Windows-Sysmon%4Operational.evtx&#34;</span>,
</span></span><span style=display:flex><span>   ROOT <span style=color:#f92672>+</span> <span style=color:#e6db74>&#34;/Security.evtx&#34;</span>
</span></span><span style=display:flex><span>])
</span></span><span style=display:flex><span><span style=color:#66d9ef>WHERE</span> <span style=color:#66d9ef>System</span>.EventID.Value <span style=color:#f92672>=</span> <span style=color:#ae81ff>12</span> <span style=color:#66d9ef>OR</span> <span style=color:#66d9ef>System</span>.EventID.Value <span style=color:#f92672>=</span> <span style=color:#ae81ff>4657</span>
</span></span></code></pre></div><h4 id=sample-use-in-a-sigma-rule>Sample use in a sigma rule:
<a class=anchor href=#sample-use-in-a-sigma-rule>#</a></h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#f92672>logsource</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>category</span>: <span style=color:#ae81ff>registry_add</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>product</span>: <span style=color:#ae81ff>windows</span>
</span></span></code></pre></div></div></div><h2 id=registry_eventwindows><code>registry_event/windows/*</code>
<a class=anchor href=#registry_eventwindows>#</a></h2><div class=expand><div class=expand-label style=cursor:pointer onclick='$h=$(this),$h.next("div").slideToggle(100,function(){$h.children("i").attr("class",function(){return $h.next("div").is(":visible")?"fas fa-chevron-down":"fas fa-chevron-right"})})'><i style=font-size:x-small class="fas fa-chevron-right"></i>
<span>Details</span></div><div class=expand-content style=display:none><h4 id=vql-query>VQL Query
<a class=anchor href=#vql-query>#</a></h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#66d9ef>SELECT</span> <span style=color:#f92672>*</span> <span style=color:#66d9ef>FROM</span> watch_evtx(accessor<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;file&#39;</span>, filename<span style=color:#f92672>=</span>[
</span></span><span style=display:flex><span>   ROOT <span style=color:#f92672>+</span> <span style=color:#e6db74>&#34;/Microsoft-Windows-Sysmon%4Operational.evtx&#34;</span>,
</span></span><span style=display:flex><span>   ROOT <span style=color:#f92672>+</span> <span style=color:#e6db74>&#34;/Security.evtx&#34;</span>
</span></span><span style=display:flex><span>])
</span></span><span style=display:flex><span><span style=color:#66d9ef>WHERE</span> <span style=color:#66d9ef>System</span>.EventID.Value <span style=color:#66d9ef>IN</span> (<span style=color:#ae81ff>12</span>, <span style=color:#ae81ff>13</span>, <span style=color:#ae81ff>14</span>) <span style=color:#66d9ef>OR</span> <span style=color:#66d9ef>System</span>.EventID.Value <span style=color:#f92672>=</span> <span style=color:#ae81ff>4657</span>
</span></span></code></pre></div><h4 id=sample-use-in-a-sigma-rule>Sample use in a sigma rule:
<a class=anchor href=#sample-use-in-a-sigma-rule>#</a></h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#f92672>logsource</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>category</span>: <span style=color:#ae81ff>registry_event</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>product</span>: <span style=color:#ae81ff>windows</span>
</span></span></code></pre></div></div></div><h2 id=registry_setwindows><code>registry_set/windows/*</code>
<a class=anchor href=#registry_setwindows>#</a></h2><div class=expand><div class=expand-label style=cursor:pointer onclick='$h=$(this),$h.next("div").slideToggle(100,function(){$h.children("i").attr("class",function(){return $h.next("div").is(":visible")?"fas fa-chevron-down":"fas fa-chevron-right"})})'><i style=font-size:x-small class="fas fa-chevron-right"></i>
<span>Details</span></div><div class=expand-content style=display:none><h4 id=vql-query>VQL Query
<a class=anchor href=#vql-query>#</a></h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#66d9ef>SELECT</span> <span style=color:#f92672>*</span> <span style=color:#66d9ef>FROM</span> watch_evtx(accessor<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;file&#39;</span>, filename<span style=color:#f92672>=</span>[
</span></span><span style=display:flex><span>   ROOT <span style=color:#f92672>+</span> <span style=color:#e6db74>&#34;/Microsoft-Windows-Sysmon%4Operational.evtx&#34;</span>,
</span></span><span style=display:flex><span>   ROOT <span style=color:#f92672>+</span> <span style=color:#e6db74>&#34;/Security.evtx&#34;</span>
</span></span><span style=display:flex><span>])
</span></span><span style=display:flex><span><span style=color:#66d9ef>WHERE</span> <span style=color:#66d9ef>System</span>.EventID.Value <span style=color:#f92672>=</span> <span style=color:#ae81ff>13</span> <span style=color:#66d9ef>OR</span> <span style=color:#66d9ef>System</span>.EventID.Value <span style=color:#f92672>=</span> <span style=color:#ae81ff>4657</span>
</span></span></code></pre></div><h4 id=sample-use-in-a-sigma-rule>Sample use in a sigma rule:
<a class=anchor href=#sample-use-in-a-sigma-rule>#</a></h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#f92672>logsource</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>category</span>: <span style=color:#ae81ff>registry_set</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>product</span>: <span style=color:#ae81ff>windows</span>
</span></span></code></pre></div></div></div><h2 id=antiviruswindowswindefend><code>antivirus/windows/windefend</code>
<a class=anchor href=#antiviruswindowswindefend>#</a></h2><div class=expand><div class=expand-label style=cursor:pointer onclick='$h=$(this),$h.next("div").slideToggle(100,function(){$h.children("i").attr("class",function(){return $h.next("div").is(":visible")?"fas fa-chevron-down":"fas fa-chevron-right"})})'><i style=font-size:x-small class="fas fa-chevron-right"></i>
<span>Details</span></div><div class=expand-content style=display:none><h4 id=vql-query>VQL Query
<a class=anchor href=#vql-query>#</a></h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#66d9ef>SELECT</span> <span style=color:#f92672>*</span> <span style=color:#66d9ef>FROM</span> watch_evtx(accessor<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;file&#39;</span>, filename<span style=color:#f92672>=</span>ROOT <span style=color:#f92672>+</span> <span style=color:#e6db74>&#34;/Microsoft-Windows-Windows Defender%4Operational.evtx&#34;</span>)
</span></span></code></pre></div><h4 id=sample-use-in-a-sigma-rule>Sample use in a sigma rule:
<a class=anchor href=#sample-use-in-a-sigma-rule>#</a></h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#f92672>logsource</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>category</span>: <span style=color:#ae81ff>antivirus</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>product</span>: <span style=color:#ae81ff>windows</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>service</span>: <span style=color:#ae81ff>windefend</span>
</span></span></code></pre></div></div></div></article><footer class=book-footer><div class="flex flex-wrap justify-between"></div><script>(function(){function e(e){const t=window.getSelection(),n=document.createRange();n.selectNodeContents(e),t.removeAllRanges(),t.addRange(n)}document.querySelectorAll("pre code").forEach(t=>{t.addEventListener("click",function(){if(window.getSelection().toString())return;e(t.parentElement),navigator.clipboard&&navigator.clipboard.writeText(t.parentElement.textContent)})})})()</script></footer><div class=book-comments></div><label for=menu-control class="hidden book-menu-overlay"></label></div></main></body></html>